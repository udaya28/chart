var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),s=(e,i,o,s)=>{if(i&&typeof i==`object`||typeof i==`function`)for(var c=r(i),l=0,u=c.length,d;l<u;l++)d=c[l],!a.call(e,d)&&d!==o&&t(e,d,{get:(e=>i[e]).bind(null,d),enumerable:!(s=n(i,d))||s.enumerable});return e},c=(n,r,a)=>(a=n==null?{}:e(i(n)),s(r||!n||!n.__esModule?t(a,`default`,{value:n,enumerable:!0}):a,n));(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e){if(t.type!==`childList`)continue;for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var l=(e=>(e[e.WEBGL_LEGACY=0]=`WEBGL_LEGACY`,e[e.WEBGL=1]=`WEBGL`,e[e.WEBGL2=2]=`WEBGL2`,e))(l||{}),u=(e=>(e[e.UNKNOWN=0]=`UNKNOWN`,e[e.WEBGL=1]=`WEBGL`,e[e.CANVAS=2]=`CANVAS`,e))(u||{}),d=(e=>(e[e.COLOR=16384]=`COLOR`,e[e.DEPTH=256]=`DEPTH`,e[e.STENCIL=1024]=`STENCIL`,e))(d||{}),f=(e=>(e[e.NORMAL=0]=`NORMAL`,e[e.ADD=1]=`ADD`,e[e.MULTIPLY=2]=`MULTIPLY`,e[e.SCREEN=3]=`SCREEN`,e[e.OVERLAY=4]=`OVERLAY`,e[e.DARKEN=5]=`DARKEN`,e[e.LIGHTEN=6]=`LIGHTEN`,e[e.COLOR_DODGE=7]=`COLOR_DODGE`,e[e.COLOR_BURN=8]=`COLOR_BURN`,e[e.HARD_LIGHT=9]=`HARD_LIGHT`,e[e.SOFT_LIGHT=10]=`SOFT_LIGHT`,e[e.DIFFERENCE=11]=`DIFFERENCE`,e[e.EXCLUSION=12]=`EXCLUSION`,e[e.HUE=13]=`HUE`,e[e.SATURATION=14]=`SATURATION`,e[e.COLOR=15]=`COLOR`,e[e.LUMINOSITY=16]=`LUMINOSITY`,e[e.NORMAL_NPM=17]=`NORMAL_NPM`,e[e.ADD_NPM=18]=`ADD_NPM`,e[e.SCREEN_NPM=19]=`SCREEN_NPM`,e[e.NONE=20]=`NONE`,e[e.SRC_OVER=0]=`SRC_OVER`,e[e.SRC_IN=21]=`SRC_IN`,e[e.SRC_OUT=22]=`SRC_OUT`,e[e.SRC_ATOP=23]=`SRC_ATOP`,e[e.DST_OVER=24]=`DST_OVER`,e[e.DST_IN=25]=`DST_IN`,e[e.DST_OUT=26]=`DST_OUT`,e[e.DST_ATOP=27]=`DST_ATOP`,e[e.ERASE=26]=`ERASE`,e[e.SUBTRACT=28]=`SUBTRACT`,e[e.XOR=29]=`XOR`,e))(f||{}),p=(e=>(e[e.POINTS=0]=`POINTS`,e[e.LINES=1]=`LINES`,e[e.LINE_LOOP=2]=`LINE_LOOP`,e[e.LINE_STRIP=3]=`LINE_STRIP`,e[e.TRIANGLES=4]=`TRIANGLES`,e[e.TRIANGLE_STRIP=5]=`TRIANGLE_STRIP`,e[e.TRIANGLE_FAN=6]=`TRIANGLE_FAN`,e))(p||{}),m=(e=>(e[e.RGBA=6408]=`RGBA`,e[e.RGB=6407]=`RGB`,e[e.RG=33319]=`RG`,e[e.RED=6403]=`RED`,e[e.RGBA_INTEGER=36249]=`RGBA_INTEGER`,e[e.RGB_INTEGER=36248]=`RGB_INTEGER`,e[e.RG_INTEGER=33320]=`RG_INTEGER`,e[e.RED_INTEGER=36244]=`RED_INTEGER`,e[e.ALPHA=6406]=`ALPHA`,e[e.LUMINANCE=6409]=`LUMINANCE`,e[e.LUMINANCE_ALPHA=6410]=`LUMINANCE_ALPHA`,e[e.DEPTH_COMPONENT=6402]=`DEPTH_COMPONENT`,e[e.DEPTH_STENCIL=34041]=`DEPTH_STENCIL`,e))(m||{}),h=(e=>(e[e.TEXTURE_2D=3553]=`TEXTURE_2D`,e[e.TEXTURE_CUBE_MAP=34067]=`TEXTURE_CUBE_MAP`,e[e.TEXTURE_2D_ARRAY=35866]=`TEXTURE_2D_ARRAY`,e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]=`TEXTURE_CUBE_MAP_POSITIVE_X`,e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]=`TEXTURE_CUBE_MAP_NEGATIVE_X`,e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]=`TEXTURE_CUBE_MAP_POSITIVE_Y`,e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]=`TEXTURE_CUBE_MAP_NEGATIVE_Y`,e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]=`TEXTURE_CUBE_MAP_POSITIVE_Z`,e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]=`TEXTURE_CUBE_MAP_NEGATIVE_Z`,e))(h||{}),g=(e=>(e[e.UNSIGNED_BYTE=5121]=`UNSIGNED_BYTE`,e[e.UNSIGNED_SHORT=5123]=`UNSIGNED_SHORT`,e[e.UNSIGNED_SHORT_5_6_5=33635]=`UNSIGNED_SHORT_5_6_5`,e[e.UNSIGNED_SHORT_4_4_4_4=32819]=`UNSIGNED_SHORT_4_4_4_4`,e[e.UNSIGNED_SHORT_5_5_5_1=32820]=`UNSIGNED_SHORT_5_5_5_1`,e[e.UNSIGNED_INT=5125]=`UNSIGNED_INT`,e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]=`UNSIGNED_INT_10F_11F_11F_REV`,e[e.UNSIGNED_INT_2_10_10_10_REV=33640]=`UNSIGNED_INT_2_10_10_10_REV`,e[e.UNSIGNED_INT_24_8=34042]=`UNSIGNED_INT_24_8`,e[e.UNSIGNED_INT_5_9_9_9_REV=35902]=`UNSIGNED_INT_5_9_9_9_REV`,e[e.BYTE=5120]=`BYTE`,e[e.SHORT=5122]=`SHORT`,e[e.INT=5124]=`INT`,e[e.FLOAT=5126]=`FLOAT`,e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]=`FLOAT_32_UNSIGNED_INT_24_8_REV`,e[e.HALF_FLOAT=36193]=`HALF_FLOAT`,e))(g||{}),_=(e=>(e[e.FLOAT=0]=`FLOAT`,e[e.INT=1]=`INT`,e[e.UINT=2]=`UINT`,e))(_||{}),v=(e=>(e[e.NEAREST=0]=`NEAREST`,e[e.LINEAR=1]=`LINEAR`,e))(v||{}),y=(e=>(e[e.CLAMP=33071]=`CLAMP`,e[e.REPEAT=10497]=`REPEAT`,e[e.MIRRORED_REPEAT=33648]=`MIRRORED_REPEAT`,e))(y||{}),b=(e=>(e[e.OFF=0]=`OFF`,e[e.POW2=1]=`POW2`,e[e.ON=2]=`ON`,e[e.ON_MANUAL=3]=`ON_MANUAL`,e))(b||{}),x=(e=>(e[e.NPM=0]=`NPM`,e[e.UNPACK=1]=`UNPACK`,e[e.PMA=2]=`PMA`,e[e.NO_PREMULTIPLIED_ALPHA=0]=`NO_PREMULTIPLIED_ALPHA`,e[e.PREMULTIPLY_ON_UPLOAD=1]=`PREMULTIPLY_ON_UPLOAD`,e[e.PREMULTIPLIED_ALPHA=2]=`PREMULTIPLIED_ALPHA`,e))(x||{}),S=(e=>(e[e.NO=0]=`NO`,e[e.YES=1]=`YES`,e[e.AUTO=2]=`AUTO`,e[e.BLEND=0]=`BLEND`,e[e.CLEAR=1]=`CLEAR`,e[e.BLIT=2]=`BLIT`,e))(S||{}),C=(e=>(e[e.AUTO=0]=`AUTO`,e[e.MANUAL=1]=`MANUAL`,e))(C||{}),w=(e=>(e.LOW=`lowp`,e.MEDIUM=`mediump`,e.HIGH=`highp`,e))(w||{}),T=(e=>(e[e.NONE=0]=`NONE`,e[e.SCISSOR=1]=`SCISSOR`,e[e.STENCIL=2]=`STENCIL`,e[e.SPRITE=3]=`SPRITE`,e[e.COLOR=4]=`COLOR`,e))(T||{}),E=(e=>(e[e.RED=1]=`RED`,e[e.GREEN=2]=`GREEN`,e[e.BLUE=4]=`BLUE`,e[e.ALPHA=8]=`ALPHA`,e))(E||{}),D=(e=>(e[e.NONE=0]=`NONE`,e[e.LOW=2]=`LOW`,e[e.MEDIUM=4]=`MEDIUM`,e[e.HIGH=8]=`HIGH`,e))(D||{}),O=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]=`ELEMENT_ARRAY_BUFFER`,e[e.ARRAY_BUFFER=34962]=`ARRAY_BUFFER`,e[e.UNIFORM_BUFFER=35345]=`UNIFORM_BUFFER`,e))(O||{}),k={ADAPTER:{createCanvas:(e,t)=>{let n=document.createElement(`canvas`);return n.width=e,n.height=t,n},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,`text/xml`)},RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},A=/iPhone/i,j=/iPod/i,M=/iPad/i,N=/\biOS-universal(?:.+)Mac\b/i,P=/\bAndroid(?:.+)Mobile\b/i,F=/Android/i,I=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,L=/Silk/i,R=/Windows Phone/i,ee=/\bWindows(?:.+)ARM\b/i,z=/BlackBerry/i,B=/BB10/i,te=/Opera Mini/i,ne=/\b(CriOS|Chrome)(?:.+)Mobile/i,re=/Mobile(?:.+)Firefox\b/i,ie=function(e){return e!==void 0&&e.platform===`MacIntel`&&typeof e.maxTouchPoints==`number`&&e.maxTouchPoints>1&&typeof MSStream>`u`};function ae(e){return function(t){return t.test(e)}}function oe(e){var t={userAgent:``,platform:``,maxTouchPoints:0};!e&&typeof navigator<`u`?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e==`string`?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var n=t.userAgent,r=n.split(`[FBAN`);r[1]!==void 0&&(n=r[0]),r=n.split(`Twitter`),r[1]!==void 0&&(n=r[0]);var i=ae(n),a={apple:{phone:i(A)&&!i(R),ipod:i(j),tablet:!i(A)&&(i(M)||ie(t))&&!i(R),universal:i(N),device:(i(A)||i(j)||i(M)||i(N)||ie(t))&&!i(R)},amazon:{phone:i(I),tablet:!i(I)&&i(L),device:i(I)||i(L)},android:{phone:!i(R)&&i(I)||!i(R)&&i(P),tablet:!i(R)&&!i(I)&&!i(P)&&(i(L)||i(F)),device:!i(R)&&(i(I)||i(L)||i(P)||i(F))||i(/\bokhttp\b/i)},windows:{phone:i(R),tablet:i(ee),device:i(R)||i(ee)},other:{blackberry:i(z),blackberry10:i(B),opera:i(te),firefox:i(re),chrome:i(ne),device:i(z)||i(B)||i(te)||i(re)||i(ne)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}var se=oe.default??oe,ce=se(globalThis.navigator);k.RETINA_PREFIX=/@([0-9\.]+)x/,k.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var le=o(((exports,t)=>{var n=Object.prototype.hasOwnProperty,r=`~`;function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1));function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,n,i,o){if(typeof n!=`function`)throw TypeError(`The listener must be a function`);var s=new a(n,i||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function s(e,t){--e._eventsCount===0?e._events=new i:delete e._events[t]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)n.call(t,i)&&e.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},c.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=Array(a);i<a;i++)o[i]=n[i].fn;return o},c.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,i,a,o){var s=r?r+e:e;if(!this._events[s])return!1;var c=this._events[s],l=arguments.length,u,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,a),!0;case 6:return c.fn.call(c.context,t,n,i,a,o),!0}for(d=1,u=Array(l-1);d<l;d++)u[d-1]=arguments[d];c.fn.apply(c.context,u)}else{var f=c.length,p;for(d=0;d<f;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),l){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,n);break;case 4:c[d].fn.call(c[d].context,t,n,i);break;default:if(!u)for(p=1,u=Array(l-1);p<l;p++)u[p-1]=arguments[p];c[d].fn.apply(c[d].context,u)}}return!0},c.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn===t&&(!i||o.once)&&(!n||o.context===n)&&s(this,a);else{for(var c=0,l=[],u=o.length;c<u;c++)(o[c].fn!==t||i&&!o[c].once||n&&o[c].context!==n)&&l.push(o[c]);l.length?this._events[a]=l.length===1?l[0]:l:s(this,a)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,t!==void 0&&(t.exports=c)})),ue=o(((exports,t)=>{t.exports=n,t.exports.default=n;function n(e,t,n){n||=2;var i=t&&t.length,o=i?t[0]*n:e.length,s=r(e,0,o,n,!0),c=[];if(!s||s.next===s.prev)return c;var l,d,f,p,m,h,g;if(i&&(s=u(e,t,s,n)),e.length>80*n){l=f=e[0],d=p=e[1];for(var _=n;_<o;_+=n)m=e[_],h=e[_+1],m<l&&(l=m),h<d&&(d=h),m>f&&(f=m),h>p&&(p=h);g=Math.max(f-l,p-d),g=g===0?0:32767/g}return a(s,c,n,l,d,g,0),c}function r(e,t,n,r,i){var a,o;if(i===N(e,t,n,r)>0)for(a=t;a<n;a+=r)o=A(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=A(a,e[a],e[a+1],o);return o&&S(o,o.next)&&(j(o),o=o.next),o}function i(e,t){if(!e)return e;t||=e;var n=e,r;do if(r=!1,!n.steiner&&(S(n,n.next)||x(n.prev,n,n.next)===0)){if(j(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function a(e,t,n,r,u,d,f){if(e){!f&&d&&h(e,r,u,d);for(var p=e,m,g;e.prev!==e.next;){if(m=e.prev,g=e.next,d?s(e,r,u,d):o(e)){t.push(m.i/n|0),t.push(e.i/n|0),t.push(g.i/n|0),j(e),e=g.next,p=g.next;continue}if(e=g,e===p){f?f===1?(e=c(i(e),t,n),a(e,t,n,r,u,d,2)):f===2&&l(e,t,n,r,u,d):a(i(e),t,n,r,u,d,1);break}}}}function o(e){var t=e.prev,n=e,r=e.next;if(x(t,n,r)>=0)return!1;for(var i=t.x,a=n.x,o=r.x,s=t.y,c=n.y,l=r.y,u=i<a?i<o?i:o:a<o?a:o,d=s<c?s<l?s:l:c<l?c:l,f=i>a?i>o?i:o:a>o?a:o,p=s>c?s>l?s:l:c>l?c:l,m=r.next;m!==t;){if(m.x>=u&&m.x<=f&&m.y>=d&&m.y<=p&&y(i,s,a,c,o,l,m.x,m.y)&&x(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function s(e,t,n,r){var i=e.prev,a=e,o=e.next;if(x(i,a,o)>=0)return!1;for(var s=i.x,c=a.x,l=o.x,u=i.y,d=a.y,f=o.y,p=s<c?s<l?s:l:c<l?c:l,m=u<d?u<f?u:f:d<f?d:f,h=s>c?s>l?s:l:c>l?c:l,g=u>d?u>f?u:f:d>f?d:f,v=_(p,m,t,n,r),b=_(h,g,t,n,r),S=e.prevZ,C=e.nextZ;S&&S.z>=v&&C&&C.z<=b;){if(S.x>=p&&S.x<=h&&S.y>=m&&S.y<=g&&S!==i&&S!==o&&y(s,u,c,d,l,f,S.x,S.y)&&x(S.prev,S,S.next)>=0||(S=S.prevZ,C.x>=p&&C.x<=h&&C.y>=m&&C.y<=g&&C!==i&&C!==o&&y(s,u,c,d,l,f,C.x,C.y)&&x(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;S&&S.z>=v;){if(S.x>=p&&S.x<=h&&S.y>=m&&S.y<=g&&S!==i&&S!==o&&y(s,u,c,d,l,f,S.x,S.y)&&x(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;C&&C.z<=b;){if(C.x>=p&&C.x<=h&&C.y>=m&&C.y<=g&&C!==i&&C!==o&&y(s,u,c,d,l,f,C.x,C.y)&&x(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function c(e,t,n){var r=e;do{var a=r.prev,o=r.next.next;!S(a,o)&&C(a,r,r.next,o)&&D(a,o)&&D(o,a)&&(t.push(a.i/n|0),t.push(r.i/n|0),t.push(o.i/n|0),j(r),j(r.next),r=e=o),r=r.next}while(r!==e);return i(r)}function l(e,t,n,r,o,s){var c=e;do{for(var l=c.next.next;l!==c.prev;){if(c.i!==l.i&&b(c,l)){var u=k(c,l);c=i(c,c.next),u=i(u,u.next),a(c,t,n,r,o,s,0),a(u,t,n,r,o,s,0);return}l=l.next}c=c.next}while(c!==e)}function u(e,t,n,i){var a=[],o,s,c,l,u;for(o=0,s=t.length;o<s;o++)c=t[o]*i,l=o<s-1?t[o+1]*i:e.length,u=r(e,c,l,i,!1),u===u.next&&(u.steiner=!0),a.push(v(u));for(a.sort(d),o=0;o<a.length;o++)n=f(a[o],n);return n}function d(e,t){return e.x-t.x}function f(e,t){var n=p(e,t);if(!n)return t;var r=k(n,e);return i(r,r.next),i(n,n.next)}function p(e,t){var n=t,r=e.x,i=e.y,a=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>a&&(a=s,o=n.x<n.next.x?n:n.next,s===r))return o}n=n.next}while(n!==t);if(!o)return null;var c=o,l=o.x,u=o.y,d=1/0,f;n=o;do r>=n.x&&n.x>=l&&r!==n.x&&y(i<u?r:a,i,l,u,i<u?a:r,i,n.x,n.y)&&(f=Math.abs(i-n.y)/(r-n.x),D(n,e)&&(f<d||f===d&&(n.x>o.x||n.x===o.x&&m(o,n)))&&(o=n,d=f)),n=n.next;while(n!==c);return o}function m(e,t){return x(e.prev,e,t.prev)<0&&x(t.next,e,e.next)<0}function h(e,t,n,r){var i=e;do i.z===0&&(i.z=_(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,g(i)}function g(e){var t,n,r,i,a,o,s,c,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ,r);t++);for(c=l;s>0||c>0&&r;)s!==0&&(c===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1);return e}function _(e,t,n,r,i){return e=(e-n)*i|0,t=(t-r)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function v(e){var t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function y(e,t,n,r,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(r-s)>=(n-o)*(t-s)&&(n-o)*(a-s)>=(i-o)*(r-s)}function b(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!E(e,t)&&(D(e,t)&&D(t,e)&&O(e,t)&&(x(e.prev,e,t.prev)||x(e,t.prev,t))||S(e,t)&&x(e.prev,e,e.next)>0&&x(t.prev,t,t.next)>0)}function x(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function S(e,t){return e.x===t.x&&e.y===t.y}function C(e,t,n,r){var i=T(x(e,t,n)),a=T(x(e,t,r)),o=T(x(n,r,e)),s=T(x(n,r,t));return!!(i!==a&&o!==s||i===0&&w(e,n,t)||a===0&&w(e,r,t)||o===0&&w(n,e,r)||s===0&&w(n,t,r))}function w(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function T(e){return e>0?1:e<0?-1:0}function E(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&C(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function D(e,t){return x(e.prev,e,e.next)<0?x(e,t,e.next)>=0&&x(e,e.prev,t)>=0:x(e,t,e.prev)<0||x(e,e.next,t)<0}function O(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function k(e,t){var n=new M(e.i,e.x,e.y),r=new M(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function A(e,t,n,r){var i=new M(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function j(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function M(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}n.deviation=function(e,t,n,r){var i=t&&t.length,a=i?t[0]*n:e.length,o=Math.abs(N(e,0,a,n));if(i)for(var s=0,c=t.length;s<c;s++){var l=t[s]*n,u=s<c-1?t[s+1]*n:e.length;o-=Math.abs(N(e,l,u,n))}var d=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,p=r[s+1]*n,m=r[s+2]*n;d+=Math.abs((e[f]-e[m])*(e[p+1]-e[f+1])-(e[f]-e[p])*(e[m+1]-e[f+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function N(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}n.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)n.vertices.push(e[i][a][o]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}})),de=o(((exports,t)=>{(function(n){var r=typeof exports==`object`&&exports&&!exports.nodeType&&exports,i=typeof t==`object`&&t&&!t.nodeType&&t,a=typeof global==`object`&&global;(a.global===a||a.window===a||a.self===a)&&(n=a);var o,s=2147483647,c=36,l=1,u=26,d=38,f=700,p=72,m=128,h=`-`,g=/^xn--/,_=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:`Overflow: input needs wider integers to process`,"not-basic":`Illegal input >= 0x80 (not a basic code point)`,"invalid-input":`Invalid input`},b=c-l,x=Math.floor,S=String.fromCharCode,C;function w(e){throw RangeError(y[e])}function T(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function E(e,t){var n=e.split(`@`),r=``;n.length>1&&(r=n[0]+`@`,e=n[1]),e=e.replace(v,`.`);var i=e.split(`.`),a=T(i,t).join(`.`);return r+a}function D(e){for(var t=[],n=0,r=e.length,i,a;n<r;)i=e.charCodeAt(n++),i>=55296&&i<=56319&&n<r?(a=e.charCodeAt(n++),(a&64512)==56320?t.push(((i&1023)<<10)+(a&1023)+65536):(t.push(i),n--)):t.push(i);return t}function O(e){return T(e,function(e){var t=``;return e>65535&&(e-=65536,t+=S(e>>>10&1023|55296),e=56320|e&1023),t+=S(e),t}).join(``)}function k(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:c}function A(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function j(e,t,n){var r=0;for(e=n?x(e/f):e>>1,e+=x(e/t);e>b*u>>1;r+=c)e=x(e/b);return x(r+(b+1)*e/(e+d))}function M(e){var t=[],n=e.length,r,i=0,a=m,o=p,d=e.lastIndexOf(h),f,g,_,v,y,b,S,C;for(d<0&&(d=0),f=0;f<d;++f)e.charCodeAt(f)>=128&&w(`not-basic`),t.push(e.charCodeAt(f));for(g=d>0?d+1:0;g<n;){for(_=i,v=1,y=c;g>=n&&w(`invalid-input`),b=k(e.charCodeAt(g++)),(b>=c||b>x((s-i)/v))&&w(`overflow`),i+=b*v,S=y<=o?l:y>=o+u?u:y-o,!(b<S);y+=c)C=c-S,v>x(s/C)&&w(`overflow`),v*=C;r=t.length+1,o=j(i-_,r,_==0),x(i/r)>s-a&&w(`overflow`),a+=x(i/r),i%=r,t.splice(i++,0,a)}return O(t)}function N(e){var t,n,r,i,a,o,d,f,g,_,v,y=[],b,C,T,E;for(e=D(e),b=e.length,t=m,n=0,a=p,o=0;o<b;++o)v=e[o],v<128&&y.push(S(v));for(r=i=y.length,i&&y.push(h);r<b;){for(d=s,o=0;o<b;++o)v=e[o],v>=t&&v<d&&(d=v);for(C=r+1,d-t>x((s-n)/C)&&w(`overflow`),n+=(d-t)*C,t=d,o=0;o<b;++o)if(v=e[o],v<t&&++n>s&&w(`overflow`),v==t){for(f=n,g=c;_=g<=a?l:g>=a+u?u:g-a,!(f<_);g+=c)E=f-_,T=c-_,y.push(S(A(_+E%T,0))),f=x(E/T);y.push(S(A(f,0))),a=j(n,C,r==i),n=0,++r}++n,++t}return y.join(``)}function P(e){return E(e,function(e){return g.test(e)?M(e.slice(4).toLowerCase()):e})}function F(e){return E(e,function(e){return _.test(e)?`xn--`+N(e):e})}if(o={version:`1.4.1`,ucs2:{decode:D,encode:O},decode:M,encode:N,toASCII:F,toUnicode:P},typeof define==`function`&&typeof define.amd==`object`&&define.amd)define(`punycode`,function(){return o});else if(r&&i)if(t.exports==r)i.exports=o;else for(C in o)o.hasOwnProperty(C)&&(r[C]=o[C]);else n.punycode=o})(exports)})),V=o(((exports,t)=>{t.exports=TypeError})),fe=o(((exports,t)=>{t.exports={}})),pe=o(((exports,t)=>{var n=typeof Map==`function`&&Map.prototype,r=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,`size`):null,i=n&&r&&typeof r.get==`function`?r.get:null,a=n&&Map.prototype.forEach,o=typeof Set==`function`&&Set.prototype,s=Object.getOwnPropertyDescriptor&&o?Object.getOwnPropertyDescriptor(Set.prototype,`size`):null,c=o&&s&&typeof s.get==`function`?s.get:null,l=o&&Set.prototype.forEach,u=typeof WeakMap==`function`&&WeakMap.prototype?WeakMap.prototype.has:null,d=typeof WeakSet==`function`&&WeakSet.prototype?WeakSet.prototype.has:null,f=typeof WeakRef==`function`&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,m=Object.prototype.toString,h=Function.prototype.toString,g=String.prototype.match,_=String.prototype.slice,v=String.prototype.replace,y=String.prototype.toUpperCase,b=String.prototype.toLowerCase,x=RegExp.prototype.test,S=Array.prototype.concat,C=Array.prototype.join,w=Array.prototype.slice,T=Math.floor,E=typeof BigInt==`function`?BigInt.prototype.valueOf:null,D=Object.getOwnPropertySymbols,O=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?Symbol.prototype.toString:null,k=typeof Symbol==`function`&&typeof Symbol.iterator==`object`,A=typeof Symbol==`function`&&Symbol.toStringTag&&(typeof Symbol.toStringTag===k||`symbol`)?Symbol.toStringTag:null,j=Object.prototype.propertyIsEnumerable,M=(typeof Reflect==`function`?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function N(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||x.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e==`number`){var r=e<0?-T(-e):T(e);if(r!==e){var i=String(r),a=_.call(t,i.length+1);return v.call(i,n,`$&_`)+`.`+v.call(v.call(a,/([0-9]{3})/g,`$&_`),/_$/,``)}}return v.call(t,n,`$&_`)}var P=fe(),F=P.custom,I=ce(F)?F:null,L={__proto__:null,double:`"`,single:`'`},R={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};t.exports=function e(t,n,r,o){var s=n||{};if(de(s,`quoteStyle`)&&!de(L,s.quoteStyle))throw TypeError(`option "quoteStyle" must be "single" or "double"`);if(de(s,`maxStringLength`)&&(typeof s.maxStringLength==`number`?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var u=de(s,`customInspect`)?s.customInspect:!0;if(typeof u!=`boolean`&&u!==`symbol`)throw TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(de(s,`indent`)&&s.indent!==null&&s.indent!==`	`&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(de(s,`numericSeparator`)&&typeof s.numericSeparator!=`boolean`)throw TypeError('option "numericSeparator", if provided, must be `true` or `false`');var d=s.numericSeparator;if(t===void 0)return`undefined`;if(t===null)return`null`;if(typeof t==`boolean`)return t?`true`:`false`;if(typeof t==`string`)return xe(t,s);if(typeof t==`number`){if(t===0)return 1/0/t>0?`0`:`-0`;var f=String(t);return d?N(t,f):f}if(typeof t==`bigint`){var m=String(t)+`n`;return d?N(t,m):m}var h=s.depth===void 0?5:s.depth;if(r===void 0&&(r=0),r>=h&&h>0&&typeof t==`object`)return te(t)?`[Array]`:`[Object]`;var g=De(s,r);if(o===void 0)o=[];else if(me(o,t)>=0)return`[Circular]`;function y(t,n,i){if(n&&(o=w.call(o),o.push(n)),i){var a={depth:s.depth};return de(s,`quoteStyle`)&&(a.quoteStyle=s.quoteStyle),e(t,a,r+1,o)}return e(t,s,r+1,o)}if(typeof t==`function`&&!re(t)){var x=pe(t),T=ke(t,y);return`[Function`+(x?`: `+x:` (anonymous)`)+`]`+(T.length>0?` { `+C.call(T,`, `)+` }`:``)}if(ce(t)){var D=k?v.call(String(t),/^(Symbol\(.*\))_[^)]*$/,`$1`):O.call(t);return typeof t==`object`&&!k?Ce(D):D}if(be(t)){for(var F=`<`+b.call(String(t.nodeName)),R=t.attributes||[],B=0;B<R.length;B++)F+=` `+R[B].name+`=`+ee(z(R[B].value),`double`,s);return F+=`>`,t.childNodes&&t.childNodes.length&&(F+=`...`),F+=`</`+b.call(String(t.nodeName))+`>`,F}if(te(t)){if(t.length===0)return`[]`;var ue=ke(t,y);return g&&!Ee(ue)?`[`+Oe(ue,g)+`]`:`[ `+C.call(ue,`, `)+` ]`}if(ie(t)){var fe=ke(t,y);return!(`cause`in Error.prototype)&&`cause`in t&&!j.call(t,`cause`)?`{ [`+String(t)+`] `+C.call(S.call(`[cause]: `+y(t.cause),fe),`, `)+` }`:fe.length===0?`[`+String(t)+`]`:`{ [`+String(t)+`] `+C.call(fe,`, `)+` }`}if(typeof t==`object`&&u){if(I&&typeof t[I]==`function`&&P)return P(t,{depth:h-r});if(u!==`symbol`&&typeof t.inspect==`function`)return t.inspect()}if(he(t)){var Se=[];return a&&a.call(t,function(e,n){Se.push(y(n,t,!0)+` => `+y(e,t))}),Te(`Map`,i.call(t),Se,g)}if(ve(t)){var Ae=[];return l&&l.call(t,function(e){Ae.push(y(e,t))}),Te(`Set`,c.call(t),Ae,g)}if(ge(t))return we(`WeakMap`);if(ye(t))return we(`WeakSet`);if(_e(t))return we(`WeakRef`);if(oe(t))return Ce(y(Number(t)));if(le(t))return Ce(y(E.call(t)));if(se(t))return Ce(p.call(t));if(ae(t))return Ce(y(String(t)));if(typeof window<`u`&&t===window)return`{ [object Window] }`;if(typeof globalThis<`u`&&t===globalThis||typeof global<`u`&&t===global)return`{ [object globalThis] }`;if(!ne(t)&&!re(t)){var je=ke(t,y),Me=M?M(t)===Object.prototype:t instanceof Object||t.constructor===Object,Ne=t instanceof Object?``:`null prototype`,Pe=!Me&&A&&Object(t)===t&&A in t?_.call(V(t),8,-1):Ne?`Object`:``,Fe=(Me||typeof t.constructor!=`function`?``:t.constructor.name?t.constructor.name+` `:``)+(Pe||Ne?`[`+C.call(S.call([],Pe||[],Ne||[]),`: `)+`] `:``);return je.length===0?Fe+`{}`:g?Fe+`{`+Oe(je,g)+`}`:Fe+`{ `+C.call(je,`, `)+` }`}return String(t)};function ee(e,t,n){var r=L[n.quoteStyle||t];return r+e+r}function z(e){return v.call(String(e),/"/g,`&quot;`)}function B(e){return!A||!(typeof e==`object`&&(A in e||e[A]!==void 0))}function te(e){return V(e)===`[object Array]`&&B(e)}function ne(e){return V(e)===`[object Date]`&&B(e)}function re(e){return V(e)===`[object RegExp]`&&B(e)}function ie(e){return V(e)===`[object Error]`&&B(e)}function ae(e){return V(e)===`[object String]`&&B(e)}function oe(e){return V(e)===`[object Number]`&&B(e)}function se(e){return V(e)===`[object Boolean]`&&B(e)}function ce(e){if(k)return e&&typeof e==`object`&&e instanceof Symbol;if(typeof e==`symbol`)return!0;if(!e||typeof e!=`object`||!O)return!1;try{return O.call(e),!0}catch{}return!1}function le(e){if(!e||typeof e!=`object`||!E)return!1;try{return E.call(e),!0}catch{}return!1}var ue=Object.prototype.hasOwnProperty||function(e){return e in this};function de(e,t){return ue.call(e,t)}function V(e){return m.call(e)}function pe(e){if(e.name)return e.name;var t=g.call(h.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function me(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function he(e){if(!i||!e||typeof e!=`object`)return!1;try{i.call(e);try{c.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function ge(e){if(!u||!e||typeof e!=`object`)return!1;try{u.call(e,u);try{d.call(e,d)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function _e(e){if(!f||!e||typeof e!=`object`)return!1;try{return f.call(e),!0}catch{}return!1}function ve(e){if(!c||!e||typeof e!=`object`)return!1;try{c.call(e);try{i.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function ye(e){if(!d||!e||typeof e!=`object`)return!1;try{d.call(e,d);try{u.call(e,u)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function be(e){return!e||typeof e!=`object`?!1:typeof HTMLElement<`u`&&e instanceof HTMLElement?!0:typeof e.nodeName==`string`&&typeof e.getAttribute==`function`}function xe(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=`... `+n+` more character`+(n>1?`s`:``);return xe(_.call(e,0,t.maxStringLength),t)+r}var i=R[t.quoteStyle||`single`];i.lastIndex=0;var a=v.call(v.call(e,i,`\\$1`),/[\x00-\x1f]/g,Se);return ee(a,`single`,t)}function Se(e){var t=e.charCodeAt(0),n={8:`b`,9:`t`,10:`n`,12:`f`,13:`r`}[t];return n?`\\`+n:`\\x`+(t<16?`0`:``)+y.call(t.toString(16))}function Ce(e){return`Object(`+e+`)`}function we(e){return e+` { ? }`}function Te(e,t,n,r){var i=r?Oe(n,r):C.call(n,`, `);return e+` (`+t+`) {`+i+`}`}function Ee(e){for(var t=0;t<e.length;t++)if(me(e[t],`
`)>=0)return!1;return!0}function De(e,t){var n;if(e.indent===`	`)n=`	`;else if(typeof e.indent==`number`&&e.indent>0)n=C.call(Array(e.indent+1),` `);else return null;return{base:n,prev:C.call(Array(t+1),n)}}function Oe(e,t){if(e.length===0)return``;var n=`
`+t.prev+t.base;return n+C.call(e,`,`+n)+`
`+t.prev}function ke(e,t){var n=te(e),r=[];if(n){r.length=e.length;for(var i=0;i<e.length;i++)r[i]=de(e,i)?t(e[i],e):``}var a=typeof D==`function`?D(e):[],o;if(k){o={};for(var s=0;s<a.length;s++)o[`$`+a[s]]=a[s]}for(var c in e){if(!de(e,c)||n&&String(Number(c))===c&&c<e.length||k&&o[`$`+c]instanceof Symbol)continue;x.call(/[^\w$]/,c)?r.push(t(c,e)+`: `+t(e[c],e)):r.push(c+`: `+t(e[c],e))}if(typeof D==`function`)for(var l=0;l<a.length;l++)j.call(e,a[l])&&r.push(`[`+t(a[l])+`]: `+t(e[a[l]],e));return r}})),me=o(((exports,t)=>{var n=pe(),r=V(),i=function(e,t,n){for(var r=e,i;(i=r.next)!=null;r=i)if(i.key===t)return r.next=i.next,n||(i.next=e.next,e.next=i),i},a=function(e,t){if(e){var n=i(e,t);return n&&n.value}},o=function(e,t,n){var r=i(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}},s=function(e,t){return e?!!i(e,t):!1},c=function(e,t){if(e)return i(e,t,!0)};t.exports=function(){var e,t={assert:function(e){if(!t.has(e))throw new r(`Side channel does not contain `+n(e))},delete:function(t){var n=e&&e.next,r=c(e,t);return r&&n&&n===r&&(e=void 0),!!r},get:function(t){return a(e,t)},has:function(t){return s(e,t)},set:function(t,n){e||={next:void 0},o(e,t,n)}};return t}})),he=o(((exports,t)=>{t.exports=Object})),ge=o(((exports,t)=>{t.exports=Error})),_e=o(((exports,t)=>{t.exports=EvalError})),ve=o(((exports,t)=>{t.exports=RangeError})),ye=o(((exports,t)=>{t.exports=ReferenceError})),be=o(((exports,t)=>{t.exports=SyntaxError})),xe=o(((exports,t)=>{t.exports=URIError})),Se=o(((exports,t)=>{t.exports=Math.abs})),Ce=o(((exports,t)=>{t.exports=Math.floor})),we=o(((exports,t)=>{t.exports=Math.max})),Te=o(((exports,t)=>{t.exports=Math.min})),Ee=o(((exports,t)=>{t.exports=Math.pow})),De=o(((exports,t)=>{t.exports=Math.round})),Oe=o(((exports,t)=>{t.exports=Number.isNaN||function(e){return e!==e}})),ke=o(((exports,t)=>{var n=Oe();t.exports=function(e){return n(e)||e===0?e:e<0?-1:1}})),Ae=o(((exports,t)=>{t.exports=Object.getOwnPropertyDescriptor})),je=o(((exports,t)=>{var n=Ae();if(n)try{n([],`length`)}catch{n=null}t.exports=n})),Me=o(((exports,t)=>{var n=Object.defineProperty||!1;if(n)try{n({},`a`,{value:1})}catch{n=!1}t.exports=n})),Ne=o(((exports,t)=>{t.exports=function(){if(typeof Symbol!=`function`||typeof Object.getOwnPropertySymbols!=`function`)return!1;if(typeof Symbol.iterator==`symbol`)return!0;var e={},t=Symbol(`test`),n=Object(t);if(typeof t==`string`||Object.prototype.toString.call(t)!==`[object Symbol]`||Object.prototype.toString.call(n)!==`[object Symbol]`)return!1;var r=42;for(var i in e[t]=r,e)return!1;if(typeof Object.keys==`function`&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames==`function`&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor==`function`){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==r||o.enumerable!==!0)return!1}return!0}})),Pe=o(((exports,t)=>{var n=typeof Symbol<`u`&&Symbol,r=Ne();t.exports=function(){return typeof n!=`function`||typeof Symbol!=`function`||typeof n(`foo`)!=`symbol`||typeof Symbol(`bar`)!=`symbol`?!1:r()}})),Fe=o(((exports,t)=>{t.exports=typeof Reflect<`u`&&Reflect.getPrototypeOf||null})),Ie=o(((exports,t)=>{t.exports=he().getPrototypeOf||null})),Le=o(((exports,t)=>{var n=`Function.prototype.bind called on incompatible `,r=Object.prototype.toString,i=Math.max,a=`[object Function]`,o=function(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var i=0;i<t.length;i+=1)n[i+e.length]=t[i];return n},s=function(e,t){for(var n=[],r=t||0,i=0;r<e.length;r+=1,i+=1)n[i]=e[r];return n},c=function(e,t){for(var n=``,r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n};t.exports=function(e){var t=this;if(typeof t!=`function`||r.apply(t)!==a)throw TypeError(n+t);for(var l=s(arguments,1),u,d=function(){if(this instanceof u){var n=t.apply(this,o(l,arguments));return Object(n)===n?n:this}return t.apply(e,o(l,arguments))},f=i(0,t.length-l.length),p=[],m=0;m<f;m++)p[m]=`$`+m;if(u=Function(`binder`,`return function (`+c(p,`,`)+`){ return binder.apply(this,arguments); }`)(d),t.prototype){var h=function(){};h.prototype=t.prototype,u.prototype=new h,h.prototype=null}return u}})),Re=o(((exports,t)=>{var n=Le();t.exports=Function.prototype.bind||n})),ze=o(((exports,t)=>{t.exports=Function.prototype.call})),Be=o(((exports,t)=>{t.exports=Function.prototype.apply})),Ve=o(((exports,t)=>{t.exports=typeof Reflect<`u`&&Reflect&&Reflect.apply})),He=o(((exports,t)=>{var n=Re(),r=Be(),i=ze();t.exports=Ve()||n.call(i,r)})),Ue=o(((exports,t)=>{var n=Re(),r=V(),i=ze(),a=He();t.exports=function(e){if(e.length<1||typeof e[0]!=`function`)throw new r(`a function is required`);return a(n,i,e)}})),We=o(((exports,t)=>{var n=Ue(),r=je(),i;try{i=[].__proto__===Array.prototype}catch(e){if(!e||typeof e!=`object`||!(`code`in e)||e.code!==`ERR_PROTO_ACCESS`)throw e}var a=!!i&&r&&r(Object.prototype,`__proto__`),o=Object,s=o.getPrototypeOf;t.exports=a&&typeof a.get==`function`?n([a.get]):typeof s==`function`?function(e){return s(e==null?e:o(e))}:!1})),Ge=o(((exports,t)=>{var n=Fe(),r=Ie(),i=We();t.exports=n?function(e){return n(e)}:r?function(e){if(!e||typeof e!=`object`&&typeof e!=`function`)throw TypeError(`getProto: not an object`);return r(e)}:i?function(e){return i(e)}:null})),Ke=o(((exports,t)=>{var n=Function.prototype.call,r=Object.prototype.hasOwnProperty;t.exports=Re().call(n,r)})),qe=o(((exports,t)=>{var n,r=he(),i=ge(),a=_e(),o=ve(),s=ye(),c=be(),l=V(),u=xe(),d=Se(),f=Ce(),p=we(),m=Te(),h=Ee(),g=De(),_=ke(),v=Function,y=function(e){try{return v(`"use strict"; return (`+e+`).constructor;`)()}catch{}},b=je(),x=Me(),S=function(){throw new l},C=b?function(){try{return arguments.callee,S}catch{try{return b(arguments,`callee`).get}catch{return S}}}():S,w=Pe()(),T=Ge(),E=Ie(),D=Fe(),O=Be(),k=ze(),A={},j=typeof Uint8Array>`u`||!T?n:T(Uint8Array),M={__proto__:null,"%AggregateError%":typeof AggregateError>`u`?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>`u`?n:ArrayBuffer,"%ArrayIteratorPrototype%":w&&T?T([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":A,"%AsyncGenerator%":A,"%AsyncGeneratorFunction%":A,"%AsyncIteratorPrototype%":A,"%Atomics%":typeof Atomics>`u`?n:Atomics,"%BigInt%":typeof BigInt>`u`?n:BigInt,"%BigInt64Array%":typeof BigInt64Array>`u`?n:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>`u`?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>`u`?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":i,"%eval%":eval,"%EvalError%":a,"%Float16Array%":typeof Float16Array>`u`?n:Float16Array,"%Float32Array%":typeof Float32Array>`u`?n:Float32Array,"%Float64Array%":typeof Float64Array>`u`?n:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>`u`?n:FinalizationRegistry,"%Function%":v,"%GeneratorFunction%":A,"%Int8Array%":typeof Int8Array>`u`?n:Int8Array,"%Int16Array%":typeof Int16Array>`u`?n:Int16Array,"%Int32Array%":typeof Int32Array>`u`?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":w&&T?T(T([][Symbol.iterator]())):n,"%JSON%":typeof JSON==`object`?JSON:n,"%Map%":typeof Map>`u`?n:Map,"%MapIteratorPrototype%":typeof Map>`u`||!w||!T?n:T(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":r,"%Object.getOwnPropertyDescriptor%":b,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>`u`?n:Promise,"%Proxy%":typeof Proxy>`u`?n:Proxy,"%RangeError%":o,"%ReferenceError%":s,"%Reflect%":typeof Reflect>`u`?n:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>`u`?n:Set,"%SetIteratorPrototype%":typeof Set>`u`||!w||!T?n:T(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>`u`?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":w&&T?T(``[Symbol.iterator]()):n,"%Symbol%":w?Symbol:n,"%SyntaxError%":c,"%ThrowTypeError%":C,"%TypedArray%":j,"%TypeError%":l,"%Uint8Array%":typeof Uint8Array>`u`?n:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>`u`?n:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>`u`?n:Uint16Array,"%Uint32Array%":typeof Uint32Array>`u`?n:Uint32Array,"%URIError%":u,"%WeakMap%":typeof WeakMap>`u`?n:WeakMap,"%WeakRef%":typeof WeakRef>`u`?n:WeakRef,"%WeakSet%":typeof WeakSet>`u`?n:WeakSet,"%Function.prototype.call%":k,"%Function.prototype.apply%":O,"%Object.defineProperty%":x,"%Object.getPrototypeOf%":E,"%Math.abs%":d,"%Math.floor%":f,"%Math.max%":p,"%Math.min%":m,"%Math.pow%":h,"%Math.round%":g,"%Math.sign%":_,"%Reflect.getPrototypeOf%":D},N=function e(t){var n;if(t===`%AsyncFunction%`)n=y(`async function () {}`);else if(t===`%GeneratorFunction%`)n=y(`function* () {}`);else if(t===`%AsyncGeneratorFunction%`)n=y(`async function* () {}`);else if(t===`%AsyncGenerator%`){var r=e(`%AsyncGeneratorFunction%`);r&&(n=r.prototype)}else if(t===`%AsyncIteratorPrototype%`){var i=e(`%AsyncGenerator%`);i&&T&&(n=T(i.prototype))}return M[t]=n,n},P={__proto__:null,"%ArrayBufferPrototype%":[`ArrayBuffer`,`prototype`],"%ArrayPrototype%":[`Array`,`prototype`],"%ArrayProto_entries%":[`Array`,`prototype`,`entries`],"%ArrayProto_forEach%":[`Array`,`prototype`,`forEach`],"%ArrayProto_keys%":[`Array`,`prototype`,`keys`],"%ArrayProto_values%":[`Array`,`prototype`,`values`],"%AsyncFunctionPrototype%":[`AsyncFunction`,`prototype`],"%AsyncGenerator%":[`AsyncGeneratorFunction`,`prototype`],"%AsyncGeneratorPrototype%":[`AsyncGeneratorFunction`,`prototype`,`prototype`],"%BooleanPrototype%":[`Boolean`,`prototype`],"%DataViewPrototype%":[`DataView`,`prototype`],"%DatePrototype%":[`Date`,`prototype`],"%ErrorPrototype%":[`Error`,`prototype`],"%EvalErrorPrototype%":[`EvalError`,`prototype`],"%Float32ArrayPrototype%":[`Float32Array`,`prototype`],"%Float64ArrayPrototype%":[`Float64Array`,`prototype`],"%FunctionPrototype%":[`Function`,`prototype`],"%Generator%":[`GeneratorFunction`,`prototype`],"%GeneratorPrototype%":[`GeneratorFunction`,`prototype`,`prototype`],"%Int8ArrayPrototype%":[`Int8Array`,`prototype`],"%Int16ArrayPrototype%":[`Int16Array`,`prototype`],"%Int32ArrayPrototype%":[`Int32Array`,`prototype`],"%JSONParse%":[`JSON`,`parse`],"%JSONStringify%":[`JSON`,`stringify`],"%MapPrototype%":[`Map`,`prototype`],"%NumberPrototype%":[`Number`,`prototype`],"%ObjectPrototype%":[`Object`,`prototype`],"%ObjProto_toString%":[`Object`,`prototype`,`toString`],"%ObjProto_valueOf%":[`Object`,`prototype`,`valueOf`],"%PromisePrototype%":[`Promise`,`prototype`],"%PromiseProto_then%":[`Promise`,`prototype`,`then`],"%Promise_all%":[`Promise`,`all`],"%Promise_reject%":[`Promise`,`reject`],"%Promise_resolve%":[`Promise`,`resolve`],"%RangeErrorPrototype%":[`RangeError`,`prototype`],"%ReferenceErrorPrototype%":[`ReferenceError`,`prototype`],"%RegExpPrototype%":[`RegExp`,`prototype`],"%SetPrototype%":[`Set`,`prototype`],"%SharedArrayBufferPrototype%":[`SharedArrayBuffer`,`prototype`],"%StringPrototype%":[`String`,`prototype`],"%SymbolPrototype%":[`Symbol`,`prototype`],"%SyntaxErrorPrototype%":[`SyntaxError`,`prototype`],"%TypedArrayPrototype%":[`TypedArray`,`prototype`],"%TypeErrorPrototype%":[`TypeError`,`prototype`],"%Uint8ArrayPrototype%":[`Uint8Array`,`prototype`],"%Uint8ClampedArrayPrototype%":[`Uint8ClampedArray`,`prototype`],"%Uint16ArrayPrototype%":[`Uint16Array`,`prototype`],"%Uint32ArrayPrototype%":[`Uint32Array`,`prototype`],"%URIErrorPrototype%":[`URIError`,`prototype`],"%WeakMapPrototype%":[`WeakMap`,`prototype`],"%WeakSetPrototype%":[`WeakSet`,`prototype`]},F=Re(),I=Ke(),L=F.call(k,Array.prototype.concat),R=F.call(O,Array.prototype.splice),ee=F.call(k,String.prototype.replace),z=F.call(k,String.prototype.slice),B=F.call(k,RegExp.prototype.exec),te=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ne=/\\(\\)?/g,re=function(e){var t=z(e,0,1),n=z(e,-1);if(t===`%`&&n!==`%`)throw new c("invalid intrinsic syntax, expected closing `%`");if(n===`%`&&t!==`%`)throw new c("invalid intrinsic syntax, expected opening `%`");var r=[];return ee(e,te,function(e,t,n,i){r[r.length]=n?ee(i,ne,`$1`):t||e}),r},ie=function(e,t){var n=e,r;if(I(P,n)&&(r=P[n],n=`%`+r[0]+`%`),I(M,n)){var i=M[n];if(i===A&&(i=N(n)),i===void 0&&!t)throw new l(`intrinsic `+e+` exists, but is not available. Please file an issue!`);return{alias:r,name:n,value:i}}throw new c(`intrinsic `+e+` does not exist!`)};t.exports=function(e,t){if(typeof e!=`string`||e.length===0)throw new l(`intrinsic name must be a non-empty string`);if(arguments.length>1&&typeof t!=`boolean`)throw new l(`"allowMissing" argument must be a boolean`);if(B(/^%?[^%]*%?$/,e)===null)throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=re(e),r=n.length>0?n[0]:``,i=ie(`%`+r+`%`,t),a=i.name,o=i.value,s=!1,u=i.alias;u&&(r=u[0],R(n,L([0,1],u)));for(var d=1,f=!0;d<n.length;d+=1){var p=n[d],m=z(p,0,1),h=z(p,-1);if((m===`"`||m===`'`||m==="`"||h===`"`||h===`'`||h==="`")&&m!==h)throw new c(`property names with quotes must have matching quotes`);if((p===`constructor`||!f)&&(s=!0),r+=`.`+p,a=`%`+r+`%`,I(M,a))o=M[a];else if(o!=null){if(!(p in o)){if(!t)throw new l(`base intrinsic for `+e+` exists, but the property is not available.`);return}if(b&&d+1>=n.length){var g=b(o,p);f=!!g,o=f&&`get`in g&&!(`originalValue`in g.get)?g.get:o[p]}else f=I(o,p),o=o[p];f&&!s&&(M[a]=o)}}return o}})),Je=o(((exports,t)=>{var n=qe(),r=Ue(),i=r([n(`%String.prototype.indexOf%`)]);t.exports=function(e,t){var a=n(e,!!t);return typeof a==`function`&&i(e,`.prototype.`)>-1?r([a]):a}})),Ye=o(((exports,t)=>{var n=qe(),r=Je(),i=pe(),a=V(),o=n(`%Map%`,!0),s=r(`Map.prototype.get`,!0),c=r(`Map.prototype.set`,!0),l=r(`Map.prototype.has`,!0),u=r(`Map.prototype.delete`,!0),d=r(`Map.prototype.size`,!0);t.exports=!!o&&function(){var e,t={assert:function(e){if(!t.has(e))throw new a(`Side channel does not contain `+i(e))},delete:function(t){if(e){var n=u(e,t);return d(e)===0&&(e=void 0),n}return!1},get:function(t){if(e)return s(e,t)},has:function(t){return e?l(e,t):!1},set:function(t,n){e||=new o,c(e,t,n)}};return t}})),Xe=o(((exports,t)=>{var n=qe(),r=Je(),i=pe(),a=Ye(),o=V(),s=n(`%WeakMap%`,!0),c=r(`WeakMap.prototype.get`,!0),l=r(`WeakMap.prototype.set`,!0),u=r(`WeakMap.prototype.has`,!0),d=r(`WeakMap.prototype.delete`,!0);t.exports=s?function(){var e,t,n={assert:function(e){if(!n.has(e))throw new o(`Side channel does not contain `+i(e))},delete:function(n){if(s&&n&&(typeof n==`object`||typeof n==`function`)){if(e)return d(e,n)}else if(a&&t)return t.delete(n);return!1},get:function(n){return s&&n&&(typeof n==`object`||typeof n==`function`)&&e?c(e,n):t&&t.get(n)},has:function(n){return s&&n&&(typeof n==`object`||typeof n==`function`)&&e?u(e,n):!!t&&t.has(n)},set:function(n,r){s&&n&&(typeof n==`object`||typeof n==`function`)?(e||=new s,l(e,n,r)):a&&(t||=a(),t.set(n,r))}};return n}:a})),Ze=o(((exports,t)=>{var n=V(),r=pe(),i=me(),a=Ye(),o=Xe()||a||i;t.exports=function(){var e,t={assert:function(e){if(!t.has(e))throw new n(`Side channel does not contain `+r(e))},delete:function(t){return!!e&&e.delete(t)},get:function(t){return e&&e.get(t)},has:function(t){return!!e&&e.has(t)},set:function(t,n){e||=o(),e.set(t,n)}};return t}})),Qe=o(((exports,t)=>{var n=String.prototype.replace,r=/%20/g,i={RFC1738:`RFC1738`,RFC3986:`RFC3986`};t.exports={default:i.RFC3986,formatters:{RFC1738:function(e){return n.call(e,r,`+`)},RFC3986:function(e){return String(e)}},RFC1738:i.RFC1738,RFC3986:i.RFC3986}})),$e=o(((exports,t)=>{var n=Qe(),r=Object.prototype.hasOwnProperty,i=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push(`%`+((t<16?`0`:``)+t.toString(16)).toUpperCase());return e}(),o=function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(i(n)){for(var r=[],a=0;a<n.length;++a)n[a]!==void 0&&r.push(n[a]);t.obj[t.prop]=r}}},s=function(e,t){for(var n=t&&t.plainObjects?{__proto__:null}:{},r=0;r<e.length;++r)e[r]!==void 0&&(n[r]=e[r]);return n},c=function e(t,n,a){if(!n)return t;if(typeof n!=`object`&&typeof n!=`function`){if(i(t))t.push(n);else if(t&&typeof t==`object`)(a&&(a.plainObjects||a.allowPrototypes)||!r.call(Object.prototype,n))&&(t[n]=!0);else return[t,n];return t}if(!t||typeof t!=`object`)return[t].concat(n);var o=t;return i(t)&&!i(n)&&(o=s(t,a)),i(t)&&i(n)?(n.forEach(function(n,i){if(r.call(t,i)){var o=t[i];o&&typeof o==`object`&&n&&typeof n==`object`?t[i]=e(o,n,a):t.push(n)}else t[i]=n}),t):Object.keys(n).reduce(function(t,i){var o=n[i];return r.call(t,i)?t[i]=e(t[i],o,a):t[i]=o,t},o)},l=function(e,t){return Object.keys(t).reduce(function(e,n){return e[n]=t[n],e},e)},u=function(e,t,n){var r=e.replace(/\+/g,` `);if(n===`iso-8859-1`)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},d=1024;t.exports={arrayToObject:s,assign:l,combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:`o`}],n=[],r=0;r<t.length;++r)for(var i=t[r],a=i.obj[i.prop],s=Object.keys(a),c=0;c<s.length;++c){var l=s[c],u=a[l];typeof u==`object`&&u&&n.indexOf(u)===-1&&(t.push({obj:a,prop:l}),n.push(u))}return o(t),e},decode:u,encode:function(e,t,r,i,o){if(e.length===0)return e;var s=e;if(typeof e==`symbol`?s=Symbol.prototype.toString.call(e):typeof e!=`string`&&(s=String(e)),r===`iso-8859-1`)return escape(s).replace(/%u[0-9a-f]{4}/gi,function(e){return`%26%23`+parseInt(e.slice(2),16)+`%3B`});for(var c=``,l=0;l<s.length;l+=d){for(var u=s.length>=d?s.slice(l,l+d):s,f=[],p=0;p<u.length;++p){var m=u.charCodeAt(p);if(m===45||m===46||m===95||m===126||m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||o===n.RFC1738&&(m===40||m===41)){f[f.length]=u.charAt(p);continue}if(m<128){f[f.length]=a[m];continue}if(m<2048){f[f.length]=a[192|m>>6]+a[128|m&63];continue}if(m<55296||m>=57344){f[f.length]=a[224|m>>12]+a[128|m>>6&63]+a[128|m&63];continue}p+=1,m=65536+((m&1023)<<10|u.charCodeAt(p)&1023),f[f.length]=a[240|m>>18]+a[128|m>>12&63]+a[128|m>>6&63]+a[128|m&63]}c+=f.join(``)}return c},isBuffer:function(e){return!e||typeof e!=`object`?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return Object.prototype.toString.call(e)===`[object RegExp]`},maybeMap:function(e,t){if(i(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:c}})),et=o(((exports,t)=>{var n=Ze(),r=$e(),i=Qe(),a=Object.prototype.hasOwnProperty,o={brackets:function(e){return e+`[]`},comma:`comma`,indices:function(e,t){return e+`[`+t+`]`},repeat:function(e){return e}},s=Array.isArray,c=Array.prototype.push,l=function(e,t){c.apply(e,s(t)?t:[t])},u=Date.prototype.toISOString,d=i.default,f={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:`indices`,charset:`utf-8`,charsetSentinel:!1,commaRoundTrip:!1,delimiter:`&`,encode:!0,encodeDotInKeys:!1,encoder:r.encode,encodeValuesOnly:!1,filter:void 0,format:d,formatter:i.formatters[d],indices:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},p=function(e){return typeof e==`string`||typeof e==`number`||typeof e==`boolean`||typeof e==`symbol`||typeof e==`bigint`},m={},h=function e(t,i,a,o,c,u,d,h,g,_,v,y,b,x,S,C,w,T){for(var E=t,D=T,O=0,k=!1;(D=D.get(m))!==void 0&&!k;){var A=D.get(t);if(O+=1,A!==void 0){if(A===O)throw RangeError(`Cyclic object value`);k=!0}D.get(m)===void 0&&(O=0)}if(typeof _==`function`?E=_(i,E):E instanceof Date?E=b(E):a===`comma`&&s(E)&&(E=r.maybeMap(E,function(e){return e instanceof Date?b(e):e})),E===null){if(u)return g&&!C?g(i,f.encoder,w,`key`,x):i;E=``}if(p(E)||r.isBuffer(E)){if(g){var j=C?i:g(i,f.encoder,w,`key`,x);return[S(j)+`=`+S(g(E,f.encoder,w,`value`,x))]}return[S(i)+`=`+S(String(E))]}var M=[];if(E===void 0)return M;var N;if(a===`comma`&&s(E))C&&g&&(E=r.maybeMap(E,g)),N=[{value:E.length>0?E.join(`,`)||null:void 0}];else if(s(_))N=_;else{var P=Object.keys(E);N=v?P.sort(v):P}var F=h?String(i).replace(/\./g,`%2E`):String(i),I=o&&s(E)&&E.length===1?F+`[]`:F;if(c&&s(E)&&E.length===0)return I+`[]`;for(var L=0;L<N.length;++L){var R=N[L],ee=typeof R==`object`&&R&&R.value!==void 0?R.value:E[R];if(!(d&&ee===null)){var z=y&&h?String(R).replace(/\./g,`%2E`):String(R),B=s(E)?typeof a==`function`?a(I,z):I:I+(y?`.`+z:`[`+z+`]`);T.set(t,O);var te=n();te.set(m,T),l(M,e(ee,B,a,o,c,u,d,h,a===`comma`&&C&&s(E)?null:g,_,v,y,b,x,S,C,w,te))}}return M},g=function(e){if(!e)return f;if(e.allowEmptyArrays!==void 0&&typeof e.allowEmptyArrays!=`boolean`)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(e.encodeDotInKeys!==void 0&&typeof e.encodeDotInKeys!=`boolean`)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&e.encoder!==void 0&&typeof e.encoder!=`function`)throw TypeError(`Encoder has to be a function.`);var t=e.charset||f.charset;if(e.charset!==void 0&&e.charset!==`utf-8`&&e.charset!==`iso-8859-1`)throw TypeError(`The charset option must be either utf-8, iso-8859-1, or undefined`);var n=i.default;if(e.format!==void 0){if(!a.call(i.formatters,e.format))throw TypeError(`Unknown format option provided.`);n=e.format}var r=i.formatters[n],c=f.filter;(typeof e.filter==`function`||s(e.filter))&&(c=e.filter);var l=e.arrayFormat in o?e.arrayFormat:`indices`in e?e.indices?`indices`:`repeat`:f.arrayFormat;if(`commaRoundTrip`in e&&typeof e.commaRoundTrip!=`boolean`)throw TypeError("`commaRoundTrip` must be a boolean, or absent");return{addQueryPrefix:typeof e.addQueryPrefix==`boolean`?e.addQueryPrefix:f.addQueryPrefix,allowDots:e.allowDots===void 0?e.encodeDotInKeys===!0?!0:f.allowDots:!!e.allowDots,allowEmptyArrays:typeof e.allowEmptyArrays==`boolean`?!!e.allowEmptyArrays:f.allowEmptyArrays,arrayFormat:l,charset:t,charsetSentinel:typeof e.charsetSentinel==`boolean`?e.charsetSentinel:f.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:e.delimiter===void 0?f.delimiter:e.delimiter,encode:typeof e.encode==`boolean`?e.encode:f.encode,encodeDotInKeys:typeof e.encodeDotInKeys==`boolean`?e.encodeDotInKeys:f.encodeDotInKeys,encoder:typeof e.encoder==`function`?e.encoder:f.encoder,encodeValuesOnly:typeof e.encodeValuesOnly==`boolean`?e.encodeValuesOnly:f.encodeValuesOnly,filter:c,format:n,formatter:r,serializeDate:typeof e.serializeDate==`function`?e.serializeDate:f.serializeDate,skipNulls:typeof e.skipNulls==`boolean`?e.skipNulls:f.skipNulls,sort:typeof e.sort==`function`?e.sort:null,strictNullHandling:typeof e.strictNullHandling==`boolean`?e.strictNullHandling:f.strictNullHandling}};t.exports=function(e,t){var r=e,i=g(t),a,c;typeof i.filter==`function`?(c=i.filter,r=c(``,r)):s(i.filter)&&(c=i.filter,a=c);var u=[];if(typeof r!=`object`||!r)return``;var d=o[i.arrayFormat],f=d===`comma`&&i.commaRoundTrip;a||=Object.keys(r),i.sort&&a.sort(i.sort);for(var p=n(),m=0;m<a.length;++m){var _=a[m],v=r[_];i.skipNulls&&v===null||l(u,h(v,_,d,f,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,p))}var y=u.join(i.delimiter),b=i.addQueryPrefix===!0?`?`:``;return i.charsetSentinel&&(i.charset===`iso-8859-1`?b+=`utf8=%26%2310003%3B&`:b+=`utf8=%E2%9C%93&`),y.length>0?b+y:``}})),tt=o(((exports,t)=>{var n=$e(),r=Object.prototype.hasOwnProperty,i=Array.isArray,a={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:`utf-8`,charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:n.decode,delimiter:`&`,depth:5,duplicates:`combine`,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},o=function(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},s=function(e,t,n){if(e&&typeof e==`string`&&t.comma&&e.indexOf(`,`)>-1)return e.split(`,`);if(t.throwOnLimitExceeded&&n>=t.arrayLimit)throw RangeError(`Array limit exceeded. Only `+t.arrayLimit+` element`+(t.arrayLimit===1?``:`s`)+` allowed in an array.`);return e},c=`utf8=%26%2310003%3B`,l=`utf8=%E2%9C%93`,u=function(e,t){var u={__proto__:null},d=t.ignoreQueryPrefix?e.replace(/^\?/,``):e;d=d.replace(/%5B/gi,`[`).replace(/%5D/gi,`]`);var f=t.parameterLimit===1/0?void 0:t.parameterLimit,p=d.split(t.delimiter,t.throwOnLimitExceeded?f+1:f);if(t.throwOnLimitExceeded&&p.length>f)throw RangeError(`Parameter limit exceeded. Only `+f+` parameter`+(f===1?``:`s`)+` allowed.`);var m=-1,h,g=t.charset;if(t.charsetSentinel)for(h=0;h<p.length;++h)p[h].indexOf(`utf8=`)===0&&(p[h]===l?g=`utf-8`:p[h]===c&&(g=`iso-8859-1`),m=h,h=p.length);for(h=0;h<p.length;++h)if(h!==m){var _=p[h],v=_.indexOf(`]=`),y=v===-1?_.indexOf(`=`):v+1,b,x;y===-1?(b=t.decoder(_,a.decoder,g,`key`),x=t.strictNullHandling?null:``):(b=t.decoder(_.slice(0,y),a.decoder,g,`key`),x=n.maybeMap(s(_.slice(y+1),t,i(u[b])?u[b].length:0),function(e){return t.decoder(e,a.decoder,g,`value`)})),x&&t.interpretNumericEntities&&g===`iso-8859-1`&&(x=o(String(x))),_.indexOf(`[]=`)>-1&&(x=i(x)?[x]:x);var S=r.call(u,b);S&&t.duplicates===`combine`?u[b]=n.combine(u[b],x):(!S||t.duplicates===`last`)&&(u[b]=x)}return u},d=function(e,t,r,i){var a=0;if(e.length>0&&e[e.length-1]===`[]`){var o=e.slice(0,-1).join(``);a=Array.isArray(t)&&t[o]?t[o].length:0}for(var c=i?t:s(t,r,a),l=e.length-1;l>=0;--l){var u,d=e[l];if(d===`[]`&&r.parseArrays)u=r.allowEmptyArrays&&(c===``||r.strictNullHandling&&c===null)?[]:n.combine([],c);else{u=r.plainObjects?{__proto__:null}:{};var f=d.charAt(0)===`[`&&d.charAt(d.length-1)===`]`?d.slice(1,-1):d,p=r.decodeDotInKeys?f.replace(/%2E/g,`.`):f,m=parseInt(p,10);!r.parseArrays&&p===``?u={0:c}:!isNaN(m)&&d!==p&&String(m)===p&&m>=0&&r.parseArrays&&m<=r.arrayLimit?(u=[],u[m]=c):p!==`__proto__`&&(u[p]=c)}c=u}return c},f=function(e,t,n,i){if(e){var a=n.allowDots?e.replace(/\.([^.[]+)/g,`[$1]`):e,o=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,c=n.depth>0&&o.exec(a),l=c?a.slice(0,c.index):a,u=[];if(l){if(!n.plainObjects&&r.call(Object.prototype,l)&&!n.allowPrototypes)return;u.push(l)}for(var f=0;n.depth>0&&(c=s.exec(a))!==null&&f<n.depth;){if(f+=1,!n.plainObjects&&r.call(Object.prototype,c[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(c[1])}if(c){if(n.strictDepth===!0)throw RangeError(`Input depth exceeded depth option of `+n.depth+` and strictDepth is true`);u.push(`[`+a.slice(c.index)+`]`)}return d(u,t,n,i)}},p=function(e){if(!e)return a;if(e.allowEmptyArrays!==void 0&&typeof e.allowEmptyArrays!=`boolean`)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(e.decodeDotInKeys!==void 0&&typeof e.decodeDotInKeys!=`boolean`)throw TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!=`function`)throw TypeError(`Decoder has to be a function.`);if(e.charset!==void 0&&e.charset!==`utf-8`&&e.charset!==`iso-8859-1`)throw TypeError(`The charset option must be either utf-8, iso-8859-1, or undefined`);if(e.throwOnLimitExceeded!==void 0&&typeof e.throwOnLimitExceeded!=`boolean`)throw TypeError("`throwOnLimitExceeded` option must be a boolean");var t=e.charset===void 0?a.charset:e.charset,r=e.duplicates===void 0?a.duplicates:e.duplicates;if(r!==`combine`&&r!==`first`&&r!==`last`)throw TypeError(`The duplicates option must be either combine, first, or last`);return{allowDots:e.allowDots===void 0?e.decodeDotInKeys===!0?!0:a.allowDots:!!e.allowDots,allowEmptyArrays:typeof e.allowEmptyArrays==`boolean`?!!e.allowEmptyArrays:a.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes==`boolean`?e.allowPrototypes:a.allowPrototypes,allowSparse:typeof e.allowSparse==`boolean`?e.allowSparse:a.allowSparse,arrayLimit:typeof e.arrayLimit==`number`?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel==`boolean`?e.charsetSentinel:a.charsetSentinel,comma:typeof e.comma==`boolean`?e.comma:a.comma,decodeDotInKeys:typeof e.decodeDotInKeys==`boolean`?e.decodeDotInKeys:a.decodeDotInKeys,decoder:typeof e.decoder==`function`?e.decoder:a.decoder,delimiter:typeof e.delimiter==`string`||n.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:typeof e.depth==`number`||e.depth===!1?+e.depth:a.depth,duplicates:r,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities==`boolean`?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:typeof e.parameterLimit==`number`?e.parameterLimit:a.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects==`boolean`?e.plainObjects:a.plainObjects,strictDepth:typeof e.strictDepth==`boolean`?!!e.strictDepth:a.strictDepth,strictNullHandling:typeof e.strictNullHandling==`boolean`?e.strictNullHandling:a.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded==`boolean`?e.throwOnLimitExceeded:!1}};t.exports=function(e,t){var r=p(t);if(e===``||e==null)return r.plainObjects?{__proto__:null}:{};for(var i=typeof e==`string`?u(e,r):e,a=r.plainObjects?{__proto__:null}:{},o=Object.keys(i),s=0;s<o.length;++s){var c=o[s],l=f(c,i[c],r,typeof e==`string`);a=n.merge(a,l,r)}return r.allowSparse===!0?a:n.compact(a)}})),nt=o(((exports,t)=>{var n=et(),r=tt();t.exports={formats:Qe(),parse:r,stringify:n}}));o((exports=>{var t=de();function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var r=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,o=[`<`,`>`,`"`,"`",` `,`\r`,`
`,`	`],s=[`{`,`}`,`|`,`\\`,`^`,"`"].concat(o),c=[`'`].concat(s),l=[`%`,`/`,`?`,`;`,`#`].concat(c),u=[`/`,`?`,`#`],d=255,f=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},h={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=nt();function v(e,t,r){if(e&&typeof e==`object`&&e instanceof n)return e;var i=new n;return i.parse(e,t,r),i}n.prototype.parse=function(e,n,i){if(typeof e!=`string`)throw TypeError(`Parameter 'url' must be a string, not `+typeof e);var o=e.indexOf(`?`),s=o!==-1&&o<e.indexOf(`#`)?`?`:`#`,v=e.split(s);v[0]=v[0].replace(/\\/g,`/`),e=v.join(s);var y=e;if(y=y.trim(),!i&&e.split(`#`).length===1){var b=a.exec(y);if(b)return this.path=y,this.href=y,this.pathname=b[1],b[2]?(this.search=b[2],n?this.query=_.parse(this.search.substr(1)):this.query=this.search.substr(1)):n&&(this.search=``,this.query={}),this}var x=r.exec(y);if(x){x=x[0];var S=x.toLowerCase();this.protocol=S,y=y.substr(x.length)}if(i||x||y.match(/^\/\/[^@/]+@[^@/]+/)){var C=y.substr(0,2)===`//`;C&&!(x&&h[x])&&(y=y.substr(2),this.slashes=!0)}if(!h[x]&&(C||x&&!g[x])){for(var w=-1,T=0;T<u.length;T++){var E=y.indexOf(u[T]);E!==-1&&(w===-1||E<w)&&(w=E)}var D,O=w===-1?y.lastIndexOf(`@`):y.lastIndexOf(`@`,w);O!==-1&&(D=y.slice(0,O),y=y.slice(O+1),this.auth=decodeURIComponent(D)),w=-1;for(var T=0;T<l.length;T++){var E=y.indexOf(l[T]);E!==-1&&(w===-1||E<w)&&(w=E)}w===-1&&(w=y.length),this.host=y.slice(0,w),y=y.slice(w),this.parseHost(),this.hostname=this.hostname||``;var k=this.hostname[0]===`[`&&this.hostname[this.hostname.length-1]===`]`;if(!k)for(var A=this.hostname.split(/\./),T=0,j=A.length;T<j;T++){var M=A[T];if(M&&!M.match(f)){for(var N=``,P=0,F=M.length;P<F;P++)M.charCodeAt(P)>127?N+=`x`:N+=M[P];if(!N.match(f)){var I=A.slice(0,T),L=A.slice(T+1),R=M.match(p);R&&(I.push(R[1]),L.unshift(R[2])),L.length&&(y=`/`+L.join(`.`)+y),this.hostname=I.join(`.`);break}}}this.hostname.length>d?this.hostname=``:this.hostname=this.hostname.toLowerCase(),k||(this.hostname=t.toASCII(this.hostname));var ee=this.port?`:`+this.port:``;this.host=(this.hostname||``)+ee,this.href+=this.host,k&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),y[0]!==`/`&&(y=`/`+y))}if(!m[S])for(var T=0,j=c.length;T<j;T++){var z=c[T];if(y.indexOf(z)!==-1){var B=encodeURIComponent(z);B===z&&(B=escape(z)),y=y.split(z).join(B)}}var te=y.indexOf(`#`);te!==-1&&(this.hash=y.substr(te),y=y.slice(0,te));var ne=y.indexOf(`?`);if(ne===-1?n&&(this.search=``,this.query={}):(this.search=y.substr(ne),this.query=y.substr(ne+1),n&&(this.query=_.parse(this.query)),y=y.slice(0,ne)),y&&(this.pathname=y),g[S]&&this.hostname&&!this.pathname&&(this.pathname=`/`),this.pathname||this.search){var ee=this.pathname||``;this.path=ee+(this.search||``)}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||``;e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,`:`),e+=`@`);var t=this.protocol||``,n=this.pathname||``,r=this.hash||``,i=!1,a=``;this.host?i=e+this.host:this.hostname&&(i=e+(this.hostname.indexOf(`:`)===-1?this.hostname:`[`+this.hostname+`]`),this.port&&(i+=`:`+this.port)),this.query&&typeof this.query==`object`&&Object.keys(this.query).length&&(a=_.stringify(this.query,{arrayFormat:`repeat`,addQueryPrefix:!1}));var o=this.search||a&&`?`+a||``;return t&&t.substr(-1)!==`:`&&(t+=`:`),this.slashes||(!t||g[t])&&i!==!1?(i=`//`+(i||``),n&&n.charAt(0)!==`/`&&(n=`/`+n)):i||=``,r&&r.charAt(0)!==`#`&&(r=`#`+r),o&&o.charAt(0)!==`?`&&(o=`?`+o),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),o=o.replace(`#`,`%23`),t+i+n+o+r},n.prototype.resolve=function(e){return this.resolveObject(v(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(typeof e==`string`){var t=new n;t.parse(e,!1,!0),e=t}for(var r=new n,i=Object.keys(this),a=0;a<i.length;a++){var o=i[a];r[o]=this[o]}if(r.hash=e.hash,e.href===``)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),c=0;c<s.length;c++){var l=s[c];l!==`protocol`&&(r[l]=e[l])}return g[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname=`/`,r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){for(var u=Object.keys(e),d=0;d<u.length;d++){var f=u[d];r[f]=e[f]}return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!h[e.protocol]){for(var p=(e.pathname||``).split(`/`);p.length&&!(e.host=p.shift()););e.host||=``,e.hostname||=``,p[0]!==``&&p.unshift(``),p.length<2&&p.unshift(``),r.pathname=p.join(`/`)}else r.pathname=e.pathname;return r.search=e.search,r.query=e.query,r.host=e.host||``,r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,(r.pathname||r.search)&&(r.path=(r.pathname||``)+(r.search||``)),r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var m=r.pathname&&r.pathname.charAt(0)===`/`,_=e.host||e.pathname&&e.pathname.charAt(0)===`/`,v=_||m||r.host&&e.pathname,y=v,b=r.pathname&&r.pathname.split(`/`)||[],p=e.pathname&&e.pathname.split(`/`)||[],x=r.protocol&&!g[r.protocol];if(x&&(r.hostname=``,r.port=null,r.host&&(b[0]===``?b[0]=r.host:b.unshift(r.host)),r.host=``,e.protocol&&(e.hostname=null,e.port=null,e.host&&(p[0]===``?p[0]=e.host:p.unshift(e.host)),e.host=null),v&&=p[0]===``||b[0]===``),_)r.host=e.host||e.host===``?e.host:r.host,r.hostname=e.hostname||e.hostname===``?e.hostname:r.hostname,r.search=e.search,r.query=e.query,b=p;else if(p.length)b||=[],b.pop(),b=b.concat(p),r.search=e.search,r.query=e.query;else if(e.search!=null){if(x){r.host=b.shift(),r.hostname=r.host;var S=r.host&&r.host.indexOf(`@`)>0?r.host.split(`@`):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return r.search=e.search,r.query=e.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:``)+(r.search?r.search:``)),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path=`/`+r.search:r.path=null,r.href=r.format(),r;for(var C=b.slice(-1)[0],w=(r.host||e.host||b.length>1)&&(C===`.`||C===`..`)||C===``,T=0,E=b.length;E>=0;E--)C=b[E],C===`.`?b.splice(E,1):C===`..`?(b.splice(E,1),T++):T&&(b.splice(E,1),T--);if(!v&&!y)for(;T--;)b.unshift(`..`);v&&b[0]!==``&&(!b[0]||b[0].charAt(0)!==`/`)&&b.unshift(``),w&&b.join(`/`).substr(-1)!==`/`&&b.push(``);var D=b[0]===``||b[0]&&b[0].charAt(0)===`/`;if(x){r.hostname=D?``:b.length?b.shift():``,r.host=r.hostname;var S=r.host&&r.host.indexOf(`@`)>0?r.host.split(`@`):!1;S&&(r.auth=S.shift(),r.hostname=S.shift(),r.host=r.hostname)}return v||=r.host&&b.length,v&&!D&&b.unshift(``),b.length>0?r.pathname=b.join(`/`):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:``)+(r.search?r.search:``)),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var e=this.host,t=i.exec(e);t&&(t=t[0],t!==`:`&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}}))();var rt=c(ue(),1),it=c(le(),1),at={};function H(e,t,n=3){if(at[t])return;let r=Error().stack;typeof r>`u`?console.warn(`PixiJS Deprecation Warning: `,`${t}
Deprecated since v${e}`):(r=r.split(`
`).splice(n).join(`
`),console.groupCollapsed?(console.groupCollapsed(`%cPixiJS Deprecation Warning: %c%s`,`color:#614108;background:#fffbe6`,`font-weight:normal;color:#614108;background:#fffbe6`,`${t}
Deprecated since v${e}`),console.warn(r),console.groupEnd()):(console.warn(`PixiJS Deprecation Warning: `,`${t}
Deprecated since v${e}`),console.warn(r))),at[t]=!0}var ot;function st(){return typeof ot>`u`&&(ot=function(){let e={stencil:!0,failIfMajorPerformanceCaveat:k.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!k.ADAPTER.getWebGLRenderingContext())return!1;let t=k.ADAPTER.createCanvas(),n=t.getContext(`webgl`,e)||t.getContext(`experimental-webgl`,e),r=!!n?.getContextAttributes()?.stencil;if(n){let e=n.getExtension(`WEBGL_lose_context`);e&&e.loseContext()}return n=null,r}catch{return!1}}()),ot}var ct={grad:.9,turn:360,rad:360/(2*Math.PI)},lt=function(e){return typeof e==`string`?e.length>0:typeof e==`number`},U=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=10**t),Math.round(n*e)/n+0},ut=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=1),e>n?n:e>t?e:t},dt=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},ft=function(e){return{r:ut(e.r,0,255),g:ut(e.g,0,255),b:ut(e.b,0,255),a:ut(e.a)}},pt=function(e){return{r:U(e.r),g:U(e.g),b:U(e.b),a:U(e.a,3)}},mt=/^#([0-9a-f]{3,8})$/i,ht=function(e){var t=e.toString(16);return t.length<2?`0`+t:t},gt=function(e){var t=e.r,n=e.g,r=e.b,i=e.a,a=Math.max(t,n,r),o=a-Math.min(t,n,r),s=o?a===t?(n-r)/o:a===n?2+(r-t)/o:4+(t-n)/o:0;return{h:60*(s<0?s+6:s),s:a?o/a*100:0,v:a/255*100,a:i}},_t=function(e){var t=e.h,n=e.s,r=e.v,i=e.a;t=t/360*6,n/=100,r/=100;var a=Math.floor(t),o=r*(1-n),s=r*(1-(t-a)*n),c=r*(1-(1-t+a)*n),l=a%6;return{r:255*[r,s,o,o,c,r][l],g:255*[c,r,r,s,o,o][l],b:255*[o,o,c,r,r,s][l],a:i}},vt=function(e){return{h:dt(e.h),s:ut(e.s,0,100),l:ut(e.l,0,100),a:ut(e.a)}},yt=function(e){return{h:U(e.h),s:U(e.s),l:U(e.l),a:U(e.a,3)}},bt=function(e){return _t((n=(t=e).s,{h:t.h,s:(n*=((r=t.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:t.a}));var t,n,r},xt=function(e){return{h:(t=gt(e)).h,s:(i=(200-(n=t.s))*(r=t.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,n,r,i},St=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ct=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,wt=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Tt=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Et={string:[[function(e){var t=mt.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?U(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?U(parseInt(e.substr(6,2),16)/255,2):1}:null:null},`hex`],[function(e){var t=wt.exec(e)||Tt.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:ft({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},`rgb`],[function(e){var t=St.exec(e)||Ct.exec(e);if(!t)return null;var n,r,i=vt({h:(n=t[1],r=t[2],r===void 0&&(r=`deg`),Number(n)*(ct[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return bt(i)},`hsl`]],object:[[function(e){var t=e.r,n=e.g,r=e.b,i=e.a,a=i===void 0?1:i;return lt(t)&&lt(n)&&lt(r)?ft({r:Number(t),g:Number(n),b:Number(r),a:Number(a)}):null},`rgb`],[function(e){var t=e.h,n=e.s,r=e.l,i=e.a,a=i===void 0?1:i;if(!lt(t)||!lt(n)||!lt(r))return null;var o=vt({h:Number(t),s:Number(n),l:Number(r),a:Number(a)});return bt(o)},`hsl`],[function(e){var t=e.h,n=e.s,r=e.v,i=e.a,a=i===void 0?1:i;if(!lt(t)||!lt(n)||!lt(r))return null;var o=function(e){return{h:dt(e.h),s:ut(e.s,0,100),v:ut(e.v,0,100),a:ut(e.a)}}({h:Number(t),s:Number(n),v:Number(r),a:Number(a)});return _t(o)},`hsv`]]},Dt=function(e,t){for(var n=0;n<t.length;n++){var r=t[n][0](e);if(r)return[r,t[n][1]]}return[null,void 0]},Ot=function(e){return typeof e==`string`?Dt(e.trim(),Et.string):typeof e==`object`&&e?Dt(e,Et.object):[null,void 0]},kt=function(e,t){var n=xt(e);return{h:n.h,s:ut(n.s+100*t,0,100),l:n.l,a:n.a}},At=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},jt=function(e,t){var n=xt(e);return{h:n.h,s:n.s,l:ut(n.l+100*t,0,100),a:n.a}},Mt=function(){function e(e){this.parsed=Ot(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return U(At(this.rgba),2)},e.prototype.isDark=function(){return At(this.rgba)<.5},e.prototype.isLight=function(){return At(this.rgba)>=.5},e.prototype.toHex=function(){return e=pt(this.rgba),t=e.r,n=e.g,r=e.b,a=(i=e.a)<1?ht(U(255*i)):``,`#`+ht(t)+ht(n)+ht(r)+a;var e,t,n,r,i,a},e.prototype.toRgb=function(){return pt(this.rgba)},e.prototype.toRgbString=function(){return e=pt(this.rgba),t=e.r,n=e.g,r=e.b,(i=e.a)<1?`rgba(`+t+`, `+n+`, `+r+`, `+i+`)`:`rgb(`+t+`, `+n+`, `+r+`)`;var e,t,n,r,i},e.prototype.toHsl=function(){return yt(xt(this.rgba))},e.prototype.toHslString=function(){return e=yt(xt(this.rgba)),t=e.h,n=e.s,r=e.l,(i=e.a)<1?`hsla(`+t+`, `+n+`%, `+r+`%, `+i+`)`:`hsl(`+t+`, `+n+`%, `+r+`%)`;var e,t,n,r,i},e.prototype.toHsv=function(){return e=gt(this.rgba),{h:U(e.h),s:U(e.s),v:U(e.v),a:U(e.a,3)};var e},e.prototype.invert=function(){return Nt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return e===void 0&&(e=.1),Nt(kt(this.rgba,e))},e.prototype.desaturate=function(e){return e===void 0&&(e=.1),Nt(kt(this.rgba,-e))},e.prototype.grayscale=function(){return Nt(kt(this.rgba,-1))},e.prototype.lighten=function(e){return e===void 0&&(e=.1),Nt(jt(this.rgba,e))},e.prototype.darken=function(e){return e===void 0&&(e=.1),Nt(jt(this.rgba,-e))},e.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return typeof e==`number`?Nt({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):U(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=xt(this.rgba);return typeof e==`number`?Nt({h:e,s:t.s,l:t.l,a:t.a}):U(t.h)},e.prototype.isEqual=function(e){return this.toHex()===Nt(e).toHex()},e}(),Nt=function(e){return e instanceof Mt?e:new Mt(e)},Pt=[],Ft=function(e){e.forEach(function(e){Pt.indexOf(e)<0&&(e(Mt,Et),Pt.push(e))})};function It(e,t){var n={white:`#ffffff`,bisque:`#ffe4c4`,blue:`#0000ff`,cadetblue:`#5f9ea0`,chartreuse:`#7fff00`,chocolate:`#d2691e`,coral:`#ff7f50`,antiquewhite:`#faebd7`,aqua:`#00ffff`,azure:`#f0ffff`,whitesmoke:`#f5f5f5`,papayawhip:`#ffefd5`,plum:`#dda0dd`,blanchedalmond:`#ffebcd`,black:`#000000`,gold:`#ffd700`,goldenrod:`#daa520`,gainsboro:`#dcdcdc`,cornsilk:`#fff8dc`,cornflowerblue:`#6495ed`,burlywood:`#deb887`,aquamarine:`#7fffd4`,beige:`#f5f5dc`,crimson:`#dc143c`,cyan:`#00ffff`,darkblue:`#00008b`,darkcyan:`#008b8b`,darkgoldenrod:`#b8860b`,darkkhaki:`#bdb76b`,darkgray:`#a9a9a9`,darkgreen:`#006400`,darkgrey:`#a9a9a9`,peachpuff:`#ffdab9`,darkmagenta:`#8b008b`,darkred:`#8b0000`,darkorchid:`#9932cc`,darkorange:`#ff8c00`,darkslateblue:`#483d8b`,gray:`#808080`,darkslategray:`#2f4f4f`,darkslategrey:`#2f4f4f`,deeppink:`#ff1493`,deepskyblue:`#00bfff`,wheat:`#f5deb3`,firebrick:`#b22222`,floralwhite:`#fffaf0`,ghostwhite:`#f8f8ff`,darkviolet:`#9400d3`,magenta:`#ff00ff`,green:`#008000`,dodgerblue:`#1e90ff`,grey:`#808080`,honeydew:`#f0fff0`,hotpink:`#ff69b4`,blueviolet:`#8a2be2`,forestgreen:`#228b22`,lawngreen:`#7cfc00`,indianred:`#cd5c5c`,indigo:`#4b0082`,fuchsia:`#ff00ff`,brown:`#a52a2a`,maroon:`#800000`,mediumblue:`#0000cd`,lightcoral:`#f08080`,darkturquoise:`#00ced1`,lightcyan:`#e0ffff`,ivory:`#fffff0`,lightyellow:`#ffffe0`,lightsalmon:`#ffa07a`,lightseagreen:`#20b2aa`,linen:`#faf0e6`,mediumaquamarine:`#66cdaa`,lemonchiffon:`#fffacd`,lime:`#00ff00`,khaki:`#f0e68c`,mediumseagreen:`#3cb371`,limegreen:`#32cd32`,mediumspringgreen:`#00fa9a`,lightskyblue:`#87cefa`,lightblue:`#add8e6`,midnightblue:`#191970`,lightpink:`#ffb6c1`,mistyrose:`#ffe4e1`,moccasin:`#ffe4b5`,mintcream:`#f5fffa`,lightslategray:`#778899`,lightslategrey:`#778899`,navajowhite:`#ffdead`,navy:`#000080`,mediumvioletred:`#c71585`,powderblue:`#b0e0e6`,palegoldenrod:`#eee8aa`,oldlace:`#fdf5e6`,paleturquoise:`#afeeee`,mediumturquoise:`#48d1cc`,mediumorchid:`#ba55d3`,rebeccapurple:`#663399`,lightsteelblue:`#b0c4de`,mediumslateblue:`#7b68ee`,thistle:`#d8bfd8`,tan:`#d2b48c`,orchid:`#da70d6`,mediumpurple:`#9370db`,purple:`#800080`,pink:`#ffc0cb`,skyblue:`#87ceeb`,springgreen:`#00ff7f`,palegreen:`#98fb98`,red:`#ff0000`,yellow:`#ffff00`,slateblue:`#6a5acd`,lavenderblush:`#fff0f5`,peru:`#cd853f`,palevioletred:`#db7093`,violet:`#ee82ee`,teal:`#008080`,slategray:`#708090`,slategrey:`#708090`,aliceblue:`#f0f8ff`,darkseagreen:`#8fbc8f`,darkolivegreen:`#556b2f`,greenyellow:`#adff2f`,seagreen:`#2e8b57`,seashell:`#fff5ee`,tomato:`#ff6347`,silver:`#c0c0c0`,sienna:`#a0522d`,lavender:`#e6e6fa`,lightgreen:`#90ee90`,orange:`#ffa500`,orangered:`#ff4500`,steelblue:`#4682b4`,royalblue:`#4169e1`,turquoise:`#40e0d0`,yellowgreen:`#9acd32`,salmon:`#fa8072`,saddlebrown:`#8b4513`,sandybrown:`#f4a460`,rosybrown:`#bc8f8f`,darksalmon:`#e9967a`,lightgoldenrodyellow:`#fafad2`,snow:`#fffafa`,lightgrey:`#d3d3d3`,lightgray:`#d3d3d3`,dimgray:`#696969`,dimgrey:`#696969`,olivedrab:`#6b8e23`,olive:`#808000`},r={};for(var i in n)r[n[i]]=i;var a={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return`transparent`;var i,o,s=r[this.toHex()];if(s)return s;if(t?.closest){var c=this.toRgb(),l=1/0,u=`black`;if(!a.length)for(var d in n)a[d]=new e(n[d]).toRgb();for(var f in n){var p=(i=c,o=a[f],(i.r-o.r)**2+(i.g-o.g)**2+(i.b-o.b)**2);p<l&&(l=p,u=f)}return u}},t.string.push([function(t){var r=t.toLowerCase(),i=r===`transparent`?`#0000`:n[r];return i?new e(i).toRgb():null},`name`])}Ft([It]);var Lt=class e{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(t){if(t instanceof e)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw Error(`Cannot set PIXI.Color#value to null`);(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(e){return typeof e==`string`||typeof e==`number`||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e==`object`&&e?{...e}:e}isSourceEqual(e,t){let n=typeof e;if(n!==typeof t)return!1;if(n===`number`||n===`string`||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length===t.length?e.every((e,n)=>e===t[n]):!1;if(e!==null&&t!==null){let n=Object.keys(e);return n.length===Object.keys(t).length?n.every(n=>e[n]===t[n]):!1}return e===t}toRgba(){let[e,t,n,r]=this._components;return{r:e,g:t,b:n,a:r}}toRgb(){let[e,t,n]=this._components;return{r:e,g:t,b:n}}toRgbaString(){let[e,t,n]=this.toUint8RgbArray();return`rgba(${e},${t},${n},${this.alpha})`}toUint8RgbArray(e){let[t,n,r]=this._components;return e??=[],e[0]=Math.round(t*255),e[1]=Math.round(n*255),e[2]=Math.round(r*255),e}toRgbArray(e){e??=[];let[t,n,r]=this._components;return e[0]=t,e[1]=n,e[2]=r,e}toNumber(){return this._int}toLittleEndianNumber(){let e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(t){let[n,r,i,a]=e.temp.setValue(t)._components;return this._components[0]*=n,this._components[1]*=r,this._components[2]*=i,this._components[3]*=a,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let n=this._int>>16&255,r=this._int>>8&255,i=this._int&255;return t&&(n=n*e+.5|0,r=r*e+.5|0,i=i*e+.5|0),(e*255<<24)+(n<<16)+(r<<8)+i}toHex(){let e=this._int.toString(16);return`#${`000000`.substring(0,6-e.length)+e}`}toHexa(){let e=Math.round(this._components[3]*255).toString(16);return this.toHex()+`00`.substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){let[t,n,r]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(n*e)/e,this._components[2]=Math.round(r*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e??=[];let[t,n,r,i]=this._components;return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}normalize(t){let n,r,i,a;if((typeof t==`number`||t instanceof Number)&&t>=0&&t<=16777215){let e=t;n=(e>>16&255)/255,r=(e>>8&255)/255,i=(e&255)/255,a=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[n,r,i,a=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[n,r,i,a=255]=t,n/=255,r/=255,i/=255,a/=255;else if(typeof t==`string`||typeof t==`object`){if(typeof t==`string`){let n=e.HEX_PATTERN.exec(t);n&&(t=`#${n[2]}`)}let o=Nt(t);o.isValid()&&({r:n,g:r,b:i,a}=o.rgba,n/=255,r/=255,i/=255)}if(n!==void 0)this._components[0]=n,this._components[1]=r,this._components[2]=i,this._components[3]=a,this.refreshInt();else throw Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);let[e,t,n]=this._components;this._int=(e*255<<16)+(t*255<<8)+(n*255|0)}_clamp(e,t=0,n=1){return typeof e==`number`?Math.min(Math.max(e,t),n):(e.forEach((r,i)=>{e[i]=Math.min(Math.max(r,t),n)}),e)}};Lt.shared=new Lt,Lt.temp=new Lt,Lt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;var W=Lt;function Rt(e,t=[]){return H(`7.2.0`,`utils.hex2rgb is deprecated, use Color#toRgbArray instead`),W.shared.setValue(e).toRgbArray(t)}function zt(e){return H(`7.2.0`,`utils.rgb2hex is deprecated, use Color#toNumber instead`),W.shared.setValue(e).toNumber()}function Bt(){let e=[],t=[];for(let n=0;n<32;n++)e[n]=n,t[n]=n;e[f.NORMAL_NPM]=f.NORMAL,e[f.ADD_NPM]=f.ADD,e[f.SCREEN_NPM]=f.SCREEN,t[f.NORMAL]=f.NORMAL_NPM,t[f.ADD]=f.ADD_NPM,t[f.SCREEN]=f.SCREEN_NPM;let n=[];return n.push(t),n.push(e),n}var Vt=Bt();function Ht(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?`Float32Array`:e instanceof Uint32Array?`Uint32Array`:`Int32Array`;if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return`Uint16Array`}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return`Uint8Array`;return null}function Ut(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function Wt(e){return!(e&e-1)&&!!e}function Gt(e){let t=(e>65535?1:0)<<4;e>>>=t;let n=(e>255?1:0)<<3;return e>>>=n,t|=n,n=(e>15?1:0)<<2,e>>>=n,t|=n,n=(e>3?1:0)<<1,e>>>=n,t|=n,t|e>>1}function Kt(e,t,n){let r=e.length,i;if(t>=r||n===0)return;n=t+n>r?r-t:n;let a=r-n;for(i=t;i<a;++i)e[i]=e[i+n];e.length=a}function qt(e){return e===0?0:e<0?-1:1}var Jt=0;function Yt(){return++Jt}var Xt=class{constructor(e,t,n,r){this.left=e,this.top=t,this.right=n,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Xt.EMPTY=new Xt(0,0,0,0);var Zt=Xt,Qt={},$t=Object.create(null),en=Object.create(null);function tn(e,t,n){for(let r=0,i=4*n*t;r<t;++r,i+=4)if(e[i+3]!==0)return!1;return!0}function nn(e,t,n,r,i){let a=4*t;for(let t=r,o=r*a+4*n;t<=i;++t,o+=a)if(e[o+3]!==0)return!1;return!0}function rn(e){let{width:t,height:n}=e,r=e.getContext(`2d`,{willReadFrequently:!0});if(r===null)throw TypeError(`Failed to get canvas 2D context`);let i=r.getImageData(0,0,t,n).data,a=0,o=0,s=t-1,c=n-1;for(;o<n&&tn(i,t,o);)++o;if(o===n)return Zt.EMPTY;for(;tn(i,t,c);)--c;for(;nn(i,t,a,o,c);)++a;for(;nn(i,t,s,o,c);)--s;return++s,++c,new Zt(a,o,s,c)}function an(e){let t=rn(e),{width:n,height:r}=t,i=null;if(!t.isEmpty()){let a=e.getContext(`2d`);if(a===null)throw TypeError(`Failed to get canvas 2D context`);i=a.getImageData(t.left,t.top,n,r)}return{width:n,height:r,data:i}}function on(e,t=globalThis.location){if(e.startsWith(`data:`))return``;t||=globalThis.location;let n=new URL(e,document.baseURI);return n.hostname!==t.hostname||n.port!==t.port||n.protocol!==t.protocol?`anonymous`:``}function sn(e,t=1){let n=k.RETINA_PREFIX?.exec(e);return n?parseFloat(n[1]):t}var G=(e=>(e.Renderer=`renderer`,e.Application=`application`,e.RendererSystem=`renderer-webgl-system`,e.RendererPlugin=`renderer-webgl-plugin`,e.CanvasRendererSystem=`renderer-canvas-system`,e.CanvasRendererPlugin=`renderer-canvas-plugin`,e.Asset=`asset`,e.LoadParser=`load-parser`,e.ResolveParser=`resolve-parser`,e.CacheParser=`cache-parser`,e.DetectionParser=`detection-parser`,e))(G||{}),cn=e=>{if(typeof e==`function`||typeof e==`object`&&e.extension){if(!e.extension)throw Error(`Extension class must have an extension object`);e={...typeof e.extension==`object`?e.extension:{type:e.extension},ref:e}}if(typeof e==`object`)e={...e};else throw Error(`Invalid extension type`);return typeof e.type==`string`&&(e.type=[e.type]),e},ln=(e,t)=>cn(e).priority??t,K={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(cn).forEach(e=>{e.type.forEach(t=>this._removeHandlers[t]?.(e))}),this},add(...e){return e.map(cn).forEach(e=>{e.type.forEach(t=>{let n=this._addHandlers,r=this._queue;n[t]?n[t]?.(e):(r[t]=r[t]||[],r[t]?.push(e))})}),this},handle(e,t,n){let r=this._addHandlers,i=this._removeHandlers;if(r[e]||i[e])throw Error(`Extension type ${e} already has a handler`);r[e]=t,i[e]=n;let a=this._queue;return a[e]&&(a[e]?.forEach(e=>t(e)),delete a[e]),this},handleByMap(e,t){return this.handle(e,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByList(e,t,n=-1){return this.handle(e,e=>{t.includes(e.ref)||(t.push(e.ref),t.sort((e,t)=>ln(t,n)-ln(e,n)))},e=>{let n=t.indexOf(e.ref);n!==-1&&t.splice(n,1)})}},un=class{constructor(e){typeof e==`number`?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||=new Int8Array(this.rawBinaryData),this._int8View}get uint8View(){return this._uint8View||=new Uint8Array(this.rawBinaryData),this._uint8View}get int16View(){return this._int16View||=new Int16Array(this.rawBinaryData),this._int16View}get uint16View(){return this._uint16View||=new Uint16Array(this.rawBinaryData),this._uint16View}get int32View(){return this._int32View||=new Int32Array(this.rawBinaryData),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case`int8`:case`uint8`:return 1;case`int16`:case`uint16`:return 2;case`int32`:case`uint32`:case`float32`:return 4;default:throw Error(`${e} isn't a valid view type`)}}},dn=[`precision mediump float;`,`void main(void){`,`float test = 0.1;`,`%forloop%`,`gl_FragColor = vec4(0.0);`,`}`].join(`
`);function fn(e){let t=``;for(let n=0;n<e;++n)n>0&&(t+=`
else `),n<e-1&&(t+=`if(test == ${n}.0){}`);return t}function pn(e,t){if(e===0)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let n=t.createShader(t.FRAGMENT_SHADER);for(;;){let r=dn.replace(/%forloop%/gi,fn(e));if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))e=e/2|0;else break}return e}var mn=0,hn=1,gn=2,_n=3,vn=4,yn=5,bn=class e{constructor(){this.data=0,this.blendMode=f.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<mn)}set blend(e){!!(this.data&1<<mn)!==e&&(this.data^=1<<mn)}get offsets(){return!!(this.data&1<<hn)}set offsets(e){!!(this.data&1<<hn)!==e&&(this.data^=1<<hn)}get culling(){return!!(this.data&1<<gn)}set culling(e){!!(this.data&1<<gn)!==e&&(this.data^=1<<gn)}get depthTest(){return!!(this.data&1<<_n)}set depthTest(e){!!(this.data&1<<_n)!==e&&(this.data^=1<<_n)}get depthMask(){return!!(this.data&1<<yn)}set depthMask(e){!!(this.data&1<<yn)!==e&&(this.data^=1<<yn)}get clockwiseFrontFace(){return!!(this.data&1<<vn)}set clockwiseFrontFace(e){!!(this.data&1<<vn)!==e&&(this.data^=1<<vn)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==f.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){let t=new e;return t.depthTest=!1,t.blend=!0,t}};bn.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};var xn=[];function Sn(e,t){if(!e)return null;let n=``;if(typeof e==`string`){let t=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);t&&(n=t[1].toLowerCase())}for(let r=xn.length-1;r>=0;--r){let i=xn[r];if(i.test&&i.test(e,n))return new i(e,t)}throw Error(`Unrecognized source type to auto-detect Resource`)}var Cn=class{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,n,r,i,a,o,s){if(arguments.length>8)throw Error(`max arguments reached`);let{name:c,items:l}=this;this._aliasCount++;for(let u=0,d=l.length;u<d;u++)l[u][c](e,t,n,r,i,a,o,s);return l===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){let t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=``}get empty(){return this.items.length===0}get name(){return this._name}};Object.defineProperties(Cn.prototype,{dispatch:{value:Cn.prototype.emit},run:{value:Cn.prototype.emit}});var wn=class{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new Cn(`setRealSize`),this.onUpdate=new Cn(`update`),this.onError=new Cn(`onError`)}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}},Tn=class extends wn{constructor(e,t){let{width:n,height:r}=t||{};if(!n||!r)throw Error(`BufferResource width or height invalid`);super(n,r),this.data=e,this.unpackAlignment=t.unpackAlignment??4}upload(e,t,n){let r=e.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,this.unpackAlignment),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===x.UNPACK);let i=t.realWidth,a=t.realHeight;return n.width===i&&n.height===a?r.texSubImage2D(t.target,0,0,0,i,a,t.format,n.type,this.data):(n.width=i,n.height=a,r.texImage2D(t.target,0,n.internalFormat,i,a,0,t.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}},En={scaleMode:v.NEAREST,alphaMode:x.NPM},Dn=class e extends it.default{constructor(t=null,n=null){super(),n=Object.assign({},e.defaultOptions,n);let{alphaMode:r,mipmap:i,anisotropicLevel:a,scaleMode:o,width:s,height:c,wrapMode:l,format:u,type:d,target:f,resolution:p,resourceOptions:m}=n;t&&!(t instanceof wn)&&(t=Sn(t,m),t.internal=!0),this.resolution=p||k.RESOLUTION,this.width=Math.round((s||0)*this.resolution)/this.resolution,this.height=Math.round((c||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=a,this._wrapMode=l,this._scaleMode=o,this.format=u,this.type=d,this.target=f,this.alphaMode=r,this.uid=Yt(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=s>0&&c>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,n=!0),n&&this.dirtyStyleId++,this}setSize(e,t,n){return n||=this.resolution,this.setRealSize(e*n,t*n,n)}setRealSize(e,t,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Wt(this.realWidth)&&Wt(this.realHeight)}setResolution(e){let t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit(`update`,this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw Error(`Resource can be set only once`);return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit(`update`,this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit(`loaded`,this),this.emit(`update`,this))}onError(e){this.emit(`error`,this,e)}destroy(){this.resource&&=(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),null),this.cacheId&&=(delete en[this.cacheId],delete $t[this.cacheId],null),this.valid=!1,this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit(`destroyed`,this),this.removeAllListeners()}dispose(){this.emit(`dispose`,this)}castToBaseTexture(){return this}static from(t,n,r=k.STRICT_TEXTURE_CACHE){let i=typeof t==`string`,a=null;i?a=t:(t._pixiId||=`${n?.pixiIdPrefix||`pixiid`}_${Yt()}`,a=t._pixiId);let o=en[a];if(i&&r&&!o)throw Error(`The cacheId "${a}" does not exist in BaseTextureCache.`);return o||(o=new e(t,n),o.cacheId=a,e.addToCache(o,a)),o}static fromBuffer(t,n,r,i){t||=new Float32Array(n*r*4);let a=new Tn(t,{width:n,height:r,...i?.resourceOptions}),o,s;return t instanceof Float32Array?(o=m.RGBA,s=g.FLOAT):t instanceof Int32Array?(o=m.RGBA_INTEGER,s=g.INT):t instanceof Uint32Array?(o=m.RGBA_INTEGER,s=g.UNSIGNED_INT):t instanceof Int16Array?(o=m.RGBA_INTEGER,s=g.SHORT):t instanceof Uint16Array?(o=m.RGBA_INTEGER,s=g.UNSIGNED_SHORT):t instanceof Int8Array?(o=m.RGBA,s=g.BYTE):(o=m.RGBA,s=g.UNSIGNED_BYTE),a.internal=!0,new e(a,Object.assign({},En,{type:s,format:o},i))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),en[t]&&en[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),en[t]=e)}static removeFromCache(e){if(typeof e==`string`){let t=en[e];if(t){let n=t.textureCacheIds.indexOf(e);return n>-1&&t.textureCacheIds.splice(n,1),delete en[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete en[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};Dn.defaultOptions={mipmap:b.POW2,anisotropicLevel:0,scaleMode:v.LINEAR,wrapMode:y.CLAMP,alphaMode:x.UNPACK,target:h.TEXTURE_2D,format:m.RGBA,type:g.UNSIGNED_BYTE},Dn._globalBatch=0;var q=Dn,On=class{constructor(){this.texArray=null,this.blend=0,this.type=p.TRIANGLES,this.start=0,this.size=0,this.data=null}},kn=0,An=class e{constructor(e,t=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=t,this.id=kn++,this.disposeRunner=new Cn(`disposeBuffer`)}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?O.ELEMENT_ARRAY_BUFFER:O.ARRAY_BUFFER}get index(){return this.type===O.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new e(t)}},jn=class e{constructor(e,t=0,n=!1,r=g.FLOAT,i,a,o,s=1){this.buffer=e,this.size=t,this.normalized=n,this.type=r,this.stride=i,this.start=a,this.instance=o,this.divisor=s}destroy(){this.buffer=null}static from(t,n,r,i,a){return new e(t,n,r,i,a)}},Mn={Float32Array,Uint32Array,Int32Array,Uint8Array};function Nn(e,t){let n=0,r=0,i={};for(let i=0;i<e.length;i++)r+=t[i],n+=e[i].length;let a=new ArrayBuffer(n*4),o=null,s=0;for(let n=0;n<e.length;n++){let c=t[n],l=e[n],u=Ht(l);i[u]||(i[u]=new Mn[u](a)),o=i[u];for(let e=0;e<l.length;e++){let t=(e/c|0)*r+s,n=e%c;o[t+n]=l[e]}s+=c}return new Float32Array(a)}var Pn={5126:4,5123:2,5121:1},Fn=0,In={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Ln=class e{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=Fn++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Cn(`disposeGeometry`),this.refCount=0}addAttribute(e,t,n=0,r=!1,i,a,o,s=!1){if(!t)throw Error(`You must pass a buffer when creating an attribute`);t instanceof An||(t instanceof Array&&(t=new Float32Array(t)),t=new An(t));let c=e.split(`|`);if(c.length>1){for(let e=0;e<c.length;e++)this.addAttribute(c[e],t,n,r,i);return this}let l=this.buffers.indexOf(t);return l===-1&&(this.buffers.push(t),l=this.buffers.length-1),this.attributes[e]=new jn(l,n,r,i,a,o,s),this.instanced=this.instanced||s,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof An||(e instanceof Array&&(e=new Uint16Array(e)),e=new An(e)),e.type=O.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let e=[],t=[],n=new An,r;for(r in this.attributes){let n=this.attributes[r],i=this.buffers[n.buffer];e.push(i.data),t.push(n.size*Pn[n.type]/4),n.buffer=0}for(n.data=Nn(e,t),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let e in this.attributes){let t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let t=new e;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new An(this.buffers[e].data.slice(0));for(let e in this.attributes){let n=this.attributes[e];t.attributes[e]=new jn(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=O.ELEMENT_ARRAY_BUFFER),t}static merge(t){let n=new e,r=[],i=[],a=[],o;for(let e=0;e<t.length;e++){o=t[e];for(let e=0;e<o.buffers.length;e++)i[e]=i[e]||0,i[e]+=o.buffers[e].data.length,a[e]=0}for(let e=0;e<o.buffers.length;e++)r[e]=new In[Ht(o.buffers[e].data)](i[e]),n.buffers[e]=new An(r[e]);for(let e=0;e<t.length;e++){o=t[e];for(let e=0;e<o.buffers.length;e++)r[e].set(o.buffers[e].data,a[e]),a[e]+=o.buffers[e].data.length}if(n.attributes=o.attributes,o.indexBuffer){n.indexBuffer=n.buffers[o.buffers.indexOf(o.indexBuffer)],n.indexBuffer.type=O.ELEMENT_ARRAY_BUFFER;let e=0,r=0,i=0,a=0;for(let e=0;e<o.buffers.length;e++)if(o.buffers[e]!==o.indexBuffer){a=e;break}for(let e in o.attributes){let t=o.attributes[e];(t.buffer|0)===a&&(r+=t.size*Pn[t.type]/4)}for(let o=0;o<t.length;o++){let s=t[o].indexBuffer.data;for(let t=0;t<s.length;t++)n.indexBuffer.data[t+i]+=e;e+=t[o].buffers[a].data.length/r,i+=s.length}}return n}},Rn=class extends Ln{constructor(e=!1){super(),this._buffer=new An(null,e,!1),this._indexBuffer=new An(null,e,!0),this.addAttribute(`aVertexPosition`,this._buffer,2,!1,g.FLOAT).addAttribute(`aTextureCoord`,this._buffer,2,!1,g.FLOAT).addAttribute(`aColor`,this._buffer,4,!0,g.UNSIGNED_BYTE).addAttribute(`aTextureId`,this._buffer,1,!0,g.FLOAT).addIndex(this._indexBuffer)}},zn=Math.PI*2,Bn=180/Math.PI,Vn=Math.PI/180,J=(e=>(e[e.POLY=0]=`POLY`,e[e.RECT=1]=`RECT`,e[e.CIRC=2]=`CIRC`,e[e.ELIP=3]=`ELIP`,e[e.RREC=4]=`RREC`,e))(J||{}),Y=class e{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new e(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}};Y.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};var Hn=[new Y,new Y,new Y,new Y],X=class e{constructor(e=0,t=0,n=0,r=0){this.x=Number(e),this.y=Number(t),this.width=Number(n),this.height=Number(r),this.type=J.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new e(0,0,0,0)}clone(){return new e(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}intersects(e,t){if(!t)return(this.right>e.right?e.right:this.right)<=(this.x<e.x?e.x:this.x)?!1:(this.bottom>e.bottom?e.bottom:this.bottom)>(this.y<e.y?e.y:this.y);let n=this.left,r=this.right,i=this.top,a=this.bottom;if(r<=n||a<=i)return!1;let o=Hn[0].set(e.left,e.top),s=Hn[1].set(e.left,e.bottom),c=Hn[2].set(e.right,e.top),l=Hn[3].set(e.right,e.bottom);if(c.x<=o.x||s.y<=o.y)return!1;let u=Math.sign(t.a*t.d-t.b*t.c);if(u===0||(t.apply(o,o),t.apply(s,s),t.apply(c,c),t.apply(l,l),Math.max(o.x,s.x,c.x,l.x)<=n||Math.min(o.x,s.x,c.x,l.x)>=r||Math.max(o.y,s.y,c.y,l.y)<=i||Math.min(o.y,s.y,c.y,l.y)>=a))return!1;let d=u*(s.y-o.y),f=u*(o.x-s.x),p=d*n+f*i,m=d*r+f*i,h=d*n+f*a,g=d*r+f*a;if(Math.max(p,m,h,g)<=d*o.x+f*o.y||Math.min(p,m,h,g)>=d*l.x+f*l.y)return!1;let _=u*(o.y-c.y),v=u*(c.x-o.x),y=_*n+v*i,b=_*r+v*i,x=_*n+v*a,S=_*r+v*a;return!(Math.max(y,b,x,S)<=_*o.x+v*o.y||Math.min(y,b,x,S)>=_*l.x+v*l.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){let t=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(n-t,0),this.y=r,this.height=Math.max(i-r,0),this}ceil(e=1,t=.001){let n=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=n-this.x,this.height=r-this.y,this}enlarge(e){let t=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=n-t,this.y=r,this.height=i-r,this}};X.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};var Un=class e{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.radius=n,this.type=J.CIRC}clone(){return new e(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;let n=this.radius*this.radius,r=this.x-e,i=this.y-t;return r*=r,i*=i,r+i<=n}getBounds(){return new X(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}};Un.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};var Wn=class e{constructor(e=0,t=0,n=0,r=0){this.x=e,this.y=t,this.width=n,this.height=r,this.type=J.ELIP}clone(){return new e(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,r=(t-this.y)/this.height;return n*=n,r*=r,n+r<=1}getBounds(){return new X(this.x-this.width,this.y-this.height,this.width,this.height)}};Wn.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};var Gn=class e{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!=`number`){let e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n].x,t[n].y);t=e}this.points=t,this.type=J.POLY,this.closeStroke=!0}clone(){let t=this.points.slice(),n=new e(t);return n.closeStroke=this.closeStroke,n}contains(e,t){let n=!1,r=this.points.length/2;for(let i=0,a=r-1;i<r;a=i++){let r=this.points[i*2],o=this.points[i*2+1],s=this.points[a*2],c=this.points[a*2+1];o>t!=c>t&&e<(s-r)*((t-o)/(c-o))+r&&(n=!n)}return n}};Gn.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((e,t)=>`${e}, ${t}`,``)}]`};var Kn=class e{constructor(e=0,t=0,n=0,r=0,i=20){this.x=e,this.y=t,this.width=n,this.height=r,this.radius=i,this.type=J.RREC}clone(){return new e(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){let n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+n&&t<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let r=e-(this.x+n),i=t-(this.y+n),a=n*n;if(r*r+i*i<=a||(r=e-(this.x+this.width-n),r*r+i*i<=a)||(i=t-(this.y+this.height-n),r*r+i*i<=a)||(r=e-(this.x+n),r*r+i*i<=a))return!0}return!1}};Kn.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};var Z=class e{constructor(e=1,t=0,n=0,r=1,i=0,a=0){this.array=null,this.a=e,this.b=t,this.c=n,this.d=r,this.tx=i,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,n,r,i,a){return this.a=e,this.b=t,this.c=n,this.d=r,this.tx=i,this.ty=a,this}toArray(e,t){this.array||=new Float32Array(9);let n=t||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,t){t||=new Y;let n=e.x,r=e.y;return t.x=this.a*n+this.c*r+this.tx,t.y=this.b*n+this.d*r+this.ty,t}applyInverse(e,t){t||=new Y;let n=1/(this.a*this.d+this.c*-this.b),r=e.x,i=e.y;return t.x=this.d*n*r+-this.c*n*i+(this.ty*this.c-this.tx*this.d)*n,t.y=this.a*n*i+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){let t=Math.cos(e),n=Math.sin(e),r=this.a,i=this.c,a=this.tx;return this.a=r*t-this.b*n,this.b=r*n+this.b*t,this.c=i*t-this.d*n,this.d=i*n+this.d*t,this.tx=a*t-this.ty*n,this.ty=a*n+this.ty*t,this}append(e){let t=this.a,n=this.b,r=this.c,i=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*n+e.b*i,this.c=e.c*t+e.d*r,this.d=e.c*n+e.d*i,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*n+e.ty*i+this.ty,this}setTransform(e,t,n,r,i,a,o,s,c){return this.a=Math.cos(o+c)*i,this.b=Math.sin(o+c)*i,this.c=-Math.sin(o-s)*a,this.d=Math.cos(o-s)*a,this.tx=e-(n*this.a+r*this.c),this.ty=t-(n*this.b+r*this.d),this}prepend(e){let t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){let t=this.a,n=this.c;this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){let t=this.a,n=this.b,r=this.c,i=this.d,a=e.pivot,o=-Math.atan2(-r,i),s=Math.atan2(n,t),c=Math.abs(o+s);return c<1e-5||Math.abs(zn-c)<1e-5?(e.rotation=s,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=s),e.scale.x=Math.sqrt(t*t+n*n),e.scale.y=Math.sqrt(r*r+i*i),e.position.x=this.tx+(a.x*t+a.y*r),e.position.y=this.ty+(a.x*n+a.y*i),e}invert(){let e=this.a,t=this.b,n=this.c,r=this.d,i=this.tx,a=e*r-t*n;return this.a=r/a,this.b=-t/a,this.c=-n/a,this.d=e/a,this.tx=(n*this.ty-r*i)/a,this.ty=-(e*this.ty-t*i)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new e}static get TEMP_MATRIX(){return new e}};Z.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};var qn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Jn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Yn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Xn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Zn=[],Qn=[],$n=Math.sign;function er(){for(let e=0;e<16;e++){let t=[];Zn.push(t);for(let n=0;n<16;n++){let r=$n(qn[e]*qn[n]+Yn[e]*Jn[n]),i=$n(Jn[e]*qn[n]+Xn[e]*Jn[n]),a=$n(qn[e]*Yn[n]+Yn[e]*Xn[n]),o=$n(Jn[e]*Yn[n]+Xn[e]*Xn[n]);for(let e=0;e<16;e++)if(qn[e]===r&&Jn[e]===i&&Yn[e]===a&&Xn[e]===o){t.push(e);break}}}for(let e=0;e<16;e++){let t=new Z;t.set(qn[e],Jn[e],Yn[e],Xn[e],0,0),Qn.push(t)}}er();var Q={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>qn[e],uY:e=>Jn[e],vX:e=>Yn[e],vY:e=>Xn[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Zn[e][t],sub:(e,t)=>Zn[e][Q.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)==2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?Q.S:Q.N:Math.abs(t)*2<=Math.abs(e)?e>0?Q.E:Q.W:t>0?e>0?Q.SE:Q.SW:e>0?Q.NE:Q.NW,matrixAppendRotationInv:(e,t,n=0,r=0)=>{let i=Qn[Q.inv(t)];i.tx=n,i.ty=r,e.append(i)}},tr=class e{constructor(e,t,n=0,r=0){this._x=n,this._y=r,this.cb=e,this.scope=t}clone(t=this.cb,n=this.scope){return new e(t,n,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}};tr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};var nr=class{constructor(){this.worldTransform=new Z,this.localTransform=new Z,this.position=new tr(this.onChange,this,0,0),this.scale=new tr(this.onChange,this,1,1),this.pivot=new tr(this.onChange,this,0,0),this.skew=new tr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){let e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){let t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){let n=e.worldTransform,r=this.worldTransform;r.a=t.a*n.a+t.b*n.c,r.b=t.a*n.b+t.b*n.d,r.c=t.c*n.a+t.d*n.c,r.d=t.c*n.b+t.d*n.d,r.tx=t.tx*n.a+t.ty*n.c+n.tx,r.ty=t.tx*n.b+t.ty*n.d+n.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};nr.IDENTITY=new nr;var rr=nr;rr.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var ir=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,ar=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function or(e,t,n){let r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}function sr(e){let t=Array(e);for(let e=0;e<t.length;e++)t[e]=!1;return t}function cr(e,t){switch(e){case`float`:return 0;case`vec2`:return new Float32Array(2*t);case`vec3`:return new Float32Array(3*t);case`vec4`:return new Float32Array(4*t);case`int`:case`uint`:case`sampler2D`:case`sampler2DArray`:return 0;case`ivec2`:return new Int32Array(2*t);case`ivec3`:return new Int32Array(3*t);case`ivec4`:return new Int32Array(4*t);case`uvec2`:return new Uint32Array(2*t);case`uvec3`:return new Uint32Array(3*t);case`uvec4`:return new Uint32Array(4*t);case`bool`:return!1;case`bvec2`:return sr(2*t);case`bvec3`:return sr(3*t);case`bvec4`:return sr(4*t);case`mat2`:return new Float32Array([1,0,0,1]);case`mat3`:return new Float32Array([1,0,0,0,1,0,0,0,1]);case`mat4`:return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var lr=[{test:e=>e.type===`float`&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type===`sampler2D`||e.type===`samplerCube`||e.type===`sampler2DArray`)&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type===`mat3`&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type===`vec2`&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type===`vec2`&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type===`vec4`&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>e.type===`vec4`&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>e.type===`vec3`&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>e.type===`vec4`&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}],ur={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:`gl.uniformMatrix2fv(location, false, v)`,mat3:`gl.uniformMatrix3fv(location, false, v)`,mat4:`gl.uniformMatrix4fv(location, false, v)`,sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},dr={float:`gl.uniform1fv(location, v)`,vec2:`gl.uniform2fv(location, v)`,vec3:`gl.uniform3fv(location, v)`,vec4:`gl.uniform4fv(location, v)`,mat4:`gl.uniformMatrix4fv(location, false, v)`,mat3:`gl.uniformMatrix3fv(location, false, v)`,mat2:`gl.uniformMatrix2fv(location, false, v)`,int:`gl.uniform1iv(location, v)`,ivec2:`gl.uniform2iv(location, v)`,ivec3:`gl.uniform3iv(location, v)`,ivec4:`gl.uniform4iv(location, v)`,uint:`gl.uniform1uiv(location, v)`,uvec2:`gl.uniform2uiv(location, v)`,uvec3:`gl.uniform3uiv(location, v)`,uvec4:`gl.uniform4uiv(location, v)`,bool:`gl.uniform1iv(location, v)`,bvec2:`gl.uniform2iv(location, v)`,bvec3:`gl.uniform3iv(location, v)`,bvec4:`gl.uniform4iv(location, v)`,sampler2D:`gl.uniform1iv(location, v)`,samplerCube:`gl.uniform1iv(location, v)`,sampler2DArray:`gl.uniform1iv(location, v)`};function fr(e,t){let n=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let r in e.uniforms){let i=t[r];if(!i){e.uniforms[r]?.group===!0&&(e.uniforms[r].ubo?n.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):n.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}let a=e.uniforms[r],o=!1;for(let e=0;e<lr.length;e++)if(lr[e].test(i,a)){n.push(lr[e].code(r,a)),o=!0;break}if(!o){let e=(i.size===1&&!i.isArray?ur:dr)[i.type].replace(`location`,`ud["${r}"].location`);n.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${e};`)}}return Function(`ud`,`uv`,`renderer`,`syncData`,n.join(`
`))}var pr={},mr=pr;function hr(){if(mr===pr||mr?.isContextLost()){let e=k.ADAPTER.createCanvas(),t;k.PREFER_ENV>=l.WEBGL2&&(t=e.getContext(`webgl2`,{})),t||(t=e.getContext(`webgl`,{})||e.getContext(`experimental-webgl`,{}),t?t.getExtension(`WEBGL_draw_buffers`):t=null),mr=t}return mr}var gr;function _r(){if(!gr){gr=w.MEDIUM;let e=hr();if(e&&e.getShaderPrecisionFormat){let t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);t&&(gr=t.precision?w.HIGH:w.MEDIUM)}}return gr}function vr(e,t){let n=e.getShaderSource(t).split(`
`).map((e,t)=>`${t}: ${e}`),r=e.getShaderInfoLog(t),i=r.split(`
`),a={},o=i.map(e=>parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,`$1`))).filter(e=>e&&!a[e]?(a[e]=!0,!0):!1),s=[``];o.forEach(e=>{n[e-1]=`%c${n[e-1]}%c`,s.push(`background: #FF0000; color:#FFFFFF; font-size: 10px`,`font-size: 10px`)}),s[0]=n.join(`
`),console.error(r),console.groupCollapsed(`click to view full shader code`),console.warn(...s),console.groupEnd()}function yr(e,t,n,r){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(n,e.COMPILE_STATUS)||vr(e,n),e.getShaderParameter(r,e.COMPILE_STATUS)||vr(e,r),console.error(`PixiJS Error: Could not initialize shader.`),e.getProgramInfoLog(t)!==``&&console.warn(`PixiJS Warning: gl.getProgramInfoLog()`,e.getProgramInfoLog(t)))}var br={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function xr(e){return br[e]}var Sr=null,Cr={FLOAT:`float`,FLOAT_VEC2:`vec2`,FLOAT_VEC3:`vec3`,FLOAT_VEC4:`vec4`,INT:`int`,INT_VEC2:`ivec2`,INT_VEC3:`ivec3`,INT_VEC4:`ivec4`,UNSIGNED_INT:`uint`,UNSIGNED_INT_VEC2:`uvec2`,UNSIGNED_INT_VEC3:`uvec3`,UNSIGNED_INT_VEC4:`uvec4`,BOOL:`bool`,BOOL_VEC2:`bvec2`,BOOL_VEC3:`bvec3`,BOOL_VEC4:`bvec4`,FLOAT_MAT2:`mat2`,FLOAT_MAT3:`mat3`,FLOAT_MAT4:`mat4`,SAMPLER_2D:`sampler2D`,INT_SAMPLER_2D:`sampler2D`,UNSIGNED_INT_SAMPLER_2D:`sampler2D`,SAMPLER_CUBE:`samplerCube`,INT_SAMPLER_CUBE:`samplerCube`,UNSIGNED_INT_SAMPLER_CUBE:`samplerCube`,SAMPLER_2D_ARRAY:`sampler2DArray`,INT_SAMPLER_2D_ARRAY:`sampler2DArray`,UNSIGNED_INT_SAMPLER_2D_ARRAY:`sampler2DArray`};function wr(e,t){if(!Sr){let t=Object.keys(Cr);Sr={};for(let n=0;n<t.length;++n){let r=t[n];Sr[e[r]]=Cr[r]}}return Sr[t]}function Tr(e,t,n){if(e.substring(0,9)!==`precision`){let r=t;return t===w.HIGH&&n!==w.HIGH&&(r=w.MEDIUM),`precision ${r} float;
${e}`}else if(n!==w.HIGH&&e.substring(0,15)===`precision highp`)return e.replace(`precision highp`,`precision mediump`);return e}var Er;function Dr(){if(typeof Er==`boolean`)return Er;try{Er=Function(`param1`,`param2`,`param3`,`return param1[param2] === param3;`)({a:`b`},`a`,`b`)===!0}catch{Er=!1}return Er}var Or=0,kr={},Ar=class e{constructor(t,n,r=`pixi-shader`,i={}){this.extra={},this.id=Or++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=n||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!==`#version`&&(r=r.replace(/\s+/g,`-`),kr[r]?(kr[r]++,r+=`-${kr[r]}`):kr[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=Tr(this.vertexSrc,e.defaultVertexPrecision,w.HIGH),this.fragmentSrc=Tr(this.fragmentSrc,e.defaultFragmentPrecision,_r())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return ar}static get defaultFragmentSrc(){return ir}static from(t,n,r){let i=t+n,a=Qt[i];return a||(Qt[i]=a=new e(t,n,r)),a}};Ar.defaultVertexPrecision=w.HIGH,Ar.defaultFragmentPrecision=ce.apple.device?w.HIGH:w.MEDIUM;var jr=Ar,Mr=0,Nr=class e{constructor(e,t,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Mr++,this.static=!!t,this.ubo=!!n,e instanceof An?(this.buffer=e,this.buffer.type=O.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new An(new Float32Array(1)),this.buffer.type=O.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,n,r){if(!this.ubo)this.uniforms[t]=new e(n,r);else throw Error(`[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them`)}static from(t,n,r){return new e(t,n,r)}static uboFrom(t,n){return new e(t,n??!0,!0)}},Pr=class e{constructor(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof Nr?this.uniformGroup=t:this.uniformGroup=new Nr(t):this.uniformGroup=new Nr({}),this.disposeRunner=new Cn(`disposeShader`)}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(let n in t.uniforms){let r=t.uniforms[n];if(r.group===!0&&this.checkUniformExists(e,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,n,r){let i=jr.from(t,n);return new e(i,r)}},Fr=class{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes(`%count%`))throw Error(`Fragment template must contain "%count%".`);if(!t.includes(`%forloop%`))throw Error(`Fragment template must contain "%forloop%".`)}generateShader(e){if(!this.programCache[e]){let t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=n;this.defaultGroupCache[e]=Nr.from({uSamplers:t},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${e}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new jr(this.vertexSrc,n)}let t={tint:new Float32Array([1,1,1,1]),translationMatrix:new Z,default:this.defaultGroupCache[e]};return new Pr(this.programCache[e],t)}generateSampleSrc(e){let t=``;t+=`
`,t+=`
`;for(let n=0;n<e;n++)n>0&&(t+=`
else `),n<e-1&&(t+=`if(vTextureId < ${n}.5)`),t+=`
{`,t+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,t+=`
}`;return t+=`
`,t+=`
`,t}},Ir=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}};function Lr(){return!ce.apple.device}function Rr(e){let t=!0,n=k.ADAPTER.getNavigator();if(ce.tablet||ce.phone){if(ce.apple.device){let e=n.userAgent.match(/OS (\d+)_(\d+)?/);e&&parseInt(e[1],10)<11&&(t=!1)}if(ce.android.device){let e=n.userAgent.match(/Android\s([0-9.]*)/);e&&parseInt(e[1],10)<7&&(t=!1)}}return t?e:4}var zr=class{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}},Br=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Vr=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,Hr=class e extends zr{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=Rn,this.vertexSize=6,this.state=bn.for2d(),this.size=e.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on(`prerender`,this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Rr(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Lr(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return H(`7.1.0`,`BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures`),this.maxTextures}static get defaultVertexSrc(){return Vr}static get defaultFragmentTemplate(){return Br}setShaderGenerator({vertex:t=e.defaultVertexSrc,fragment:n=e.defaultFragmentTemplate}={}){this.shaderGenerator=new Fr(t,n)}contextChange(){let t=this.renderer.gl;k.PREFER_ENV===l.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),e.defaultMaxTextures),this.maxTextures=pn(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:t,_textureArrayPool:n}=e,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;t.length<r;)t.push(new On);for(;n.length<i;)n.push(new Ir);for(let e=0;e<this.maxTextures;e++)this._tempBoundTextures[e]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){let{_bufferedTextures:t,maxTextures:n}=this,r=e._textureArrayPool,i=this.renderer.batch,a=this._tempBoundTextures,o=this.renderer.textureGC.count,s=++q._globalBatch,c=0,l=r[0],u=0;i.copyBoundTextures(a,n);for(let e=0;e<this._bufferSize;++e){let d=t[e];t[e]=null,d._batchEnabled!==s&&(l.count>=n&&(i.boundArray(l,a,s,n),this.buildDrawCalls(l,u,e),u=e,l=r[++c],++s),d._batchEnabled=s,d.touched=o,l.elements[l.count++]=d)}l.count>0&&(i.boundArray(l,a,s,n),this.buildDrawCalls(l,u,this._bufferSize),++c,++s);for(let e=0;e<a.length;e++)a[e]=null;q._globalBatch=s}buildDrawCalls(t,n,r){let{_bufferedElements:i,_attributeBuffer:a,_indexBuffer:o,vertexSize:s}=this,c=e._drawCallPool,l=this._dcIndex,u=this._aIndex,d=this._iIndex,f=c[l];f.start=this._iIndex,f.texArray=t;for(let e=n;e<r;++e){let r=i[e],p=r._texture.baseTexture,m=Vt[p.alphaMode?1:0][r.blendMode];i[e]=null,n<e&&f.blend!==m&&(f.size=d-f.start,n=e,f=c[++l],f.texArray=t,f.start=d),this.packInterleavedGeometry(r,a,o,u,d),u+=r.vertexData.length/2*s,d+=r.indices.length,f.blend=m}n<r&&(f.size=d-f.start,++l),this._dcIndex=l,this._aIndex=u,this._iIndex=d}bindAndClearTexArray(e){let t=this.renderer.texture;for(let n=0;n<e.count;n++)t.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}updateGeometry(){let{_packedGeometries:t,_attributeBuffer:n,_indexBuffer:r}=this;e.canUploadSameBuffer?(t[this._flushId]._buffer.update(n.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(n.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let t=this._dcIndex,{gl:n,state:r}=this.renderer,i=e._drawCallPool,a=null;for(let e=0;e<t;e++){let{texArray:t,type:o,size:s,start:c,blend:l}=i[e];a!==t&&(a=t,this.bindAndClearTexArray(t)),this.state.blendMode=l,r.set(this.state),n.drawElements(o,s,n.UNSIGNED_SHORT,c*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),e.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off(`prerender`,this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&=(this._shader.destroy(),null),super.destroy()}getAttributeBuffer(e){let t=Ut(Math.ceil(e/8)),n=Gt(t),r=t*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new un(r*this.vertexSize*4)),i}getIndexBuffer(e){let t=Ut(Math.ceil(e/12)),n=Gt(t),r=t*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._iBuffers[n];return i||(this._iBuffers[n]=i=new Uint16Array(r)),i}packInterleavedGeometry(e,t,n,r,i){let{uint32View:a,float32View:o}=t,s=r/this.vertexSize,c=e.uvs,l=e.indices,u=e.vertexData,d=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),p=W.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0);for(let e=0;e<u.length;e+=2)o[r++]=u[e],o[r++]=u[e+1],o[r++]=c[e],o[r++]=c[e+1],a[r++]=p,o[r++]=d;for(let e=0;e<l.length;e++)n[i++]=s+l[e]}};Hr.defaultBatchSize=4096,Hr.extension={name:`batch`,type:G.RendererPlugin},Hr._drawCallPool=[],Hr._textureArrayPool=[];var Ur=Hr;K.add(Ur);var Wr=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Gr=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Kr=class e extends Pr{constructor(t,n,r){let i=jr.from(t||e.defaultVertexSrc,n||e.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=e.defaultResolution,this.multisample=e.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new bn}apply(e,t,n,r,i){e.applyFilter(this,t,n,r)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return Gr}static get defaultFragmentSrc(){return Wr}};Kr.defaultResolution=1,Kr.defaultMultisample=D.NONE;var qr=Kr,Jr=class{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new W(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;let{backgroundColor:t,background:n,backgroundAlpha:r}=e,i=n??t;i!==void 0&&(this.color=i),this.alpha=r}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}};Jr.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Jr.extension={type:[G.RendererSystem,G.CanvasRendererSystem],name:`background`},K.add(Jr);var Yr=class{constructor(e){this.renderer=e,this.emptyRenderer=new zr(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){let{boundTextures:n}=this.renderer.texture;for(let r=t-1;r>=0;--r)e[r]=n[r]||null,e[r]&&(e[r]._batchLocation=r)}boundArray(e,t,n,r){let{elements:i,ids:a,count:o}=e,s=0;for(let e=0;e<o;e++){let o=i[e],c=o._batchLocation;if(c>=0&&c<r&&t[c]===o){a[e]=c;continue}for(;s<r;){let r=t[s];if(r&&r._batchEnabled===n&&r._batchLocation===s){s++;continue}a[e]=s,o._batchLocation=s,t[s]=o;break}}}destroy(){this.renderer=null}};Yr.extension={type:G.RendererSystem,name:`batch`},K.add(Yr);var Xr=0,Zr=class{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Xr++}init(e){if(e.context)this.initFromContext(e.context);else{let t=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Xr++,this.renderer.runners.contextChange.emit(e);let t=this.renderer.view;t.addEventListener!==void 0&&(t.addEventListener(`webglcontextlost`,this.handleContextLost,!1),t.addEventListener(`webglcontextrestored`,this.handleContextRestored,!1))}initFromOptions(e){let t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(e,t){let n;if(k.PREFER_ENV>=l.WEBGL2&&(n=e.getContext(`webgl2`,t)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext(`webgl`,t)||e.getContext(`experimental-webgl`,t),!n)throw Error(`This browser does not support WebGL. Try using the canvas renderer`);return this.gl=n,this.getExtensions(),this.gl}getExtensions(){let{gl:e}=this,t={loseContext:e.getExtension(`WEBGL_lose_context`),anisotropicFiltering:e.getExtension(`EXT_texture_filter_anisotropic`),floatTextureLinear:e.getExtension(`OES_texture_float_linear`),s3tc:e.getExtension(`WEBGL_compressed_texture_s3tc`),s3tc_sRGB:e.getExtension(`WEBGL_compressed_texture_s3tc_srgb`),etc:e.getExtension(`WEBGL_compressed_texture_etc`),etc1:e.getExtension(`WEBGL_compressed_texture_etc1`),pvrtc:e.getExtension(`WEBGL_compressed_texture_pvrtc`)||e.getExtension(`WEBKIT_WEBGL_compressed_texture_pvrtc`),atc:e.getExtension(`WEBGL_compressed_texture_atc`),astc:e.getExtension(`WEBGL_compressed_texture_astc`),bptc:e.getExtension(`EXT_texture_compression_bptc`)};this.webGLVersion===1?Object.assign(this.extensions,t,{drawBuffers:e.getExtension(`WEBGL_draw_buffers`),depthTexture:e.getExtension(`WEBGL_depth_texture`),vertexArrayObject:e.getExtension(`OES_vertex_array_object`)||e.getExtension(`MOZ_OES_vertex_array_object`)||e.getExtension(`WEBKIT_OES_vertex_array_object`),uint32ElementIndex:e.getExtension(`OES_element_index_uint`),floatTexture:e.getExtension(`OES_texture_float`),floatTextureLinear:e.getExtension(`OES_texture_float_linear`),textureHalfFloat:e.getExtension(`OES_texture_half_float`),textureHalfFloatLinear:e.getExtension(`OES_texture_half_float_linear`)}):this.webGLVersion===2&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension(`EXT_color_buffer_float`)})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener(`webglcontextlost`,this.handleContextLost),e.removeEventListener(`webglcontextrestored`,this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){let t=e.getContextAttributes(),n=`WebGL2RenderingContext`in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),t&&!t.stencil&&console.warn(`Provided WebGL context does not have a stencil buffer, masks may not render correctly`);let r=n||!!e.getExtension(`OES_element_index_uint`);this.supports.uint32Indices=r,r||console.warn(`Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly`)}};Zr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:`default`},Zr.extension={type:G.RendererSystem,name:`context`},K.add(Zr);var Qr=class{constructor(e,t){if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw Error(`Framebuffer width or height is zero`);this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Cn(`disposeFramebuffer`),this.multisample=D.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new q(null,{scaleMode:v.NEAREST,resolution:1,mipmap:b.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new q(null,{scaleMode:v.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:b.OFF,format:m.DEPTH_COMPONENT,type:g.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw Error(`Framebuffer width and height must not be zero`);if(!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){let r=this.colorTextures[n],i=r.resolution;r.setSize(e/i,t/i)}if(this.depthTexture){let n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,t/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}},$r=class extends q{constructor(e={}){if(typeof e==`number`){let t=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];e={width:t,height:n,scaleMode:r,resolution:i}}e.width=e.width??100,e.height=e.height??100,e.multisample??=D.NONE,super(null,e),this.mipmap=b.OFF,this.valid=!0,this._clear=new W([0,0,0,0]),this.framebuffer=new Qr(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}},ei=class extends wn{constructor(e){let t=e;super(t.naturalWidth||t.videoWidth||t.displayWidth||t.width,t.naturalHeight||t.videoHeight||t.displayHeight||t.height),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,n){n===void 0&&!t.startsWith(`data:`)?e.crossOrigin=on(t):n!==!1&&(e.crossOrigin=typeof n==`string`?n:`anonymous`)}upload(e,t,n,r){let i=e.gl,a=t.realWidth,o=t.realHeight;if(r||=this.source,typeof HTMLImageElement<`u`&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<`u`&&r instanceof HTMLVideoElement&&r.readyState<=1)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===x.UNPACK),!this.noSubImage&&t.target===i.TEXTURE_2D&&n.width===a&&n.height===o?i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,n.type,r):(n.width=a,n.height=o,i.texImage2D(t.target,0,n.internalFormat,t.format,n.type,r)),!0}update(){if(this.destroyed)return;let e=this.source;this.resize(e.naturalWidth||e.videoWidth||e.width,e.naturalHeight||e.videoHeight||e.height),super.update()}dispose(){this.source=null}},ti=class extends ei{constructor(e,t){if(t||={},typeof e==`string`){let n=new Image;ei.crossOrigin(n,e,t.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??k.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof t.alphaMode==`number`?t.alphaMode:null,this.bitmap=null,this._load=null,t.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((e,t)=>{let n=this.source;this.url=n.src;let r=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.update(),this._load=null,e(this.createBitmap?this.process():this))};n.complete&&n.src?r():(n.onload=r,n.onerror=e=>{t(e),this.onError.emit(e)})}),this._load)}process(){let e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let t=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin===`anonymous`;return this._process=fetch(e.src,{mode:n?`cors`:`no-cors`}).then(e=>e.blob()).then(n=>t(n,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===x.UNPACK?`premultiply`:`none`})).then(e=>this.destroyed?Promise.reject():(this.bitmap=e,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,t,n){if(typeof this.alphaMode==`number`&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,n,this.bitmap),!this.preserveBitmap){let e=!0,r=t._glTextures;for(let i in r){let a=r[i];if(a!==n&&a.dirtyId!==t.dirtyId){e=!1;break}}e&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&=(this.bitmap.close(),null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<`u`&&(typeof e==`string`||e instanceof HTMLImageElement)}},ni=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,n){let r=t.width,i=t.height;if(n){let t=e.width/2/r,a=e.height/2/i,o=e.x/r+t,s=e.y/i+a;n=Q.add(n,Q.NW),this.x0=o+t*Q.uX(n),this.y0=s+a*Q.uY(n),n=Q.add(n,2),this.x1=o+t*Q.uX(n),this.y1=s+a*Q.uY(n),n=Q.add(n,2),this.x2=o+t*Q.uX(n),this.y2=s+a*Q.uY(n),n=Q.add(n,2),this.x3=o+t*Q.uX(n),this.y3=s+a*Q.uY(n)}else this.x0=e.x/r,this.y0=e.y/i,this.x1=(e.x+e.width)/r,this.y1=e.y/i,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/i,this.x3=e.x/r,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}};ni.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};var ri=new ni;function ii(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}var ai=class e extends it.default{constructor(t,n,r,i,a,o,s){if(super(),this.noFrame=!1,n||=(this.noFrame=!0,new X(0,0,1,1)),t instanceof e&&(t=t.baseTexture),this.baseTexture=t,this._frame=n,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=ri,this.uvMatrix=null,this.orig=r||n,this._rotate=Number(a||0),a===!0)this._rotate=2;else if(this._rotate%2!=0)throw Error(`attempt to use diamond-shaped UVs. If you are sure, set rotation manually`);this.defaultAnchor=o?new Y(o.x,o.y):new Y(0,0),this.defaultBorders=s,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=n:t.once(`loaded`,this.onBaseTextureUpdated,this),this.noFrame&&t.on(`update`,this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit(`update`,this)}destroy(t){if(this.baseTexture){if(t){let{resource:t}=this.baseTexture;t?.url&&$t[t.url]&&e.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off(`loaded`,this.onBaseTextureUpdated,this),this.baseTexture.off(`update`,this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit(`destroyed`,this),this.removeAllListeners()}clone(){let t=this._frame.clone(),n=this._frame===this.orig?t:this.orig.clone(),r=new e(this.baseTexture,!this.noFrame&&t,n,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=t),r}updateUvs(){this._uvs===ri&&(this._uvs=new ni),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,n={},r=k.STRICT_TEXTURE_CACHE){let i=typeof t==`string`,a=null;i?a=t:t instanceof q?(t.cacheId||(t.cacheId=`${n?.pixiIdPrefix||`pixiid`}-${Yt()}`,q.addToCache(t,t.cacheId)),a=t.cacheId):(t._pixiId||=`${n?.pixiIdPrefix||`pixiid`}_${Yt()}`,a=t._pixiId);let o=$t[a];if(i&&r&&!o)throw Error(`The cacheId "${a}" does not exist in TextureCache.`);return!o&&!(t instanceof q)?(n.resolution||=sn(t),o=new e(new q(t,n)),o.baseTexture.cacheId=a,q.addToCache(o.baseTexture,a),e.addToCache(o,a)):!o&&t instanceof q&&(o=new e(t),e.addToCache(o,a)),o}static fromURL(t,n){let r=Object.assign({autoLoad:!1},n?.resourceOptions),i=e.from(t,Object.assign({resourceOptions:r},n),!1);return i.baseTexture.valid?Promise.resolve(i):i.baseTexture.resource.load().then(()=>Promise.resolve(i))}static fromBuffer(t,n,r,i){return new e(q.fromBuffer(t,n,r,i))}static fromLoader(t,n,r,i){let a=new q(t,Object.assign({scaleMode:q.defaultOptions.scaleMode,resolution:sn(n)},i)),{resource:o}=a;o instanceof ti&&(o.url=n);let s=new e(a);return r||=n,q.addToCache(s.baseTexture,r),e.addToCache(s,r),r!==n&&(q.addToCache(s.baseTexture,n),e.addToCache(s,n)),s.baseTexture.valid?Promise.resolve(s):new Promise(e=>{s.baseTexture.once(`loaded`,()=>e(s))})}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),$t[t]&&$t[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),$t[t]=e)}static removeFromCache(e){if(typeof e==`string`){let t=$t[e];if(t){let n=t.textureCacheIds.indexOf(e);return n>-1&&t.textureCacheIds.splice(n,1),delete $t[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)$t[e.textureCacheIds[t]]===e&&delete $t[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;let{x:t,y:n,width:r,height:i}=e,a=t+r>this.baseTexture.width,o=n+i>this.baseTexture.height;if(a||o){let e=a&&o?`and`:`or`,s=`X: ${t} + ${r} = ${t+r} > ${this.baseTexture.width}`,c=`Y: ${n} + ${i} = ${n+i} > ${this.baseTexture.height}`;throw Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${s} ${e} ${c}`)}this.valid=r&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return e._EMPTY||(e._EMPTY=new e(new q),ii(e._EMPTY),ii(e._EMPTY.baseTexture)),e._EMPTY}static get WHITE(){if(!e._WHITE){let t=k.ADAPTER.createCanvas(16,16),n=t.getContext(`2d`);t.width=16,t.height=16,n.fillStyle=`white`,n.fillRect(0,0,16,16),e._WHITE=new e(q.from(t)),ii(e._WHITE),ii(e._WHITE.baseTexture)}return e._WHITE}},oi=class e extends ai{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,n=!0){let r=this.baseTexture.resolution,i=Math.round(e*r)/r,a=Math.round(t*r)/r;this.valid=i>0&&a>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=a,n&&this.baseTexture.resize(i,a),this.updateUvs()}setResolution(e){let{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(t){return new e(new $r(t))}},si=class{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,n=D.NONE){let r=new $r(Object.assign({width:e,height:t,resolution:1,multisample:n},this.textureOptions));return new oi(r)}getOptimalTexture(e,t,n=1,r=D.NONE){let i;e=Math.max(Math.ceil(e*n-1e-6),1),t=Math.max(Math.ceil(t*n-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight?(e=Ut(e),t=Ut(t),i=((e&65535)<<16|t&65535)>>>0,r>1&&(i+=r*4294967296)):i=r>1?-r:-1,this.texturePool[i]||(this.texturePool[i]=[]);let a=this.texturePool[i].pop();return a||=this.createTexture(e,t,r),a.filterPoolKey=i,a.setResolution(n),a}getFilterTexture(e,t,n){let r=this.getOptimalTexture(e.width,e.height,t||e.resolution,n||D.NONE);return r.filterFrame=e.filterFrame,r}returnTexture(e){let t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(let e in this.texturePool){let t=this.texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){for(let t in this.enableFullScreen=e.width>0&&e.height>0,this.texturePool){if(!(Number(t)<0))continue;let e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}};si.SCREEN_KEY=-1;var ci=class extends Ln{constructor(){super(),this.addAttribute(`aVertexPosition`,new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}},li=class extends Ln{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new An(this.vertices),this.uvBuffer=new An(this.uvs),this.addAttribute(`aVertexPosition`,this.vertexBuffer).addAttribute(`aTextureCoord`,this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+t.width/e.width,this.uvs[3]=r,this.uvs[4]=n+t.width/e.width,this.uvs[5]=r+t.height/e.height,this.uvs[6]=n,this.uvs[7]=r+t.height/e.height,n=t.x,r=t.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+t.width,this.vertices[3]=r,this.vertices[4]=n+t.width,this.vertices[5]=r+t.height,this.vertices[6]=n,this.vertices[7]=r+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}},ui=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=D.NONE,this.sourceFrame=new X,this.destinationFrame=new X,this.bindingSourceFrame=new X,this.bindingDestinationFrame=new X,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}},di=[new Y,new Y,new Y,new Y],fi=new Z,pi=class{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new si,this.statePool=[],this.quad=new ci,this.quadUv=new li,this.tempRect=new X,this.activeState={},this.globalUniforms=new Nr({outputFrame:new X,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){let n=this.renderer,r=this.defaultFilterStack,i=this.statePool.pop()||new ui,a=n.renderTexture,o,s;if(a.current){let e=a.current;o=e.resolution,s=e.multisample}else o=n.resolution,s=n.multisample;let c=t[0].resolution||o,l=t[0].multisample??s,u=t[0].padding,d=t[0].autoFit,f=t[0].legacy??!0;for(let e=1;e<t.length;e++){let n=t[e];c=Math.min(c,n.resolution||o),l=Math.min(l,n.multisample??s),u=this.useMaxPadding?Math.max(u,n.padding):u+n.padding,d&&=n.autoFit,f||=n.legacy??!0}r.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),r.push(i),i.resolution=c,i.multisample=l,i.legacy=f,i.target=e,i.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),i.sourceFrame.pad(u);let p=this.tempRect.copyFrom(a.sourceFrame);n.projection.transform&&this.transformAABB(fi.copyFrom(n.projection.transform).invert(),p),d?(i.sourceFrame.fit(p),(i.sourceFrame.width<=0||i.sourceFrame.height<=0)&&(i.sourceFrame.width=0,i.sourceFrame.height=0)):i.sourceFrame.intersects(p)||(i.sourceFrame.width=0,i.sourceFrame.height=0),this.roundFrame(i.sourceFrame,a.current?a.current.resolution:n.resolution,a.sourceFrame,a.destinationFrame,n.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,c,l),i.filters=t,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;let m=this.tempRect;m.x=0,m.y=0,m.width=i.sourceFrame.width,m.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(a.sourceFrame),i.bindingDestinationFrame.copyFrom(a.destinationFrame),i.transform=n.projection.transform,n.projection.transform=null,a.bind(i.renderTexture,i.sourceFrame,m),n.framebuffer.clear(0,0,0,0)}pop(){let e=this.defaultFilterStack,t=e.pop(),n=t.filters;this.activeState=t;let r=this.globalUniforms.uniforms;r.outputFrame=t.sourceFrame,r.resolution=t.resolution;let i=r.inputSize,a=r.inputPixel,o=r.inputClamp;if(i[0]=t.destinationFrame.width,i[1]=t.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],a[0]=Math.round(i[0]*t.resolution),a[1]=Math.round(i[1]*t.resolution),a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=t.sourceFrame.width*i[2]-.5*a[2],o[3]=t.sourceFrame.height*i[3]-.5*a[3],t.legacy){let e=r.filterArea;e[0]=t.destinationFrame.width,e[1]=t.destinationFrame.height,e[2]=t.sourceFrame.x,e[3]=t.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();let s=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,t.renderTexture,s.renderTexture,S.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let e=t.renderTexture,r=this.getOptimalFilterTexture(e.width,e.height,t.resolution);r.filterFrame=e.filterFrame;let i=0;for(i=0;i<n.length-1;++i){i===1&&t.multisample>1&&(r=this.getOptimalFilterTexture(e.width,e.height,t.resolution),r.filterFrame=e.filterFrame),n[i].apply(this,e,r,S.CLEAR,t);let a=e;e=r,r=a}n[i].apply(this,e,s.renderTexture,S.BLEND,t),i>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(e),this.returnFilterTexture(r)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=S.CLEAR){let{renderTexture:n,state:r}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e?.filterFrame){let t=this.tempRect;t.x=0,t.y=0,t.width=e.filterFrame.width,t.height=e.filterFrame.height,n.bind(e,e.filterFrame,t)}else e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame):n.bind(e);let i=r.stateId&1||this.forceClear;(t===S.CLEAR||t===S.BLIT&&i)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,n,r){let i=this.renderer;i.state.set(e.state),this.bindAndClear(n,r),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(p.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(p.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){let{sourceFrame:n,destinationFrame:r}=this.activeState,{orig:i}=t._texture,a=e.set(r.width,0,0,r.height,n.x,n.y),o=t.worldTransform.copyTo(Z.TEMP_MATRIX);return o.invert(),a.prepend(o),a.scale(1/i.width,1/i.height),a.translate(t.anchor.x,t.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,n=1,r=D.NONE){return this.texturePool.getOptimalTexture(e,t,n,r)}getFilterTexture(e,t,n){if(typeof e==`number`){let n=e;e=t,t=n}e||=this.activeState.renderTexture;let r=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,n||D.NONE);return r.filterFrame=e.filterFrame,r}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){let n=di[0],r=di[1],i=di[2],a=di[3];n.set(t.left,t.top),r.set(t.left,t.bottom),i.set(t.right,t.top),a.set(t.right,t.bottom),e.apply(n,n),e.apply(r,r),e.apply(i,i),e.apply(a,a);let o=Math.min(n.x,r.x,i.x,a.x),s=Math.min(n.y,r.y,i.y,a.y),c=Math.max(n.x,r.x,i.x,a.x),l=Math.max(n.y,r.y,i.y,a.y);t.x=o,t.y=s,t.width=c-o,t.height=l-s}roundFrame(e,t,n,r,i){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(i){let{a:e,b:t,c:n,d:r}=i;if((Math.abs(t)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(r)>1e-4))return}i=i?fi.copyFrom(i):fi.identity(),i.translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.transformAABB(i,e),e.ceil(t),this.transformAABB(i.invert(),e)}}};pi.extension={type:G.RendererSystem,name:`filter`},K.add(pi);var mi=class{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=D.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}},hi=new X,gi=class{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Qr(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new X,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let t=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;k.PREFER_ENV===l.WEBGL_LEGACY&&(t=null,n=null),t?e.drawBuffers=e=>t.drawBuffersWEBGL(e):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,t,n=0){let{gl:r}=this;if(e){let i=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,i.mipLevel=n),i.dirtyId!==e.dirtyId&&(i.dirtyId=e.dirtyId,i.dirtyFormat===e.dirtyFormat?i.dirtySize!==e.dirtySize&&(i.dirtySize=e.dirtySize,this.resizeFramebuffer(e)):(i.dirtyFormat=e.dirtyFormat,i.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)));for(let t=0;t<e.colorTextures.length;t++){let n=e.colorTextures[t];this.renderer.texture.unbind(n.parentTextureArray||n)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){let e=t.width>>n,r=t.height>>n,i=e/t.width;this.setViewport(t.x*i,t.y*i,e,r)}else{let t=e.width>>n,r=e.height>>n;this.setViewport(0,0,t,r)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,n,r){let i=this.viewport;e=Math.round(e),t=Math.round(t),n=Math.round(n),r=Math.round(r),(i.width!==n||i.height!==r||i.x!==e||i.y!==t)&&(i.x=e,i.y=t,i.width=n,i.height=r,this.gl.viewport(e,t,n,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,n,r,i=d.COLOR|d.DEPTH){let{gl:a}=this;a.clearColor(e,t,n,r),a.clear(i)}initFramebuffer(e){let{gl:t}=this,n=new mi(t.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){let{gl:t}=this,n=e.glFramebuffers[this.CONTEXT_UID];if(n.stencil){t.bindRenderbuffer(t.RENDERBUFFER,n.stencil);let r;r=this.renderer.context.webGLVersion===1?t.DEPTH_STENCIL:e.depth&&e.stencil?t.DEPTH24_STENCIL8:e.depth?t.DEPTH_COMPONENT24:t.STENCIL_INDEX8,n.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,n.multisample,r,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,r,e.width,e.height)}let r=e.colorTextures,i=r.length;t.drawBuffers||(i=Math.min(i,1));for(let a=0;a<i;a++){let i=r[a],o=i.parentTextureArray||i;this.renderer.texture.bind(o,0),a===0&&n.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,n.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,n.multisample,o._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){let{gl:n}=this,r=e.glFramebuffers[this.CONTEXT_UID],i=e.colorTextures,a=i.length;n.drawBuffers||(a=Math.min(a,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?r.msaaBuffer=r.msaaBuffer||n.createRenderbuffer():r.msaaBuffer&&(n.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&=(r.blitFramebuffer.dispose(),null));let o=[];for(let s=0;s<a;s++){let a=i[s],c=a.parentTextureArray||a;this.renderer.texture.bind(c,0),s===0&&r.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,r.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+s,a.target,c._glTextures[this.CONTEXT_UID].texture,t),o.push(n.COLOR_ATTACHMENT0+s))}if(o.length>1&&n.drawBuffers(o),e.depthTexture&&this.writeDepthTexture){let r=e.depthTexture;this.renderer.texture.bind(r,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,r._glTextures[this.CONTEXT_UID].texture,t)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){r.stencil=r.stencil||n.createRenderbuffer();let t,i;this.renderer.context.webGLVersion===1?(t=n.DEPTH_STENCIL_ATTACHMENT,i=n.DEPTH_STENCIL):e.depth&&e.stencil?(t=n.DEPTH_STENCIL_ATTACHMENT,i=n.DEPTH24_STENCIL8):e.depth?(t=n.DEPTH_ATTACHMENT,i=n.DEPTH_COMPONENT24):(t=n.STENCIL_ATTACHMENT,i=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,i,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,i,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,t,n.RENDERBUFFER,r.stencil)}else r.stencil&&=(n.deleteRenderbuffer(r.stencil),null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){let{msaaSamples:t}=this,n=D.NONE;if(e<=1||t===null)return n;for(let r=0;r<t.length;r++)if(t[r]<=e){n=t[r];break}return n===1&&(n=D.NONE),n}blit(e,t,n){let{current:r,renderer:i,gl:a,CONTEXT_UID:o}=this;if(i.context.webGLVersion!==2||!r)return;let s=r.glFramebuffers[o];if(!s)return;if(!e){if(!s.msaaBuffer)return;let t=r.colorTextures[0];if(!t)return;s.blitFramebuffer||(s.blitFramebuffer=new Qr(r.width,r.height),s.blitFramebuffer.addColorTexture(0,t)),e=s.blitFramebuffer,e.colorTextures[0]!==t&&(e.colorTextures[0]=t,e.dirtyId++,e.dirtyFormat++),(e.width!==r.width||e.height!==r.height)&&(e.width=r.width,e.height=r.height,e.dirtyId++,e.dirtySize++)}t||(t=hi,t.width=r.width,t.height=r.height),n||=t;let c=t.width===n.width&&t.height===n.height;this.bind(e),a.bindFramebuffer(a.READ_FRAMEBUFFER,s.framebuffer),a.blitFramebuffer(t.left,t.top,t.right,t.bottom,n.left,n.top,n.right,n.bottom,a.COLOR_BUFFER_BIT,c?a.NEAREST:a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,t){let n=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];let i=this.managedFramebuffers.indexOf(e);i>=0&&this.managedFramebuffers.splice(i,1),e.disposeRunner.remove(this),t||(r.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&r.deleteRenderbuffer(n.msaaBuffer),n.stencil&&r.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,t)}disposeAll(e){let t=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<t.length;n++)this.disposeFramebuffer(t[n],e)}forceStencil(){let e=this.current;if(!e)return;let t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil&&e.stencil)return;e.stencil=!0;let n=e.width,r=e.height,i=this.gl,a=t.stencil=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,a);let o,s;this.renderer.context.webGLVersion===1?(o=i.DEPTH_STENCIL_ATTACHMENT,s=i.DEPTH_STENCIL):e.depth?(o=i.DEPTH_STENCIL_ATTACHMENT,s=i.DEPTH24_STENCIL8):(o=i.STENCIL_ATTACHMENT,s=i.STENCIL_INDEX8),t.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,t.multisample,s,n,r):i.renderbufferStorage(i.RENDERBUFFER,s,n,r),i.framebufferRenderbuffer(i.FRAMEBUFFER,o,i.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new X}destroy(){this.renderer=null}};gi.extension={type:G.RendererSystem,name:`framebuffer`},K.add(gi);var _i={5126:4,5123:2,5121:1},vi=class{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,t.webGLVersion!==2){let t=this.renderer.context.extensions.vertexArrayObject;k.PREFER_ENV===l.WEBGL_LEGACY&&(t=null),t?(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=e=>t.bindVertexArrayOES(e),e.deleteVertexArray=e=>t.deleteVertexArrayOES(e)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(t.webGLVersion!==2){let t=e.getExtension(`ANGLE_instanced_arrays`);t?(e.vertexAttribDivisor=(e,n)=>t.vertexAttribDivisorANGLE(e,n),e.drawElementsInstanced=(e,n,r,i,a)=>t.drawElementsInstancedANGLE(e,n,r,i,a),e.drawArraysInstanced=(e,n,r,i)=>t.drawArraysInstancedANGLE(e,n,r,i)):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex}bind(e,t){t||=this.renderer.shader.shader;let{gl:n}=this,r=e.glVertexArrayObjects[this.CONTEXT_UID],i=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},i=!0);let a=r[t.program.id]||this.initGeometryVao(e,t,i);this._activeGeometry=e,this._activeVao!==a&&(this._activeVao=a,this.hasVao?n.bindVertexArray(a):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let e=this._activeGeometry,t=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){let r=e.buffers[n];t.update(r)}}checkCompatibility(e,t){let n=e.attributes,r=t.attributeData;for(let e in r)if(!n[e])throw Error(`shader and geometry incompatible, geometry missing the "${e}" attribute`)}getSignature(e,t){let n=e.attributes,r=t.attributeData,i=[`g`,e.id];for(let e in n)r[e]&&i.push(e,r[e].location);return i.join(`-`)}initGeometryVao(e,t,n=!0){let r=this.gl,i=this.CONTEXT_UID,a=this.renderer.buffer,o=t.program;o.glPrograms[i]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,o);let s=this.getSignature(e,o),c=e.glVertexArrayObjects[this.CONTEXT_UID],l=c[s];if(l)return c[o.id]=l,l;let u=e.buffers,d=e.attributes,f={},p={};for(let e in u)f[e]=0,p[e]=0;for(let e in d)!d[e].size&&o.attributeData[e]?d[e].size=o.attributeData[e].size:d[e].size||console.warn(`PIXI Geometry attribute '${e}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[e].buffer]+=d[e].size*_i[d[e].type];for(let e in d){let t=d[e],n=t.size;t.stride===void 0&&(f[t.buffer]===n*_i[t.type]?t.stride=0:t.stride=f[t.buffer]),t.start===void 0&&(t.start=p[t.buffer],p[t.buffer]+=n*_i[t.type])}l=r.createVertexArray(),r.bindVertexArray(l);for(let e=0;e<u.length;e++){let t=u[e];a.bind(t),n&&t._glBuffers[i].refCount++}return this.activateVao(e,o),c[o.id]=l,c[s]=l,r.bindVertexArray(null),a.unbind(O.ARRAY_BUFFER),l}disposeGeometry(e,t){if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];let n=e.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,i=e.buffers,a=this.renderer?.buffer;if(e.disposeRunner.remove(this),n){if(a)for(let e=0;e<i.length;e++){let n=i[e]._glBuffers[this.CONTEXT_UID];n&&(n.refCount--,n.refCount===0&&!t&&a.dispose(i[e],t))}if(!t){for(let e in n)if(e[0]===`g`){let t=n[e];this._activeVao===t&&this.unbind(),r.deleteVertexArray(t)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){let t=Object.keys(this.managedGeometries);for(let n=0;n<t.length;n++)this.disposeGeometry(this.managedGeometries[t[n]],e)}activateVao(e,t){let n=this.gl,r=this.CONTEXT_UID,i=this.renderer.buffer,a=e.buffers,o=e.attributes;e.indexBuffer&&i.bind(e.indexBuffer);let s=null;for(let e in o){let c=o[e],l=a[c.buffer],u=l._glBuffers[r];if(t.attributeData[e]){s!==u&&(i.bind(l),s=u);let r=t.attributeData[e].location;if(n.enableVertexAttribArray(r),n.vertexAttribPointer(r,c.size,c.type||n.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)n.vertexAttribDivisor(r,c.divisor);else throw Error(`geometry error, GPU Instancing is not supported on this device`)}}}draw(e,t,n,r){let{gl:i}=this,a=this._activeGeometry;if(a.indexBuffer){let o=a.indexBuffer.data.BYTES_PER_ELEMENT,s=o===2?i.UNSIGNED_SHORT:i.UNSIGNED_INT;o===2||o===4&&this.canUseUInt32ElementIndex?a.instanced?i.drawElementsInstanced(e,t||a.indexBuffer.data.length,s,(n||0)*o,r||1):i.drawElements(e,t||a.indexBuffer.data.length,s,(n||0)*o):console.warn(`unsupported index buffer type: uint32`)}else a.instanced?i.drawArraysInstanced(e,n,t||a.getSize(),r||1):i.drawArrays(e,n,t||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};vi.extension={type:G.RendererSystem,name:`geometry`},K.add(vi);var yi=new Z,bi=class{constructor(e,t){this._texture=e,this.mapCoord=new Z,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>`u`?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){t===void 0&&(t=e);let n=this.mapCoord;for(let r=0;r<e.length;r+=2){let i=e[r],a=e[r+1];t[r]=i*n.a+a*n.c+n.tx,t[r+1]=i*n.b+a*n.d+n.ty}return t}update(e){let t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;let n=t._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);let r=t.orig,i=t.trim;i&&(yi.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(yi));let a=t.baseTexture,o=this.uClampFrame,s=this.clampMargin/a.resolution,c=this.clampOffset;return o[0]=(t._frame.x+s+c)/a.width,o[1]=(t._frame.y+s+c)/a.height,o[2]=(t._frame.x+t._frame.width-s+c)/a.width,o[3]=(t._frame.y+t._frame.height-s+c)/a.height,this.uClampOffset[0]=c/a.realWidth,this.uClampOffset[1]=c/a.realHeight,this.isSimple=t._frame.width===a.width&&t._frame.height===a.height&&t.rotate===0,!0}},xi=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Si=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,Ci=class extends qr{constructor(e,t,n){let r=null;typeof e!=`string`&&t===void 0&&n===void 0&&(r=e,e=void 0,t=void 0,n=void 0),super(e||Si,t||xi,n),this.maskSprite=r,this.maskMatrix=new Z}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,n,r){let i=this._maskSprite,a=i._texture;a.valid&&(a.uvMatrix||=new bi(a,0),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,i).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,e.applyFilter(this,t,n,r))}},wi=class{constructor(e=null){this.type=T.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=qr.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=T.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}},Ti=class{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let n=t;if(!n.isMaskData){let e=this.maskDataPool.pop()||new wi;e.pooled=!0,e.maskObject=t,n=e}let r=this.maskStack.length===0?null:this.maskStack[this.maskStack.length-1];if(n.copyCountersOrReset(r),n._colorMask=r?r._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==T.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case T.SCISSOR:this.renderer.scissor.push(n);break;case T.STENCIL:this.renderer.stencil.push(n);break;case T.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case T.COLOR:this.pushColorMask(n);break;default:break}n.type===T.SPRITE&&this.maskStack.push(n)}pop(e){let t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case T.SCISSOR:this.renderer.scissor.pop(t);break;case T.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case T.SPRITE:this.popSpriteMask(t);break;case T.COLOR:this.popColorMask(t);break;default:break}if(t.reset(),t.pooled&&this.maskDataPool.push(t),this.maskStack.length!==0){let e=this.maskStack[this.maskStack.length-1];e.type===T.SPRITE&&e._filters&&(e._filters[0].maskSprite=e.maskObject)}}}detect(e){let t=e.maskObject;t?t.isSprite?e.type=T.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=T.SCISSOR:e.type=T.STENCIL:e.type=T.COLOR}pushSpriteMask(e){let{maskObject:t}=e,n=e._target,r=e._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||=this.alphaMaskPool[this.alphaMaskIndex]=[new Ci]),r[0].resolution=e.resolution,r[0].multisample=e.multisample,r[0].maskSprite=t;let i=n.filterArea;n.filterArea=t.getBounds(!0),this.renderer.filter.push(n,r),n.filterArea=i,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){let t=e._colorMask,n=e._colorMask=t&e.colorMask;n!==t&&this.renderer.gl.colorMask((n&1)!=0,(n&2)!=0,(n&4)!=0,(n&8)!=0)}popColorMask(e){let t=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==t&&this.renderer.gl.colorMask((n&1)!=0,(n&2)!=0,(n&4)!=0,(n&8)!=0)}destroy(){this.renderer=null}};Ti.extension={type:G.RendererSystem,name:`mask`},K.add(Ti);var Ei=class{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){let{gl:t}=this.renderer,n=this.getStackLength();this.maskStack=e;let r=this.getStackLength();r!==n&&(r===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}},Di=new Z,Oi=[],ki=class e extends Ei{constructor(e){super(e),this.glConst=k.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;let t=e._scissorRect,{maskObject:n}=e,{renderer:r}=this,i=r.renderTexture,a=n.getBounds(!0,Oi.pop()??new X);this.roundFrameToPixels(a,i.current?i.current.resolution:r.resolution,i.sourceFrame,i.destinationFrame,r.projection.transform),t&&a.fit(t),e._scissorRectLocal=a}static isMatrixRotated(e){if(!e)return!1;let{a:t,b:n,c:r,d:i}=e;return(Math.abs(n)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4)}testScissor(t){let{maskObject:n}=t;if(!n.isFastRect||!n.isFastRect()||e.isMatrixRotated(n.worldTransform)||e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);let r=t._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(t,n,r,i,a){e.isMatrixRotated(a)||(a=a?Di.copyFrom(a):Di.identity(),a.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(a,t),t.fit(i),t.x=Math.round(t.x*n),t.y=Math.round(t.y*n),t.width=Math.round(t.width*n),t.height=Math.round(t.height*n))}push(e){e._scissorRectLocal||this.calcScissorRect(e);let{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){let{gl:t}=this.renderer;e&&Oi.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){let e=this.maskStack[this.maskStack.length-1]._scissorRect,t;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};ki.extension={type:G.RendererSystem,name:`scissor`},K.add(ki);var Ai=class extends Ei{constructor(e){super(e),this.glConst=k.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){let t=e.maskObject,{gl:n}=this.renderer,r=e._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;let i=e._colorMask;i!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,r,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,i!==0&&(e._colorMask=i,n.colorMask((i&1)!=0,(i&2)!=0,(i&4)!=0,(i&8)!=0)),this._useCurrent()}pop(e){let t=this.renderer.gl;if(this.getStackLength()===0)t.disable(t.STENCIL_TEST);else{let n=this.maskStack.length===0?null:this.maskStack[this.maskStack.length-1],r=n?n._colorMask:15;r!==0&&(n._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,r!==0&&(n._colorMask=r,t.colorMask((r&1)!=0,(r&2)!=0,(r&4)!=0,(r&8)!=0)),this._useCurrent()}}_useCurrent(){let e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}};Ai.extension={type:G.RendererSystem,name:`stencil`},K.add(Ai);var ji=class{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return H(`7.0.0`,`renderer.plugins.extract has moved to renderer.extract`),e.extract}},prepare:{enumerable:!1,get(){return H(`7.0.0`,`renderer.plugins.prepare has moved to renderer.prepare`),e.prepare}},interaction:{enumerable:!1,get(){return H(`7.0.0`,`renderer.plugins.interaction has been deprecated, use renderer.events`),e.events}}})}init(){let e=this.rendererPlugins;for(let t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(let e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}};ji.extension={type:[G.RendererSystem,G.CanvasRendererSystem],name:`_plugin`},K.add(ji);var Mi=class{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Z,this.transform=null}update(e,t,n,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);let i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)}calculateProjection(e,t,n,r){let i=this.projectionMatrix,a=r?-1:1;i.identity(),i.a=1/t.width*2,i.d=a*(1/t.height*2),i.tx=-1-t.x*i.a,i.ty=-a-t.y*i.d}setTransform(e){}destroy(){this.renderer=null}};Mi.extension={type:G.RendererSystem,name:`projection`},K.add(Mi);var Ni=new rr,Pi=new X,Fi=class{constructor(e){this.renderer=e,this._tempMatrix=new Z}generateTexture(e,t){let{region:n,...r}=t||{},i=n?.copyTo(Pi)||e.getLocalBounds(Pi,!0),a=r.resolution||this.renderer.resolution;i.width=Math.max(i.width,1/a),i.height=Math.max(i.height,1/a),r.width=i.width,r.height=i.height,r.resolution=a,r.multisample??=this.renderer.multisample;let o=oi.create(r);this._tempMatrix.tx=-i.x,this._tempMatrix.ty=-i.y;let s=e.transform;return e.transform=Ni,this.renderer.render(e,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=s,o}destroy(){}};Fi.extension={type:[G.RendererSystem,G.CanvasRendererSystem],name:`textureGenerator`},K.add(Fi);var Ii=new X,Li=new X,Ri=class{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new X,this.destinationFrame=new X,this.viewportFrame=new X}contextChange(){let e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,n){let r=this.renderer;this.current=e;let i,a,o;e?(i=e.baseTexture,o=i.resolution,t||=(Ii.width=e.frame.width,Ii.height=e.frame.height,Ii),n||=(Li.x=e.frame.x,Li.y=e.frame.y,Li.width=t.width,Li.height=t.height,Li),a=i.framebuffer):(o=r.resolution,t||=(Ii.width=r._view.screen.width,Ii.height=r._view.screen.height,Ii),n||(n=Ii,n.width=t.width,n.height=t.height));let s=this.viewportFrame;s.x=n.x*o,s.y=n.y*o,s.width=n.width*o,s.height=n.height*o,e||(s.y=r.view.height-(s.y+s.height)),s.ceil(),this.renderer.framebuffer.bind(a,s),this.renderer.projection.update(n,t,o,!a),this.renderer.mask.setMaskStack(e?i.maskStack:this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(n)}clear(e,t){let n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=W.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);let i=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,o=i.width!==a.width||i.height!==a.height;if(o){let{x:e,y:t,width:n,height:r}=this.viewportFrame;e=Math.round(e),t=Math.round(t),n=Math.round(n),r=Math.round(r),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(e,t,n,r)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,t),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};Ri.extension={type:G.RendererSystem,name:`renderTexture`},K.add(Ri);var zi=class{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function Bi(e,t){let n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){let r=t.getActiveAttrib(e,i);if(r.name.startsWith(`gl_`))continue;let a=wr(t,r.type);n[r.name]={type:a,name:r.name,size:xr(a),location:t.getAttribLocation(e,r.name)}}return n}function Vi(e,t){let n={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){let r=t.getActiveUniform(e,i),a=r.name.replace(/\[.*?\]$/,``),o=!!r.name.match(/\[.*?\]$/),s=wr(t,r.type);n[a]={name:a,index:i,type:s,size:r.size,isArray:o,value:cr(s,r.size)}}return n}function Hi(e,t){let n=or(e,e.VERTEX_SHADER,t.vertexSrc),r=or(e,e.FRAGMENT_SHADER,t.fragmentSrc),i=e.createProgram();e.attachShader(i,n),e.attachShader(i,r);let a=t.extra?.transformFeedbackVaryings;if(a&&(typeof e.transformFeedbackVaryings==`function`?e.transformFeedbackVaryings(i,a.names,a.bufferMode===`separate`?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS):console.warn(`TransformFeedback is not supported but TransformFeedbackVaryings are given.`)),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||yr(e,i,n,r),t.attributeData=Bi(i,e),t.uniformData=Vi(i,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){let n=Object.keys(t.attributeData);n.sort((e,t)=>e>t?1:-1);for(let r=0;r<n.length;r++)t.attributeData[n[r]].location=r,e.bindAttribLocation(i,r,n[r]);e.linkProgram(i)}e.deleteShader(n),e.deleteShader(r);let o={};for(let n in t.uniformData){let r=t.uniformData[n];o[n]={location:e.getUniformLocation(i,n),value:cr(r.type,r.size)}}return new zi(i,o)}function Ui(e,t,n,r,i){n.buffer.update(i)}var Wi={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Gi={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function Ki(e){let t=e.map(e=>({data:e,offset:0,dataLen:0,dirty:0})),n=0,r=0,i=0;for(let e=0;e<t.length;e++){let a=t[e];if(n=Gi[a.data.type],a.data.size>1&&(n=Math.max(n,16)*a.data.size),a.dataLen=n,r%n!==0&&r<16){let e=r%n%16;r+=e,i+=e}r+n>16?(i=Math.ceil(i/16)*16,a.offset=i,i+=n,r=n):(a.offset=i,r+=n,i+=n)}return i=Math.ceil(i/16)*16,{uboElements:t,size:i}}function qi(e,t){let n=[];for(let r in e)t[r]&&n.push(t[r]);return n.sort((e,t)=>e.index-t.index),n}function Ji(e,t){if(!e.autoManage)return{size:0,syncFunc:Ui};let n=qi(e.uniforms,t),{uboElements:r,size:i}=Ki(n),a=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let t=0;t<r.length;t++){let n=r[t],i=e.uniforms[n.data.name],o=n.data.name,s=!1;for(let e=0;e<lr.length;e++){let t=lr[e];if(t.codeUbo&&t.test(n.data,i)){a.push(`offset = ${n.offset/4};`,lr[e].codeUbo(n.data.name,i)),s=!0;break}}if(!s)if(n.data.size>1){let e=xr(n.data.type),t=Math.max(Gi[n.data.type]/16,1),r=e/t,i=(4-r%4)%4;a.push(`
                cv = ud.${o}.value;
                v = uv.${o};
                offset = ${n.offset/4};

                t = 0;

                for(var i=0; i < ${n.data.size*t}; i++)
                {
                    for(var j = 0; j < ${r}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${i};
                }

                `)}else{let e=Wi[n.data.type];a.push(`
                cv = ud.${o}.value;
                v = uv.${o};
                offset = ${n.offset/4};
                ${e};
                `)}}return a.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:Function(`ud`,`uv`,`renderer`,`syncData`,`buffer`,a.join(`
`))}}var Yi=0,Xi={textureCount:0,uboCount:0},Zi=class{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Yi++}systemCheck(){if(!Dr())throw Error(`Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.`)}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;let n=e.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),t||(Xi.textureCount=0,Xi.uboCount=0,this.syncUniformGroup(e.uniformGroup,Xi)),r}setUniforms(e){let t=this.shader.program,n=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,t){let n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,t))}syncUniforms(e,t,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){let t=this.getSignature(e,this.shader.program.uniformData,`u`);return this.cache[t]||(this.cache[t]=fr(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){let n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;let r=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,t);e.buffer.update(),r(n.uniformData,e.uniforms,this.renderer,Xi,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[t])}createSyncBufferGroup(e,t,n){let{gl:r}=this.renderer;this.renderer.buffer.bind(e.buffer);let i=this.gl.getUniformBlockIndex(t.program,n);t.uniformBufferBindings[n]=this.shader.uniformBindCount,r.uniformBlockBinding(t.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;let a=this.getSignature(e,this.shader.program.uniformData,`ubo`),o=this._uboCache[a];if(o||=this._uboCache[a]=Ji(e,this.shader.program.uniformData),e.autoManage){let t=new Float32Array(o.size/4);e.buffer.update(t)}return t.uniformGroups[e.id]=o.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,n){let r=e.uniforms,i=[`${n}-`];for(let e in r)i.push(e),t[e]&&i.push(t[e].type);return i.join(`-`)}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){let t=this.gl,n=e.program,r=Hi(t,n);return n.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};Zi.extension={type:G.RendererSystem,name:`shader`},K.add(Zi);var Qi=class{constructor(e){this.renderer=e}run(e){let{renderer:t}=this;t.runners.init.emit(t.options),e.hello&&console.log(`PixiJS 7.4.3 - ${t.rendererLogId} - https://pixijs.com`),t.resize(t.screen.width,t.screen.height)}destroy(){}};Qi.defaultOptions={hello:!1},Qi.extension={type:[G.RendererSystem,G.CanvasRendererSystem],name:`startup`},K.add(Qi);function $i(e,t=[]){return t[f.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.ADD]=[e.ONE,e.ONE],t[f.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.NONE]=[0,0],t[f.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[f.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[f.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[f.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[f.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[f.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[f.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[f.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[f.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[f.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[f.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var ea=0,ta=1,na=2,ra=3,ia=4,aa=5,oa=class e{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=f.NONE,this._blendEq=!1,this.map=[],this.map[ea]=this.setBlend,this.map[ta]=this.setOffset,this.map[na]=this.setCullFace,this.map[ra]=this.setDepthTest,this.map[ia]=this.setFrontFace,this.map[aa]=this.setDepthMask,this.checks=[],this.defaultState=new bn,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=$i(e),this.set(this.defaultState),this.reset()}set(e){if(e||=this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,n=0;for(;t;)t&1&&this.map[n].call(this,!!(e.data&1<<n)),t>>=1,n++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e||=this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?`enable`:`disable`](this.gl.BLEND)}setOffset(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?`enable`:`disable`](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?`enable`:`disable`](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?`enable`:`disable`](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?`CW`:`CCW`])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;let t=this.blendModes[e],n=this.gl;t.length===2?n.blendFunc(t[0],t[1]):n.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,n.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){let n=this.checks.indexOf(e);t&&n===-1?this.checks.push(e):!t&&n!==-1&&this.checks.splice(n,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};oa.extension={type:G.RendererSystem,name:`state`},K.add(oa);var sa=class extends it.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);let t=(e.priority??[]).filter(t=>e.systems[t]),n=[...t,...Object.keys(e.systems).filter(e=>!t.includes(e))];for(let t of n)this.addSystem(e.systems[t],t)}addRunners(...e){e.forEach(e=>{this.runners[e]=new Cn(e)})}addSystem(e,t){let n=new e(this);if(this[t])throw Error(`Whoops! The name "${t}" is already in use`);for(let e in this[t]=n,this._systemsHash[t]=n,this.runners)this.runners[e].add(n);return this}emitWithCustomOptions(e,t){let n=Object.keys(this._systemsHash);e.items.forEach(r=>{let i=n.find(e=>this._systemsHash[e]===r);r[e.name](t[i])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}},ca=class e{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=e.defaultMaxIdle,this.checkCountMax=e.defaultCheckCountMax,this.mode=e.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==C.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let e=this.renderer.texture,t=e.managedTextures,n=!1;for(let r=0;r<t.length;r++){let i=t[r];i.resource&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0),t[r]=null,n=!0)}if(n){let e=0;for(let n=0;n<t.length;n++)t[n]!==null&&(t[e++]=t[n]);t.length=e}}unload(e){let t=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&t.destroyTexture(n);for(let t=e.children.length-1;t>=0;t--)this.unload(e.children[t])}destroy(){this.renderer=null}};ca.defaultMode=C.AUTO,ca.defaultMaxIdle=3600,ca.defaultCheckCountMax=600,ca.extension={type:G.RendererSystem,name:`textureGC`};var la=ca;K.add(la);var ua=class{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=g.UNSIGNED_BYTE,this.internalFormat=m.RGBA,this.samplerType=0}};function da(e){let t;return t=`WebGL2RenderingContext`in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[e.RGB]:_.FLOAT,[e.RGBA]:_.FLOAT,[e.ALPHA]:_.FLOAT,[e.LUMINANCE]:_.FLOAT,[e.LUMINANCE_ALPHA]:_.FLOAT,[e.R8]:_.FLOAT,[e.R8_SNORM]:_.FLOAT,[e.RG8]:_.FLOAT,[e.RG8_SNORM]:_.FLOAT,[e.RGB8]:_.FLOAT,[e.RGB8_SNORM]:_.FLOAT,[e.RGB565]:_.FLOAT,[e.RGBA4]:_.FLOAT,[e.RGB5_A1]:_.FLOAT,[e.RGBA8]:_.FLOAT,[e.RGBA8_SNORM]:_.FLOAT,[e.RGB10_A2]:_.FLOAT,[e.RGB10_A2UI]:_.FLOAT,[e.SRGB8]:_.FLOAT,[e.SRGB8_ALPHA8]:_.FLOAT,[e.R16F]:_.FLOAT,[e.RG16F]:_.FLOAT,[e.RGB16F]:_.FLOAT,[e.RGBA16F]:_.FLOAT,[e.R32F]:_.FLOAT,[e.RG32F]:_.FLOAT,[e.RGB32F]:_.FLOAT,[e.RGBA32F]:_.FLOAT,[e.R11F_G11F_B10F]:_.FLOAT,[e.RGB9_E5]:_.FLOAT,[e.R8I]:_.INT,[e.R8UI]:_.UINT,[e.R16I]:_.INT,[e.R16UI]:_.UINT,[e.R32I]:_.INT,[e.R32UI]:_.UINT,[e.RG8I]:_.INT,[e.RG8UI]:_.UINT,[e.RG16I]:_.INT,[e.RG16UI]:_.UINT,[e.RG32I]:_.INT,[e.RG32UI]:_.UINT,[e.RGB8I]:_.INT,[e.RGB8UI]:_.UINT,[e.RGB16I]:_.INT,[e.RGB16UI]:_.UINT,[e.RGB32I]:_.INT,[e.RGB32UI]:_.UINT,[e.RGBA8I]:_.INT,[e.RGBA8UI]:_.UINT,[e.RGBA16I]:_.INT,[e.RGBA16UI]:_.UINT,[e.RGBA32I]:_.INT,[e.RGBA32UI]:_.UINT,[e.DEPTH_COMPONENT16]:_.FLOAT,[e.DEPTH_COMPONENT24]:_.FLOAT,[e.DEPTH_COMPONENT32F]:_.FLOAT,[e.DEPTH_STENCIL]:_.FLOAT,[e.DEPTH24_STENCIL8]:_.FLOAT,[e.DEPTH32F_STENCIL8]:_.FLOAT}:{[e.RGB]:_.FLOAT,[e.RGBA]:_.FLOAT,[e.ALPHA]:_.FLOAT,[e.LUMINANCE]:_.FLOAT,[e.LUMINANCE_ALPHA]:_.FLOAT,[e.DEPTH_STENCIL]:_.FLOAT},t}function fa(e){let t;return t=`WebGL2RenderingContext`in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[g.UNSIGNED_BYTE]:{[m.RGBA]:e.RGBA8,[m.RGB]:e.RGB8,[m.RG]:e.RG8,[m.RED]:e.R8,[m.RGBA_INTEGER]:e.RGBA8UI,[m.RGB_INTEGER]:e.RGB8UI,[m.RG_INTEGER]:e.RG8UI,[m.RED_INTEGER]:e.R8UI,[m.ALPHA]:e.ALPHA,[m.LUMINANCE]:e.LUMINANCE,[m.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[g.BYTE]:{[m.RGBA]:e.RGBA8_SNORM,[m.RGB]:e.RGB8_SNORM,[m.RG]:e.RG8_SNORM,[m.RED]:e.R8_SNORM,[m.RGBA_INTEGER]:e.RGBA8I,[m.RGB_INTEGER]:e.RGB8I,[m.RG_INTEGER]:e.RG8I,[m.RED_INTEGER]:e.R8I},[g.UNSIGNED_SHORT]:{[m.RGBA_INTEGER]:e.RGBA16UI,[m.RGB_INTEGER]:e.RGB16UI,[m.RG_INTEGER]:e.RG16UI,[m.RED_INTEGER]:e.R16UI,[m.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[g.SHORT]:{[m.RGBA_INTEGER]:e.RGBA16I,[m.RGB_INTEGER]:e.RGB16I,[m.RG_INTEGER]:e.RG16I,[m.RED_INTEGER]:e.R16I},[g.UNSIGNED_INT]:{[m.RGBA_INTEGER]:e.RGBA32UI,[m.RGB_INTEGER]:e.RGB32UI,[m.RG_INTEGER]:e.RG32UI,[m.RED_INTEGER]:e.R32UI,[m.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[g.INT]:{[m.RGBA_INTEGER]:e.RGBA32I,[m.RGB_INTEGER]:e.RGB32I,[m.RG_INTEGER]:e.RG32I,[m.RED_INTEGER]:e.R32I},[g.FLOAT]:{[m.RGBA]:e.RGBA32F,[m.RGB]:e.RGB32F,[m.RG]:e.RG32F,[m.RED]:e.R32F,[m.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[g.HALF_FLOAT]:{[m.RGBA]:e.RGBA16F,[m.RGB]:e.RGB16F,[m.RG]:e.RG16F,[m.RED]:e.R16F},[g.UNSIGNED_SHORT_5_6_5]:{[m.RGB]:e.RGB565},[g.UNSIGNED_SHORT_4_4_4_4]:{[m.RGBA]:e.RGBA4},[g.UNSIGNED_SHORT_5_5_5_1]:{[m.RGBA]:e.RGB5_A1},[g.UNSIGNED_INT_2_10_10_10_REV]:{[m.RGBA]:e.RGB10_A2,[m.RGBA_INTEGER]:e.RGB10_A2UI},[g.UNSIGNED_INT_10F_11F_11F_REV]:{[m.RGB]:e.R11F_G11F_B10F},[g.UNSIGNED_INT_5_9_9_9_REV]:{[m.RGB]:e.RGB9_E5},[g.UNSIGNED_INT_24_8]:{[m.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[g.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[m.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:{[g.UNSIGNED_BYTE]:{[m.RGBA]:e.RGBA,[m.RGB]:e.RGB,[m.ALPHA]:e.ALPHA,[m.LUMINANCE]:e.LUMINANCE,[m.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[g.UNSIGNED_SHORT_5_6_5]:{[m.RGB]:e.RGB},[g.UNSIGNED_SHORT_4_4_4_4]:{[m.RGBA]:e.RGBA},[g.UNSIGNED_SHORT_5_5_5_1]:{[m.RGBA]:e.RGBA}},t}var pa=class{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new q,this.hasIntegerTextures=!1}contextChange(){let e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=fa(e),this.samplerTypes=da(e);let t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let e=0;e<t;e++)this.boundTextures[e]=null;this.emptyTextures={};let n=new ua(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new ua(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let t=0;t<6;t++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let e=0;e<this.boundTextures.length;e++)this.bind(null,e)}bind(e,t=0){let{gl:n}=this;if(e=e?.castToBaseTexture(),e?.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;let r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,n.activeTexture(n.TEXTURE0+t)),n.bindTexture(e.target,r.texture)),r.dirtyId===e.dirtyId?r.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e):(this.currentLocation!==t&&(this.currentLocation=t,n.activeTexture(n.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,n.activeTexture(n.TEXTURE0+t)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){let{gl:t,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let e=0;e<n.length;e++)n[e]===this.unknownTexture&&this.bind(null,e)}for(let r=0;r<n.length;r++)n[r]===e&&(this.currentLocation!==r&&(t.activeTexture(t.TEXTURE0+r),this.currentLocation=r),t.bindTexture(e.target,this.emptyTextures[e.target].texture),n[r]=null)}ensureSamplerType(e){let{boundTextures:t,hasIntegerTextures:n,CONTEXT_UID:r}=this;if(n)for(let n=e-1;n>=0;--n){let e=t[n];e&&e._glTextures[r].samplerType!==_.FLOAT&&this.renderer.texture.unbind(e)}}initTexture(e){let t=new ua(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on(`dispose`,this.destroyTexture,this),t}initTextureType(e,t){t.internalFormat=this.internalFormats[e.type]?.[e.format]??e.format,t.samplerType=this.samplerTypes[t.internalFormat]??_.FLOAT,this.webGLVersion===2&&e.type===g.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){let t=e._glTextures[this.CONTEXT_UID];if(!t)return;let n=this.renderer;if(this.initTextureType(e,t),e.resource?.upload(n,e,t))t.samplerType!==_.FLOAT&&(this.hasIntegerTextures=!0);else{let r=e.realWidth,i=e.realHeight,a=n.gl;(t.width!==r||t.height!==i||t.dirtyId<0)&&(t.width=r,t.height=i,a.texImage2D(e.target,0,t.internalFormat,r,i,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){let{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off(`dispose`,this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){let t=this.managedTextures.indexOf(e);t!==-1&&Kt(this.managedTextures,t,1)}}updateTextureStyle(e){let t=e._glTextures[this.CONTEXT_UID];t&&((e.mipmap===b.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=!1:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=y.CLAMP:t.wrapMode=e.wrapMode,e.resource?.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){let n=this.gl;if(t.mipmap&&e.mipmap!==b.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,t.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===v.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);let t=this.renderer.context.extensions.anisotropicFiltering;if(t&&e.anisotropicLevel>0&&e.scaleMode===v.LINEAR){let r=Math.min(e.anisotropicLevel,n.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,t.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===v.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===v.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}};pa.extension={type:G.RendererSystem,name:`texture`},K.add(pa);var ma=class{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){let{gl:t,CONTEXT_UID:n}=this,r=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,r)}unbind(){let{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){let{gl:n,renderer:r}=this;t&&r.shader.bind(t),n.beginTransformFeedback(e)}endTransformFeedback(){let{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){let{gl:t,renderer:n,CONTEXT_UID:r}=this,i=t.createTransformFeedback();e._glTransformFeedbacks[r]=i,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,i);for(let i=0;i<e.buffers.length;i++){let a=e.buffers[i];a&&(n.buffer.update(a),a._glBuffers[r].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i,a._glBuffers[r].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),i}disposeTransformFeedback(e,t){let n=e._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this);let i=this.renderer.buffer;if(i)for(let n=0;n<e.buffers.length;n++){let r=e.buffers[n];if(!r)continue;let a=r._glBuffers[this.CONTEXT_UID];a&&(a.refCount--,a.refCount===0&&!t&&i.dispose(r,t))}n&&(t||r.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};ma.extension={type:G.RendererSystem,name:`transformFeedback`},K.add(ma);var ha=class{constructor(e){this.renderer=e}init(e){this.screen=new X(0,0,e.width,e.height),this.element=e.view||k.ADAPTER.createCanvas(),this.resolution=e.resolution||k.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);let n=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=n,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${r}px`),this.renderer.emit(`resize`,n,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){e&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}};ha.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},ha.extension={type:[G.RendererSystem,G.CanvasRendererSystem],name:`_view`},K.add(ha),k.PREFER_ENV=l.WEBGL2,k.STRICT_TEXTURE_CACHE=!1,k.RENDER_OPTIONS={...Zr.defaultOptions,...Jr.defaultOptions,...ha.defaultOptions,...Qi.defaultOptions},Object.defineProperties(k,{WRAP_MODE:{get(){return q.defaultOptions.wrapMode},set(e){H(`7.1.0`,`settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode`),q.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return q.defaultOptions.scaleMode},set(e){H(`7.1.0`,`settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode`),q.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return q.defaultOptions.mipmap},set(e){H(`7.1.0`,`settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap`),q.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return q.defaultOptions.anisotropicLevel},set(e){H(`7.1.0`,`settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel`),q.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return H(`7.1.0`,`settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution`),qr.defaultResolution},set(e){qr.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return H(`7.1.0`,`settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample`),qr.defaultMultisample},set(e){qr.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return Ur.defaultMaxTextures},set(e){H(`7.1.0`,`settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures`),Ur.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return Ur.defaultBatchSize},set(e){H(`7.1.0`,`settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize`),Ur.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return Ur.canUploadSameBuffer},set(e){H(`7.1.0`,`settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer`),Ur.canUploadSameBuffer=e}},GC_MODE:{get(){return la.defaultMode},set(e){H(`7.1.0`,`settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode`),la.defaultMode=e}},GC_MAX_IDLE:{get(){return la.defaultMaxIdle},set(e){H(`7.1.0`,`settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle`),la.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return la.defaultCheckCountMax},set(e){H(`7.1.0`,`settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax`),la.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return jr.defaultVertexPrecision},set(e){H(`7.1.0`,`settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision`),jr.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return jr.defaultFragmentPrecision},set(e){H(`7.1.0`,`settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision`),jr.defaultFragmentPrecision=e}}});var ga=(e=>(e[e.INTERACTION=50]=`INTERACTION`,e[e.HIGH=25]=`HIGH`,e[e.NORMAL=0]=`NORMAL`,e[e.LOW=-25]=`LOW`,e[e.UTILITY=-50]=`UTILITY`,e))(ga||{}),_a=class{constructor(e,t=null,n=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=n,this.once=r}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));let t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let t=this.next;return this.next=e?null:t,this.previous=null,t}},va=class e{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new _a(null,null,1/0),this.deltaMS=1/e.targetFPMS,this.elapsedMS=1/e.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,n=ga.NORMAL){return this._addListener(new _a(e,t,n))}addOnce(e,t,n=ga.NORMAL){return this._addListener(new _a(e,t,n,!0))}_addListener(e){let t=this._head.next,n=this._head;if(!t)e.connect(n);else{for(;t;){if(e.priority>t.priority){e.connect(n);break}n=t,t=t.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,t){let n=this._head.next;for(;n;)n=n.match(e,t)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let n;if(t>this.lastTime){if(n=this.elapsedMS=t-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),n*=this.speed,this._minElapsedMS){let e=t-this._lastFrame|0;if(e<this._minElapsedMS)return;this._lastFrame=t-e%this._minElapsedMS}this.deltaMS=n,this.deltaTime=this.deltaMS*e.targetFPMS;let r=this._head,i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){let n=Math.min(this.maxFPS,t);this._maxElapsedMS=1/Math.min(Math.max(0,n)/1e3,e.targetFPMS)}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){e===0?this._minElapsedMS=0:this._minElapsedMS=1/(Math.max(this.minFPS,e)/1e3)}static get shared(){if(!e._shared){let t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared}static get system(){if(!e._system){let t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system}};va.targetFPMS=.06;var ya=va;Object.defineProperties(k,{TARGET_FPMS:{get(){return ya.targetFPMS},set(e){H(`7.1.0`,`settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS`),ya.targetFPMS=e}}});var ba=class{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,`ticker`,{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,ga.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?ya.shared:new ya,e.autoStart&&this.start()}static destroy(){if(this._ticker){let e=this._ticker;this.ticker=null,e.destroy()}}};ba.extension=G.Application,K.add(ba);var xa=[];K.handleByList(G.Renderer,xa);function Sa(e){for(let t of xa)if(t.test(e))return new t(e);throw Error(`Unable to auto-detect a suitable renderer.`)}var Ca=class{constructor(e){this.renderer=e}contextChange(e){let t;if(this.renderer.context.webGLVersion===1){let n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{let n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}t>=D.HIGH?this.multisample=D.HIGH:t>=D.MEDIUM?this.multisample=D.MEDIUM:t>=D.LOW?this.multisample=D.LOW:this.multisample=D.NONE}destroy(){}};Ca.extension={type:G.RendererSystem,name:`_multisample`},K.add(Ca);var wa=class{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}},Ta=class{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){let{gl:t,CONTEXT_UID:n}=this,r=e._glBuffers[n]||this.createGLBuffer(e);t.bindBuffer(e.type,r.buffer)}unbind(e){let{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){let{gl:n,CONTEXT_UID:r}=this;if(this.boundBufferBases[t]!==e){let i=e._glBuffers[r]||this.createGLBuffer(e);this.boundBufferBases[t]=e,n.bindBufferBase(n.UNIFORM_BUFFER,t,i.buffer)}}bindBufferRange(e,t,n){let{gl:r,CONTEXT_UID:i}=this;n||=0;let a=e._glBuffers[i]||this.createGLBuffer(e);r.bindBufferRange(r.UNIFORM_BUFFER,t||0,a.buffer,n*256,256)}update(e){let{gl:t,CONTEXT_UID:n}=this,r=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==r.updateID)if(r.updateID=e._updateID,t.bindBuffer(e.type,r.buffer),r.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{let n=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;r.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,n)}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];let n=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),n&&(t||r.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){let t=Object.keys(this.managedBuffers);for(let n=0;n<t.length;n++)this.dispose(this.managedBuffers[t[n]],e)}createGLBuffer(e){let{CONTEXT_UID:t,gl:n}=this;return e._glBuffers[t]=new wa(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}};Ta.extension={type:G.RendererSystem,name:`buffer`},K.add(Ta);var Ea=class{constructor(e){this.renderer=e}render(e,t){let n=this.renderer,r,i,a,o;if(t&&(r=t.renderTexture,i=t.clear,a=t.transform,o=t.skipUpdateTransform),this.renderingToScreen=!r,n.runners.prerender.emit(),n.emit(`prerender`),n.projection.transform=a,!n.context.isLost){if(r||(this.lastObjectRendered=e),!o){let t=e.enableTempParent();e.updateTransform(),e.disableTempParent(t)}n.renderTexture.bind(r),n.batch.currentRenderer.start(),(i??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),r&&(t.blit&&n.framebuffer.blit(),r.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit(`postrender`)}}destroy(){this.renderer=null,this.lastObjectRendered=null}};Ea.extension={type:G.RendererSystem,name:`objectRenderer`},K.add(Ea);var Da=class e extends sa{constructor(t){super(),this.type=u.WEBGL,t=Object.assign({},k.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Nr({projectionMatrix:new Z},!0),this.setup({runners:[`init`,`destroy`,`contextChange`,`resolutionChange`,`reset`,`update`,`postrender`,`prerender`,`resize`],systems:e.__systems,priority:[`_view`,`textureGenerator`,`background`,`_plugin`,`startup`,`context`,`state`,`texture`,`buffer`,`geometry`,`framebuffer`,`transformFeedback`,`mask`,`scissor`,`stencil`,`projection`,`textureGC`,`filter`,`renderTexture`,`batch`,`objectRenderer`,`_multisample`]}),`useContextAlpha`in t&&(H(`7.0.0`,`options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead`),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!==`notMultiplied`,t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=e.__plugins,this.options=t,this.startup.run(this.options)}static test(e){return e?.forceCanvas?!1:st()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return H(`7.0.0`,`renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead.`),this.background.clearBeforeRender}get useContextAlpha(){return H(`7.0.0`,`renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead.`),this.context.useContextAlpha}get preserveDrawingBuffer(){return H(`7.0.0`,`renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context`),this.context.preserveDrawingBuffer}get backgroundColor(){return H(`7.0.0`,`renderer.backgroundColor has been deprecated, use renderer.background.color instead.`),this.background.color}set backgroundColor(e){H(`7.0.0`,`renderer.backgroundColor has been deprecated, use renderer.background.color instead.`),this.background.color=e}get backgroundAlpha(){return H(`7.0.0`,`renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead.`),this.background.alpha}set backgroundAlpha(e){H(`7.0.0`,`renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead.`),this.background.alpha=e}get powerPreference(){return H(`7.0.0`,`renderer.powerPreference has been deprecated, we can only know this if pixi creates the context`),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};Da.extension={type:G.Renderer,priority:1},Da.__plugins={},Da.__systems={};var Oa=Da;K.handleByMap(G.RendererPlugin,Oa.__plugins),K.handleByMap(G.RendererSystem,Oa.__systems),K.add(Oa);var ka=class extends wn{constructor(e,t){let{width:n,height:r}=t||{};super(n,r),this.items=[],this.itemDirtyIds=[];for(let t=0;t<e;t++){let e=new q;this.items.push(e),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof wn?this.addResourceAt(e[n],n):this.addResourceAt(Sn(e[n],t),n))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(this.baseTexture!==null)throw Error(`Only one base texture per TextureArray is allowed`);super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on(`update`,e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off(`update`,e.update,e)}load(){if(this._load)return this._load;let e=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(e).then(()=>{let{realWidth:e,realHeight:t}=this.items[0];return this.resize(e,t),this.update(),Promise.resolve(this)}),this._load}},Aa=class extends ka{constructor(e,t){let{width:n,height:r}=t||{},i,a;Array.isArray(e)?(i=e,a=e.length):a=e,super(a,{width:n,height:r}),i&&this.initFromArray(i,t)}addBaseTextureAt(e,t){if(e.resource)this.addResourceAt(e.resource,t);else throw Error(`ArrayResource does not support RenderTexture`);return this}bind(e){super.bind(e),e.target=h.TEXTURE_2D_ARRAY}upload(e,t,n){let{length:r,itemDirtyIds:i,items:a}=this,{gl:o}=e;n.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,t.format,n.type,null);for(let e=0;e<r;e++){let r=a[e];i[e]<r.dirtyId&&(i[e]=r.dirtyId,r.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,e,r.resource.width,r.resource.height,1,t.format,n.type,r.resource.source))}return!0}},ja=class extends ei{constructor(e){super(e)}static test(e){let{OffscreenCanvas:t}=globalThis;return t&&e instanceof t?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}},Ma=class e extends ka{constructor(t,n){let{width:r,height:i,autoLoad:a,linkBaseTexture:o}=n||{};if(t&&t.length!==e.SIDES)throw Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:r,height:i});for(let t=0;t<e.SIDES;t++)this.items[t].target=h.TEXTURE_CUBE_MAP_POSITIVE_X+t;this.linkBaseTexture=o!==!1,t&&this.initFromArray(t,n),a!==!1&&this.load()}bind(e){super.bind(e),e.target=h.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[t])throw Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw Error(`CubeResource does not support copying of renderTexture.`);else e.target=h.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(t,n,r){let i=this.itemDirtyIds;for(let a=0;a<e.SIDES;a++){let e=this.items[a];(i[a]<e.dirtyId||r.dirtyId<n.dirtyId)&&(e.valid&&e.resource?(e.resource.upload(t,e,r),i[a]=e.dirtyId):i[a]<-1&&(t.gl.texImage2D(e.target,0,r.internalFormat,n.realWidth,n.realHeight,0,n.format,r.type,null),i[a]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===e.SIDES}};Ma.SIDES=6;var Na=Ma,Pa=class e extends ei{constructor(t,n){n||={};let r,i,a;typeof t==`string`?(r=e.EMPTY,i=t,a=!0):(r=t,i=null,a=!1),super(r),this.url=i,this.crossOrigin=n.crossOrigin??!0,this.alphaMode=typeof n.alphaMode==`number`?n.alphaMode:null,this.ownsImageBitmap=n.ownsImageBitmap??a,this._load=null,n.autoLoad!==!1&&this.load()}load(){return this._load||=new Promise(async(e,t)=>{if(this.url===null){e(this);return}try{let t=await k.ADAPTER.fetch(this.url,{mode:this.crossOrigin?`cors`:`no-cors`});if(this.destroyed)return;let n=await t.blob();if(this.destroyed)return;let r=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===x.UNPACK?`premultiply`:`none`});if(this.destroyed){r.close();return}this.source=r,this.update(),e(this)}catch(e){if(this.destroyed)return;t(e),this.onError.emit(e)}}),this._load}upload(e,t,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode==`number`&&(t.alphaMode=this.alphaMode),super.upload(e,t,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<`u`&&(typeof e==`string`||e instanceof ImageBitmap)}static get EMPTY(){return e._EMPTY=e._EMPTY??k.ADAPTER.createCanvas(0,0),e._EMPTY}},Fa=class e extends ei{constructor(e,t){t||={},super(k.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load||=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},e.SVG_XML.test(this.svg.trim())){if(!btoa)throw Error(`Your browser doesn't support base64 conversions.`);this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load}_loadSvg(){let e=new Image;ei.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;let t=e.width,n=e.height;if(!t||!n)throw Error(`The SVG image must have width and height defined (in pixels), canvas API needs them.`);let r=t*this.scale,i=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/n*t,i=this._overrideHeight||this._overrideWidth/t*n),r=Math.round(r),i=Math.round(i);let a=this.source;a.width=r,a.height=i,a._pixiId=`canvas_${Yt()}`,a.getContext(`2d`).drawImage(e,0,0,t,n,0,0,r,i),this._resolve(),this._resolve=null}}static getSize(t){let n=e.SVG_SIZE.exec(t),r={};return n&&(r[n[1]]=Math.round(parseFloat(n[3])),r[n[5]]=Math.round(parseFloat(n[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,n){return n===`svg`||typeof t==`string`&&t.startsWith(`data:image/svg+xml`)||typeof t==`string`&&e.SVG_XML.test(t)}};Fa.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Fa.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Ia=Fa,La=class extends ei{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}},Ra=class e extends ei{constructor(t,n){if(n||={},!(t instanceof HTMLVideoElement)){let r=document.createElement(`video`);n.autoLoad!==!1&&r.setAttribute(`preload`,`auto`),n.playsinline!==!1&&(r.setAttribute(`webkit-playsinline`,``),r.setAttribute(`playsinline`,``)),n.muted===!0&&(r.setAttribute(`muted`,``),r.muted=!0),n.loop===!0&&r.setAttribute(`loop`,``),n.autoPlay!==!1&&r.setAttribute(`autoplay`,``),typeof t==`string`&&(t=[t]),ei.crossOrigin(r,t[0].src||t[0],n.crossorigin);for(let n=0;n<t.length;++n){let i=document.createElement(`source`),{src:a,mime:o}=t[n];if(a||=t[n],a.startsWith(`data:`))o=a.slice(5,a.indexOf(`;`));else if(!a.startsWith(`blob:`)){let t=a.split(`?`).shift().toLowerCase(),n=t.slice(t.lastIndexOf(`.`)+1);o=o||e.MIME_TYPES[n]||`video/${n}`}i.src=a,o&&(i.type=o),r.appendChild(i)}t=r}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=n.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=n.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),n.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){let e=ya.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;let e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener(`play`,this._onPlayStart),e.addEventListener(`pause`,this._onPlayStop),e.addEventListener(`seeked`,this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener(`canplay`,this._onCanPlay),e.addEventListener(`canplaythrough`,this._onCanPlay),e.addEventListener(`error`,this._onError,!0)),this._load=new Promise((t,n)=>{this.valid?t(this):(this._resolve=t,this._reject=n,e.load())}),this._load}_onError(e){this.source.removeEventListener(`error`,this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){let e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){let e=this.source;e.removeEventListener(`canplay`,this._onCanPlay),e.removeEventListener(`canplaythrough`,this._onCanPlay);let t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();let e=this.source;e&&(e.removeEventListener(`play`,this._onPlayStart),e.removeEventListener(`pause`,this._onPlayStop),e.removeEventListener(`seeked`,this._onSeeked),e.removeEventListener(`canplay`,this._onCanPlay),e.removeEventListener(`canplaythrough`,this._onCanPlay),e.removeEventListener(`error`,this._onError,!0),e.pause(),e.src=``,e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ya.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ya.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ya.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,n){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.includes(n)}};Ra.TYPES=[`mp4`,`m4v`,`webm`,`ogg`,`ogv`,`h264`,`avi`,`mov`],Ra.MIME_TYPES={ogv:`video/ogg`,mov:`video/quicktime`,m4v:`video/mp4`},xn.push(Pa,ti,ja,Ra,La,Ia,Tn,Na,Aa);var za=class{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?X.EMPTY:(e||=new X(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){let{a:n,b:r,c:i,d:a,tx:o,ty:s}=e,c=n*t.x+i*t.y+o,l=r*t.x+a*t.y+s;this.minX=Math.min(this.minX,c),this.maxX=Math.max(this.maxX,c),this.minY=Math.min(this.minY,l),this.maxY=Math.max(this.maxY,l)}addQuad(e){let t=this.minX,n=this.minY,r=this.maxX,i=this.maxY,a=e[0],o=e[1];t=a<t?a:t,n=o<n?o:n,r=a>r?a:r,i=o>i?o:i,a=e[2],o=e[3],t=a<t?a:t,n=o<n?o:n,r=a>r?a:r,i=o>i?o:i,a=e[4],o=e[5],t=a<t?a:t,n=o<n?o:n,r=a>r?a:r,i=o>i?o:i,a=e[6],o=e[7],t=a<t?a:t,n=o<n?o:n,r=a>r?a:r,i=o>i?o:i,this.minX=t,this.minY=n,this.maxX=r,this.maxY=i}addFrame(e,t,n,r,i){this.addFrameMatrix(e.worldTransform,t,n,r,i)}addFrameMatrix(e,t,n,r,i){let a=e.a,o=e.b,s=e.c,c=e.d,l=e.tx,u=e.ty,d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,h=a*t+s*n+l,g=o*t+c*n+u;d=h<d?h:d,f=g<f?g:f,p=h>p?h:p,m=g>m?g:m,h=a*r+s*n+l,g=o*r+c*n+u,d=h<d?h:d,f=g<f?g:f,p=h>p?h:p,m=g>m?g:m,h=a*t+s*i+l,g=o*t+c*i+u,d=h<d?h:d,f=g<f?g:f,p=h>p?h:p,m=g>m?g:m,h=a*r+s*i+l,g=o*r+c*i+u,d=h<d?h:d,f=g<f?g:f,p=h>p?h:p,m=g>m?g:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addVertexData(e,t,n){let r=this.minX,i=this.minY,a=this.maxX,o=this.maxY;for(let s=t;s<n;s+=2){let t=e[s],n=e[s+1];r=t<r?t:r,i=n<i?n:i,a=t>a?t:a,o=n>o?n:o}this.minX=r,this.minY=i,this.maxX=a,this.maxY=o}addVertices(e,t,n,r){this.addVerticesMatrix(e.worldTransform,t,n,r)}addVerticesMatrix(e,t,n,r,i=0,a=i){let o=e.a,s=e.b,c=e.c,l=e.d,u=e.tx,d=e.ty,f=this.minX,p=this.minY,m=this.maxX,h=this.maxY;for(let e=n;e<r;e+=2){let n=t[e],r=t[e+1],g=o*n+c*r+u,_=l*r+s*n+d;f=Math.min(f,g-i),m=Math.max(m,g+i),p=Math.min(p,_-a),h=Math.max(h,_+a)}this.minX=f,this.minY=p,this.maxX=m,this.maxY=h}addBounds(e){let t=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>i?e.maxY:i}addBoundsMask(e,t){let n=e.minX>t.minX?e.minX:t.minX,r=e.minY>t.minY?e.minY:t.minY,i=e.maxX<t.maxX?e.maxX:t.maxX,a=e.maxY<t.maxY?e.maxY:t.maxY;if(n<=i&&r<=a){let e=this.minX,t=this.minY,o=this.maxX,s=this.maxY;this.minX=n<e?n:e,this.minY=r<t?r:t,this.maxX=i>o?i:o,this.maxY=a>s?a:s}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){let n=e.minX>t.x?e.minX:t.x,r=e.minY>t.y?e.minY:t.y,i=e.maxX<t.x+t.width?e.maxX:t.x+t.width,a=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(n<=i&&r<=a){let e=this.minX,t=this.minY,o=this.maxX,s=this.maxY;this.minX=n<e?n:e,this.minY=r<t?r:t,this.maxX=i>o?i:o,this.maxY=a>s?a:s}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,n,r,i,a){e-=i,t-=a,n+=i,r+=a,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>r?this.maxY:r}},Ba=class e extends it.default{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new rr,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new za,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){let n=Object.keys(t);for(let r=0;r<n.length;++r){let i=n[r];Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(t,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||=(this._boundsRect||=new X,this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||=(this._localBoundsRect||=new X,this._localBoundsRect),this._localBounds||=new za;let t=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=n?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;let r=this._bounds,i=this._boundsID;this._bounds=this._localBounds;let a=this.getBounds(!1,e);return this.parent=n,this.transform=t,this._bounds=r,this._bounds.updateID+=this._boundsID-i,a}toGlobal(e,t,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,n,r){return t&&(e=t.toGlobal(e,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw Error(`setParent: Argument must be a Container`);return e.addChild(this),e}removeFromParent(){this.parent?.removeChild(this)}setTransform(e=0,t=0,n=1,r=1,i=0,a=0,o=0,s=0,c=0){return this.position.x=e,this.position.y=t,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=a,this.skew.y=o,this.pivot.x=s,this.pivot.y=c,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode=`auto`,this.interactiveChildren=!1,this.emit(`destroyed`),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Va),this.tempDisplayObjectParent}enableTempParent(){let e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*Bn}set angle(e){this.transform.rotation=e*Vn}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){let e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=e,this._mask){let e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}},Va=class extends Ba{constructor(){super(...arguments),this.sortDirty=null}};Ba.prototype.displayObjectUpdateTransform=Ba.prototype.updateTransform;var Ha=new Z;function Ua(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}var Wa=class e extends Ba{constructor(){super(),this.children=[],this.sortableChildren=e.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{let t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit(`childAdded`,t,this,this.children.length-1),t.emit(`added`,this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit(`added`,this),this.emit(`childAdded`,e,this,t),e}swapChildren(e,t){if(e===t)return;let n=this.getChildIndex(e),r=this.getChildIndex(t);this.children[n]=t,this.children[r]=e,this.onChildrenChange(n<r?n:r)}getChildIndex(e){let t=this.children.indexOf(e);if(t===-1)throw Error(`The supplied DisplayObject must be a child of the caller`);return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw Error(`The index ${t} supplied is out of bounds ${this.children.length}`);let n=this.getChildIndex(e);Kt(this.children,n,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{let t=e[0],n=this.children.indexOf(t);if(n===-1)return null;t.parent=null,t.transform._parentID=-1,Kt(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit(`removed`,this),this.emit(`childRemoved`,t,this,n)}return e[0]}removeChildAt(e){let t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Kt(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit(`removed`,this),this.emit(`childRemoved`,t,this,e),t}removeChildren(e=0,t=this.children.length){let n=e,r=t,i=r-n,a;if(i>0&&i<=r){a=this.children.splice(n,i);for(let e=0;e<a.length;++e)a[e].parent=null,a[e].transform&&(a[e].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let e=0;e<a.length;++e)a[e].emit(`removed`,this),this.emit(`childRemoved`,a[e],this,e);return a}else if(i===0&&this.children.length===0)return[];throw RangeError(`removeChildren: numeric values are outside the acceptable range.`)}sortChildren(){let e=!1;for(let t=0,n=this.children.length;t<n;++t){let n=this.children[t];n._lastSortedIndex=t,!e&&n.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(Ua),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){let t=this.children[e];t.visible&&t.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){let t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){let e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){let n=super.getLocalBounds(e);if(!t)for(let e=0,t=this.children.length;e<t;++e){let t=this.children[e];t.visible&&t.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(t){let n=t.renderTexture.sourceFrame;if(!(n.width>0&&n.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==e.prototype._render&&(r=this.getBounds(!0));let a=t.projection.transform;if(a&&(i?(i=Ha.copyFrom(i),i.prepend(a)):i=a),r&&n.intersects(r,i))this._render(t);else if(this.cullArea)return;for(let e=0,n=this.children.length;e<n;++e){let n=this.children[e],r=n.cullable;n.cullable=r||!this.cullArea,n.render(t),n.cullable=r}}render(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,n=this.children.length;t<n;++t)this.children[t].render(e)}}renderAdvanced(e){let t=this.filters,n=this._mask;if(t){this._enabledFilters||=[],this._enabledFilters.length=0;for(let e=0;e<t.length;e++)t[e].enabled&&this._enabledFilters.push(t[e])}let r=t&&this._enabledFilters?.length||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==T.NONE));if(r&&e.batch.flush(),t&&this._enabledFilters?.length&&e.filter.push(this,this._enabledFilters),n&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,n=this.children.length;t<n;++t)this.children[t].render(e)}r&&e.batch.flush(),n&&e.mask.pop(this),t&&this._enabledFilters?.length&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;let t=typeof e==`boolean`?e:e?.children,n=this.removeChildren(0,this.children.length);if(t)for(let t=0;t<n.length;++t)n[t].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){let t=this.getLocalBounds().width;t===0?this.scale.x=1:this.scale.x=e/t,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){let t=this.getLocalBounds().height;t===0?this.scale.y=1:this.scale.y=e/t,this._height=e}};Wa.defaultSortableChildren=!1;var Ga=Wa;Ga.prototype.containerUpdateTransform=Ga.prototype.updateTransform,Object.defineProperties(k,{SORTABLE_CHILDREN:{get(){return Ga.defaultSortableChildren},set(e){H(`7.1.0`,`settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren`),Ga.defaultSortableChildren=e}}});var Ka=class e{constructor(t){this.stage=new Ga,t=Object.assign({forceCanvas:!1},t),this.renderer=Sa(t),e._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(t,n){let r=e._plugins.slice(0);r.reverse(),r.forEach(e=>{e.destroy.call(this)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Ka._plugins=[];var qa=Ka;K.handleByList(G.Application,qa._plugins);var Ja=class{static init(e){Object.defineProperty(this,`resizeTo`,{set(e){globalThis.removeEventListener(`resize`,this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener(`resize`,this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&=(cancelAnimationFrame(this._resizeId),null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,t;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,t=globalThis.innerHeight;else{let{clientWidth:n,clientHeight:r}=this._resizeTo;e=n,t=r}this.renderer.resize(e,t),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener(`resize`,this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}};Ja.extension=G.Application,K.add(Ja);var Ya={build(e){let t=e.points,n,r,i,a,o,s;if(e.type===J.CIRC){let t=e.shape;n=t.x,r=t.y,o=s=t.radius,i=a=0}else if(e.type===J.ELIP){let t=e.shape;n=t.x,r=t.y,o=t.width,s=t.height,i=a=0}else{let t=e.shape,c=t.width/2,l=t.height/2;n=t.x+c,r=t.y+l,o=s=Math.max(0,Math.min(t.radius,Math.min(c,l))),i=c-o,a=l-s}if(!(o>=0&&s>=0&&i>=0&&a>=0)){t.length=0;return}let c=Math.ceil(2.3*Math.sqrt(o+s)),l=c*8+(i?4:0)+(a?4:0);if(t.length=l,l===0)return;if(c===0){t.length=8,t[0]=t[6]=n+i,t[1]=t[3]=r+a,t[2]=t[4]=n-i,t[5]=t[7]=r-a;return}let u=0,d=c*4+(i?2:0)+2,f=d,p=l;{let e=i+o,s=a,c=n+e,l=n-e,m=r+s;if(t[u++]=c,t[u++]=m,t[--d]=m,t[--d]=l,a){let e=r-s;t[f++]=l,t[f++]=e,t[--p]=e,t[--p]=c}}for(let e=1;e<c;e++){let l=Math.PI/2*(e/c),m=i+Math.cos(l)*o,h=a+Math.sin(l)*s,g=n+m,_=n-m,v=r+h,y=r-h;t[u++]=g,t[u++]=v,t[--d]=v,t[--d]=_,t[f++]=_,t[f++]=y,t[--p]=y,t[--p]=g}{let e=i,o=a+s,c=n+e,l=n-e,d=r+o,f=r-o;t[u++]=c,t[u++]=d,t[--p]=f,t[--p]=c,i&&(t[u++]=l,t[u++]=d,t[--p]=f,t[--p]=l)}},triangulate(e,t){let n=e.points,r=t.points,i=t.indices;if(n.length===0)return;let a=r.length/2,o=a,s,c;if(e.type!==J.RREC){let t=e.shape;s=t.x,c=t.y}else{let t=e.shape;s=t.x+t.width/2,c=t.y+t.height/2}let l=e.matrix;r.push(e.matrix?l.a*s+l.c*c+l.tx:s,e.matrix?l.b*s+l.d*c+l.ty:c),a++,r.push(n[0],n[1]);for(let e=2;e<n.length;e+=2)r.push(n[e],n[e+1]),i.push(a++,o,a);i.push(o+1,o,a)}};function Xa(e,t=!1){let n=e.length;if(n<6)return;let r=0;for(let t=0,i=e[n-2],a=e[n-1];t<n;t+=2){let n=e[t],o=e[t+1];r+=(n-i)*(o+a),i=n,a=o}if(!t&&r>0||t&&r<=0){let t=n/2;for(let r=t+t%2;r<n;r+=2){let t=n-r-2,i=n-r-1,a=r,o=r+1;[e[t],e[a]]=[e[a],e[t]],[e[i],e[o]]=[e[o],e[i]]}}}var Za={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let n=e.points,r=e.holes,i=t.points,a=t.indices;if(n.length>=6){Xa(n,!1);let e=[];for(let t=0;t<r.length;t++){let i=r[t];Xa(i.points,!0),e.push(n.length/2),n=n.concat(i.points)}let t=rt.default(n,e,2);if(!t)return;let o=i.length/2;for(let e=0;e<t.length;e+=3)a.push(t[e]+o),a.push(t[e+1]+o),a.push(t[e+2]+o);for(let e=0;e<n.length;e++)i.push(n[e])}}},Qa={build(e){let t=e.shape,n=t.x,r=t.y,i=t.width,a=t.height,o=e.points;o.length=0,i>=0&&a>=0&&o.push(n,r,n+i,r,n+i,r+a,n,r+a)},triangulate(e,t){let n=e.points,r=t.points;if(n.length===0)return;let i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},$a={build(e){Ya.build(e)},triangulate(e,t){Ya.triangulate(e,t)}},eo=(e=>(e.MITER=`miter`,e.BEVEL=`bevel`,e.ROUND=`round`,e))(eo||{}),to=(e=>(e.BUTT=`butt`,e.ROUND=`round`,e.SQUARE=`square`,e))(to||{}),no={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let n=Math.ceil(e/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},ro=class{static curveTo(e,t,n,r,i,a){let o=a[a.length-2],s=a[a.length-1]-t,c=o-e,l=r-t,u=n-e,d=Math.abs(s*u-c*l);if(d<1e-8||i===0)return(a[a.length-2]!==e||a[a.length-1]!==t)&&a.push(e,t),null;let f=s*s+c*c,p=l*l+u*u,m=s*l+c*u,h=i*Math.sqrt(f)/d,g=i*Math.sqrt(p)/d,_=h*m/f,v=g*m/p,y=h*u+g*c,b=h*l+g*s,x=c*(g+_),S=s*(g+_),C=u*(h+v),w=l*(h+v),T=Math.atan2(S-b,x-y),E=Math.atan2(w-b,C-y);return{cx:y+e,cy:b+t,radius:i,startAngle:T,endAngle:E,anticlockwise:c*l>u*s}}static arc(e,t,n,r,i,a,o,s,c){let l=o-a,u=no._segmentsCount(Math.abs(l)*i,Math.ceil(Math.abs(l)/zn)*40),d=l/(u*2),f=d*2,p=Math.cos(d),m=Math.sin(d),h=u-1,g=h%1/h;for(let e=0;e<=h;++e){let t=e+g*e,o=d+a+f*t,s=Math.cos(o),l=-Math.sin(o);c.push((p*s+m*l)*i+n,(p*-l+m*s)*i+r)}}},io=class{constructor(){this.reset()}begin(e,t,n){this.reset(),this.style=e,this.start=t,this.attribStart=n}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}},ao=class e{static curveLength(e,t,n,r,i,a,o,s){let c=0,l=0,u=0,d=0,f=0,p=0,m=0,h=0,g=0,_=0,v=0,y=e,b=t;for(let x=1;x<=10;++x)l=x/10,u=l*l,d=u*l,f=1-l,p=f*f,m=p*f,h=m*e+3*p*l*n+3*f*u*i+d*o,g=m*t+3*p*l*r+3*f*u*a+d*s,_=y-h,v=b-g,y=h,b=g,c+=Math.sqrt(_*_+v*v);return c}static curveTo(t,n,r,i,a,o,s){let c=s[s.length-2],l=s[s.length-1];s.length-=2;let u=no._segmentsCount(e.curveLength(c,l,t,n,r,i,a,o)),d=0,f=0,p=0,m=0,h=0;s.push(c,l);for(let e=1,g=0;e<=u;++e)g=e/u,d=1-g,f=d*d,p=f*d,m=g*g,h=m*g,s.push(p*c+3*f*g*t+3*d*m*r+h*a,p*l+3*f*g*n+3*d*m*i+h*o)}};function oo(e,t,n,r,i,a,o,s){let c=e-n*i,l=t-r*i,u=e+n*a,d=t+r*a,f,p;o?(f=r,p=-n):(f=-r,p=n);let m=c+f,h=l+p,g=u+f,_=d+p;return s.push(m,h,g,_),2}function so(e,t,n,r,i,a,o,s){let c=n-e,l=r-t,u=Math.atan2(c,l),d=Math.atan2(i-e,a-t);s&&u<d?u+=Math.PI*2:!s&&u>d&&(d+=Math.PI*2);let f=u,p=d-u,m=Math.abs(p),h=Math.sqrt(c*c+l*l),g=(15*m*Math.sqrt(h)/Math.PI>>0)+1,_=p/g;if(f+=_,s){o.push(e,t,n,r);for(let n=1,r=f;n<g;n++,r+=_)o.push(e,t,e+Math.sin(r)*h,t+Math.cos(r)*h);o.push(e,t,i,a)}else{o.push(n,r,e,t);for(let n=1,r=f;n<g;n++,r+=_)o.push(e+Math.sin(r)*h,t+Math.cos(r)*h,e,t);o.push(i,a,e,t)}return g*2}function co(e,t){let n=e.shape,r=e.points||n.points.slice(),i=t.closePointEps;if(r.length===0)return;let a=e.lineStyle,o=new Y(r[0],r[1]),s=new Y(r[r.length-2],r[r.length-1]),c=n.type!==J.POLY||n.closeStroke,l=Math.abs(o.x-s.x)<i&&Math.abs(o.y-s.y)<i;if(c){r=r.slice(),l&&(r.pop(),r.pop(),s.set(r[r.length-2],r[r.length-1]));let e=(o.x+s.x)*.5,t=(s.y+o.y)*.5;r.unshift(e,t),r.push(e,t)}let u=t.points,d=r.length/2,f=r.length,p=u.length/2,m=a.width/2,h=m*m,g=a.miterLimit*a.miterLimit,_=r[0],v=r[1],y=r[2],b=r[3],x=0,S=0,C=-(v-b),w=_-y,T=0,E=0,D=Math.sqrt(C*C+w*w);C/=D,w/=D,C*=m,w*=m;let O=a.alignment,k=(1-O)*2,A=O*2;c||(a.cap===to.ROUND?f+=so(_-C*(k-A)*.5,v-w*(k-A)*.5,_-C*k,v-w*k,_+C*A,v+w*A,u,!0)+2:a.cap===to.SQUARE&&(f+=oo(_,v,C,w,k,A,!0,u))),u.push(_-C*k,v-w*k,_+C*A,v+w*A);for(let e=1;e<d-1;++e){_=r[(e-1)*2],v=r[(e-1)*2+1],y=r[e*2],b=r[e*2+1],x=r[(e+1)*2],S=r[(e+1)*2+1],C=-(v-b),w=_-y,D=Math.sqrt(C*C+w*w),C/=D,w/=D,C*=m,w*=m,T=-(b-S),E=y-x,D=Math.sqrt(T*T+E*E),T/=D,E/=D,T*=m,E*=m;let t=y-_,n=v-b,i=y-x,o=S-b,s=t*i+n*o,c=n*i-o*t,l=c<0;if(Math.abs(c)<.001*Math.abs(s)){u.push(y-C*k,b-w*k,y+C*A,b+w*A),s>=0&&(a.join===eo.ROUND?f+=so(y,b,y-C*k,b-w*k,y-T*k,b-E*k,u,!1)+4:f+=2,u.push(y-T*A,b-E*A,y+T*k,b+E*k));continue}let d=(-C+_)*(-w+b)-(-C+y)*(-w+v),p=(-T+x)*(-E+b)-(-T+y)*(-E+S),O=(t*p-i*d)/c,j=(o*d-n*p)/c,M=(O-y)*(O-y)+(j-b)*(j-b),N=y+(O-y)*k,P=b+(j-b)*k,F=y-(O-y)*A,I=b-(j-b)*A,L=Math.min(t*t+n*n,i*i+o*o),R=l?k:A,ee=L+R*R*h,z=M<=ee,B=a.join;if(B===eo.MITER&&M/h>g&&(B=eo.BEVEL),z)switch(B){case eo.MITER:u.push(N,P,F,I);break;case eo.BEVEL:l?u.push(N,P,y+C*A,b+w*A,N,P,y+T*A,b+E*A):u.push(y-C*k,b-w*k,F,I,y-T*k,b-E*k,F,I),f+=2;break;case eo.ROUND:l?(u.push(N,P,y+C*A,b+w*A),f+=so(y,b,y+C*A,b+w*A,y+T*A,b+E*A,u,!0)+4,u.push(N,P,y+T*A,b+E*A)):(u.push(y-C*k,b-w*k,F,I),f+=so(y,b,y-C*k,b-w*k,y-T*k,b-E*k,u,!1)+4,u.push(y-T*k,b-E*k,F,I));break}else{switch(u.push(y-C*k,b-w*k,y+C*A,b+w*A),B){case eo.MITER:l?u.push(F,I,F,I):u.push(N,P,N,P),f+=2;break;case eo.ROUND:l?f+=so(y,b,y+C*A,b+w*A,y+T*A,b+E*A,u,!0)+2:f+=so(y,b,y-C*k,b-w*k,y-T*k,b-E*k,u,!1)+2;break}u.push(y-T*k,b-E*k,y+T*A,b+E*A),f+=2}}_=r[(d-2)*2],v=r[(d-2)*2+1],y=r[(d-1)*2],b=r[(d-1)*2+1],C=-(v-b),w=_-y,D=Math.sqrt(C*C+w*w),C/=D,w/=D,C*=m,w*=m,u.push(y-C*k,b-w*k,y+C*A,b+w*A),c||(a.cap===to.ROUND?f+=so(y-C*(k-A)*.5,b-w*(k-A)*.5,y-C*k,b-w*k,y+C*A,b+w*A,u,!1)+2:a.cap===to.SQUARE&&(f+=oo(y,b,C,w,k,A,!1,u)));let j=t.indices,M=no.epsilon*no.epsilon;for(let e=p;e<f+p-2;++e)_=u[e*2],v=u[e*2+1],y=u[(e+1)*2],b=u[(e+1)*2+1],x=u[(e+2)*2],S=u[(e+2)*2+1],!(Math.abs(_*(b-S)+y*(S-v)+x*(v-b))<M)&&j.push(e,e+1,e+2)}function lo(e,t){let n=0,r=e.shape,i=e.points||r.points,a=r.type!==J.POLY||r.closeStroke;if(i.length===0)return;let o=t.points,s=t.indices,c=i.length/2,l=o.length/2,u=l;for(o.push(i[0],i[1]),n=1;n<c;n++)o.push(i[n*2],i[n*2+1]),s.push(u,u+1),u++;a&&s.push(u,l)}function uo(e,t){e.lineStyle.native?lo(e,t):co(e,t)}var fo=class e{static curveLength(e,t,n,r,i,a){let o=e-2*n+i,s=t-2*r+a,c=2*n-2*e,l=2*r-2*t,u=4*(o*o+s*s),d=4*(o*c+s*l),f=c*c+l*l,p=2*Math.sqrt(u+d+f),m=Math.sqrt(u),h=2*u*m,g=2*Math.sqrt(f),_=d/m;return(h*p+m*d*(p-g)+(4*f*u-d*d)*Math.log((2*m+_+p)/(_+g)))/(4*h)}static curveTo(t,n,r,i,a){let o=a[a.length-2],s=a[a.length-1],c=no._segmentsCount(e.curveLength(o,s,t,n,r,i)),l=0,u=0;for(let e=1;e<=c;++e){let d=e/c;l=o+(t-o)*d,u=s+(n-s)*d,a.push(l+(t+(r-t)*d-l)*d,u+(n+(i-n)*d-u)*d)}}},po={[J.POLY]:Za,[J.CIRC]:Ya,[J.ELIP]:Ya,[J.RECT]:Qa,[J.RREC]:$a},mo=[],ho=[],go=class e{constructor(e,t=null,n=null,r=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=t,this.matrix=r,this.type=e.type}clone(){return new e(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}},_o=new Y,vo=class e extends Rn{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new za,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),ho.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t.reset(),mo.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,n=null,r=null){let i=new go(e,t,n,r);return this.graphicsData.push(i),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;let n=new go(e,null,null,t),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){let t=this.graphicsData;for(let n=0;n<t.length;++n){let r=t[n];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(e,_o):_o.copyFrom(e),r.shape.contains(_o.x,_o.y))){let e=!1;if(r.holes){for(let t=0;t<r.holes.length;t++)if(r.holes[t].shape.contains(_o.x,_o.y)){e=!0;break}}if(!e)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let e=this.uvs,t=this.graphicsData,n=null,r=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],r=n.style);for(let i=this.shapeIndex;i<t.length;i++){this.shapeIndex++;let a=t[i],o=a.fillStyle,s=a.lineStyle;po[a.type].build(a),a.matrix&&this.transformPoints(a.points,a.matrix),(o.visible||s.visible)&&this.processHoles(a.holes);for(let t=0;t<2;t++){let i=t===0?o:s;if(!i.visible)continue;let c=i.texture.baseTexture,l=this.indices.length,u=this.points.length/2;c.wrapMode=y.REPEAT,t===0?this.processFill(a):this.processLine(a);let d=this.points.length/2-u;d!==0&&(n&&!this._compareStyles(r,i)&&(n.end(l,u),n=null),n||(n=mo.pop()||new io,n.begin(i,l,u),this.batches.push(n),r=i),this.addUvs(this.points,e,i.texture,u,d,i.matrix))}}let i=this.indices.length,a=this.points.length/2;if(n&&n.end(i,a),this.batches.length===0){this.batchable=!0;return}let o=a>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){let t=this.graphicsData[e],n=t.fillStyle,r=t.lineStyle;if(n&&!n.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let e=this.batches;for(let t=0,n=e.length;t<n;t++){let n=e[t];for(let e=0;e<n.size;e++){let t=n.start+e;this.indicesUint16[t]=this.indicesUint16[t]-n.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;let t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<e.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++q._globalBatch;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),ho.push(this.drawCalls[e]);this.drawCalls.length=0;let t=this.colors,n=this.textureIds,r=ho.pop();r||(r=new On,r.texArray=new Ir),r.texArray.count=0,r.start=0,r.size=0,r.type=p.TRIANGLES;let i=0,a=null,o=0,s=!1,c=p.TRIANGLES,l=0;this.drawCalls.push(r);for(let u=0;u<this.batches.length;u++){let d=this.batches[u],f=d.style,m=f.texture.baseTexture;s!==!!f.native&&(s=!!f.native,c=s?p.LINES:p.TRIANGLES,a=null,i=8,e++),a!==m&&(a=m,m._batchEnabled!==e&&(i===8&&(e++,i=0,r.size>0&&(r=ho.pop(),r||(r=new On,r.texArray=new Ir),this.drawCalls.push(r)),r.start=l,r.size=0,r.texArray.count=0,r.type=c),m.touched=1,m._batchEnabled=e,m._batchLocation=i,m.wrapMode=y.REPEAT,r.texArray.elements[r.texArray.count++]=m,i++)),r.size+=d.size,l+=d.size,o=m._batchLocation,this.addColors(t,f.color,f.alpha,d.attribSize,d.attribStart),this.addTextureIds(n,o,d.attribSize,d.attribStart)}q._globalBatch=e,this.packAttributes()}packAttributes(){let e=this.points,t=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(e.length*3*4),a=new Float32Array(i),o=new Uint32Array(i),s=0;for(let i=0;i<e.length/2;i++)a[s++]=e[i*2],a[s++]=e[i*2+1],a[s++]=t[i*2],a[s++]=t[i*2+1],o[s++]=n[i],a[s++]=r[i];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?Za.triangulate(e,this):po[e.type].triangulate(e,this)}processLine(e){uo(e,this);for(let t=0;t<e.holes.length;t++)uo(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){let n=e[t];po[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){let e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let n=0;n<e.length/2;n++){let r=e[n*2],i=e[n*2+1];e[n*2]=t.a*r+t.c*i+t.tx,e[n*2+1]=t.b*r+t.d*i+t.ty}}addColors(e,t,n,r,i=0){let a=W.shared.setValue(t).toLittleEndianNumber(),o=W.shared.setValue(a).toPremultiplied(n);e.length=Math.max(e.length,i+r);for(let t=0;t<r;t++)e[i+t]=o}addTextureIds(e,t,n,r=0){e.length=Math.max(e.length,r+n);for(let i=0;i<n;i++)e[r+i]=t}addUvs(e,t,n,r,i,a=null){let o=0,s=t.length,c=n.frame;for(;o<i;){let n=e[(r+o)*2],i=e[(r+o)*2+1];if(a){let e=a.a*n+a.c*i+a.tx;i=a.b*n+a.d*i+a.ty,n=e}o++,t.push(n/c.width,i/c.height)}let l=n.baseTexture;(c.width<l.width||c.height<l.height)&&this.adjustUvs(t,n,s,i)}adjustUvs(e,t,n,r){let i=t.baseTexture,a=1e-6,o=n+r*2,s=t.frame,c=s.width/i.width,l=s.height/i.height,u=s.x/s.width,d=s.y/s.height,f=Math.floor(e[n]+a),p=Math.floor(e[n+1]+a);for(let t=n+2;t<o;t+=2)f=Math.min(f,Math.floor(e[t]+a)),p=Math.min(p,Math.floor(e[t+1]+a));u-=f,d-=p;for(let t=n;t<o;t+=2)e[t]=(e[t]+u)*c,e[t+1]=(e[t+1]+d)*l}};vo.BATCHABLE_SIZE=100;var yo=vo,bo=class e{constructor(){this.color=16777215,this.alpha=1,this.texture=ai.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=ai.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}},xo=class e extends bo{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=to.BUTT,this.join=eo.MITER,this.miterLimit=10}clone(){let t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=to.BUTT,this.join=eo.MITER,this.miterLimit=10}},So={},Co=class e extends Ga{constructor(e=null){super(),this.shader=null,this.pluginName=`batch`,this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new bo,this._lineStyle=new xo,this._matrix=null,this._holeMode=!1,this.state=bn.for2d(),this._geometry=e||new yo,this._geometry.refCount++,this._transformID=-1,this._tintColor=new W(16777215),this.blendMode=f.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new e(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,n,r=.5,i=!1){return typeof e==`number`&&(e={width:e,color:t,alpha:n,alignment:r,native:i}),this.lineTextureStyle(e)}lineTextureStyle(e){let t={width:0,texture:ai.WHITE,color:e?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:to.BUTT,join:eo.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Gn,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Gn,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);let n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return(r!==e||i!==t)&&n.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,n,r){this._initCurve();let i=this.currentPath.points;return i.length===0&&this.moveTo(0,0),fo.curveTo(e,t,n,r,i),this}bezierCurveTo(e,t,n,r,i,a){return this._initCurve(),ao.curveTo(e,t,n,r,i,a,this.currentPath.points),this}arcTo(e,t,n,r,i){this._initCurve(e,t);let a=this.currentPath.points,o=ro.curveTo(e,t,n,r,i,a);if(o){let{cx:e,cy:t,radius:n,startAngle:r,endAngle:i,anticlockwise:a}=o;this.arc(e,t,n,r,i,a)}return this}arc(e,t,n,r,i,a=!1){if(r===i||(!a&&i<=r?i+=zn:a&&r<=i&&(r+=zn),i-r===0))return this;let o=e+Math.cos(r)*n,s=t+Math.sin(r)*n,c=this._geometry.closePointEps,l=this.currentPath?this.currentPath.points:null;if(l){let e=Math.abs(l[l.length-2]-o),t=Math.abs(l[l.length-1]-s);e<c&&t<c||l.push(o,s)}else this.moveTo(o,s),l=this.currentPath.points;return ro.arc(o,s,e,t,n,r,i,a,l),this}beginFill(e=0,t){return this.beginTextureFill({texture:ai.WHITE,color:e,alpha:t})}normalizeColor(e){let t=W.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??=t.alpha}beginTextureFill(e){let t={texture:ai.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();let n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,n,r){return this.drawShape(new X(e,t,n,r))}drawRoundedRect(e,t,n,r,i){return this.drawShape(new Kn(e,t,n,r,i))}drawCircle(e,t,n){return this.drawShape(new Un(e,t,n))}drawEllipse(e,t,n,r){return this.drawShape(new Wn(e,t,n,r))}drawPolygon(...e){let t,n=!0,r=e[0];r.points?(n=r.closeStroke,t=r.points):t=Array.isArray(e[0])?e[0]:e;let i=new Gn(t);return i.closeStroke=n,this.drawShape(i),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===J.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();let t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){let e=this._geometry,t=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(let r=0;r<n;r++){let n=e.batches[r],i=n.style.color,a=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),o=new Float32Array(e.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),s=new Uint16Array(e.indicesUint16.buffer,n.start*2,n.size);this.batches[r]={vertexData:a,blendMode:t,indices:s,uvs:o,_batchRGB:W.shared.setValue(i).toRgbArray(),_tintRGB:i,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1}}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,n=this.batches.length;t<n;t++){let n=this.batches[t];n.worldAlpha=this.worldAlpha*n.alpha,e.plugins[this.pluginName].render(n)}}}_renderDirect(e){let t=this._resolveDirectShader(e),n=this._geometry,r=this.worldAlpha,i=t.uniforms,a=n.drawCalls;i.translationMatrix=this.transform.worldTransform,W.shared.setValue(this._tintColor).premultiply(r).toArray(i.tint),e.shader.bind(t),e.geometry.bind(n,t),e.state.set(this.state);for(let t=0,r=a.length;t<r;t++)this._renderDrawCallDirect(e,n.drawCalls[t])}_renderDrawCallDirect(e,t){let{texArray:n,type:r,size:i,start:a}=t,o=n.count;for(let t=0;t<o;t++)e.texture.bind(n.elements[t],t);e.geometry.draw(r,i,a)}_resolveDirectShader(e){let t=this.shader,n=this.pluginName;if(!t){if(!So[n]){let{maxTextures:t}=e.plugins[n],r=new Int32Array(t);for(let e=0;e<t;e++)r[e]=e;let i={tint:new Float32Array([1,1,1,1]),translationMatrix:new Z,default:Nr.from({uSamplers:r},!0)},a=e.plugins[n]._shader.program;So[n]=new Pr(a,i)}t=So[n]}return t}_calculateBounds(){this.finishPoly();let e=this._geometry;if(!e.graphicsData.length)return;let{minX:t,minY:n,maxX:r,maxY:i}=e.bounds;this._bounds.addFrame(this.transform,t,n,r,i)}containsPoint(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t._tintRGB=W.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;let t=this.transform.worldTransform,n=t.a,r=t.b,i=t.c,a=t.d,o=t.tx,s=t.ty,c=this._geometry.points,l=this.vertexData,u=0;for(let e=0;e<c.length;e+=2){let t=c[e],d=c[e+1];l[u++]=n*t+i*d+o,l[u++]=a*d+r*t+s}}closePath(){let e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};Co.curves=no,Co._TEMP_POINT=new Y;var wo=Co,To=(e=>(e[e.LINEAR_VERTICAL=0]=`LINEAR_VERTICAL`,e[e.LINEAR_HORIZONTAL=1]=`LINEAR_HORIZONTAL`,e))(To||{}),Eo=new Y,Do=new Uint16Array([0,1,2,0,2,3]),Oo=class e extends Ga{constructor(e){super(),this._anchor=new tr(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new W(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=f.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||ai.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Do,this.pluginName=`batch`,this.isSprite=!0,this._roundPixels=k.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=qt(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=qt(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;let t=this.transform.worldTransform,n=t.a,r=t.b,i=t.c,a=t.d,o=t.tx,s=t.ty,c=this.vertexData,l=e.trim,u=e.orig,d=this._anchor,f=0,p=0,m=0,h=0;if(l?(p=l.x-d._x*u.width,f=p+l.width,h=l.y-d._y*u.height,m=h+l.height):(p=-d._x*u.width,f=p+u.width,h=-d._y*u.height,m=h+u.height),c[0]=n*p+i*h+o,c[1]=a*h+r*p+s,c[2]=n*f+i*h+o,c[3]=a*h+r*f+s,c[4]=n*f+i*m+o,c[5]=a*m+r*f+s,c[6]=n*p+i*m+o,c[7]=a*m+r*p+s,this._roundPixels){let e=k.RESOLUTION;for(let t=0;t<c.length;++t)c[t]=Math.round(c[t]*e)/e}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let e=this._texture,t=this.vertexTrimmedData,n=e.orig,r=this._anchor,i=this.transform.worldTransform,a=i.a,o=i.b,s=i.c,c=i.d,l=i.tx,u=i.ty,d=-r._x*n.width,f=d+n.width,p=-r._y*n.height,m=p+n.height;if(t[0]=a*d+s*p+l,t[1]=c*p+o*d+u,t[2]=a*f+s*p+l,t[3]=c*p+o*f+u,t[4]=a*f+s*m+l,t[5]=c*m+o*f+u,t[6]=a*d+s*m+l,t[7]=c*m+o*d+u,this._roundPixels){let e=k.RESOLUTION;for(let n=0;n<t.length;++n)t[n]=Math.round(t[n]*e)/e}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){let e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||=new za,this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||=(this._localBoundsRect||=new X,this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,Eo);let t=this._texture.orig.width,n=this._texture.orig.height,r=-t*this.anchor.x,i=0;return Eo.x>=r&&Eo.x<r+t&&(i=-n*this.anchor.y,Eo.y>=i&&Eo.y<i+n)}destroy(e){super.destroy(e),this._texture.off(`update`,this._onTextureUpdate,this),this._anchor=null,(typeof e==`boolean`?e:e?.texture)&&this._texture.destroy(!!(typeof e==`boolean`?e:e?.baseTexture)),this._texture=null}static from(t,n){let r=t instanceof ai?t:ai.from(t,n);return new e(r)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.scale.x=(qt(this.scale.x)||1)*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.scale.y=(qt(this.scale.y)||1)*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off(`update`,this._onTextureUpdate,this),this._texture=e||ai.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once(`update`,this._onTextureUpdate,this)))}},ko={willReadFrequently:!0},Ao=class e{static get experimentalLetterSpacingSupported(){let t=e._experimentalLetterSpacingSupported;if(t!==void 0){let n=k.ADAPTER.getCanvasRenderingContext2D().prototype;t=e._experimentalLetterSpacingSupported=`letterSpacing`in n||`textLetterSpacing`in n}return t}constructor(e,t,n,r,i,a,o,s,c){this.text=e,this.style=t,this.width=n,this.height=r,this.lines=i,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=s,this.fontProperties=c}static measureText(t,n,r,i=e._canvas){r??=n.wordWrap;let a=n.toFontString(),o=e.measureFont(a);o.fontSize===0&&(o.fontSize=n.fontSize,o.ascent=n.fontSize);let s=i.getContext(`2d`,ko);s.font=a;let c=(r?e.wordWrap(t,n,i):t).split(/(?:\r\n|\r|\n)/),l=Array(c.length),u=0;for(let t=0;t<c.length;t++){let r=e._measureText(c[t],n.letterSpacing,s);l[t]=r,u=Math.max(u,r)}let d=u+n.strokeThickness;n.dropShadow&&(d+=n.dropShadowDistance);let f=n.lineHeight||o.fontSize+n.strokeThickness,p=Math.max(f,o.fontSize+n.strokeThickness*2)+n.leading+(c.length-1)*(f+n.leading);return n.dropShadow&&(p+=n.dropShadowDistance),new e(t,n,d,p,c,l,f+n.leading,u,o)}static _measureText(t,n,r){let i=!1;e.experimentalLetterSpacingSupported&&(e.experimentalLetterSpacing?(r.letterSpacing=`${n}px`,r.textLetterSpacing=`${n}px`,i=!0):(r.letterSpacing=`0px`,r.textLetterSpacing=`0px`));let a=r.measureText(t).width;return a>0&&(i?a-=n:a+=(e.graphemeSegmenter(t).length-1)*n),a}static wordWrap(t,n,r=e._canvas){let i=r.getContext(`2d`,ko),a=0,o=``,s=``,c=Object.create(null),{letterSpacing:l,whiteSpace:u}=n,d=e.collapseSpaces(u),f=e.collapseNewlines(u),p=!d,m=n.wordWrapWidth+l,h=e.tokenize(t);for(let t=0;t<h.length;t++){let r=h[t];if(e.isNewline(r)){if(!f){s+=e.addLine(o),p=!d,o=``,a=0;continue}r=` `}if(d){let t=e.isBreakingSpace(r),n=e.isBreakingSpace(o[o.length-1]);if(t&&n)continue}let u=e.getFromCache(r,l,c,i);if(u>m)if(o!==``&&(s+=e.addLine(o),o=``,a=0),e.canBreakWords(r,n.breakWords)){let t=e.wordWrapSplit(r);for(let u=0;u<t.length;u++){let d=t[u],f=d,h=1;for(;t[u+h];){let i=t[u+h];if(!e.canBreakChars(f,i,r,u,n.breakWords))d+=i;else break;f=i,h++}u+=h-1;let g=e.getFromCache(d,l,c,i);g+a>m&&(s+=e.addLine(o),p=!1,o=``,a=0),o+=d,a+=g}}else{o.length>0&&(s+=e.addLine(o),o=``,a=0);let n=t===h.length-1;s+=e.addLine(r,!n),p=!1,o=``,a=0}else u+a>m&&(p=!1,s+=e.addLine(o),o=``,a=0),(o.length>0||!e.isBreakingSpace(r)||p)&&(o+=r,a+=u)}return s+=e.addLine(o,!1),s}static addLine(t,n=!0){return t=e.trimRight(t),t=n?`${t}
`:t,t}static getFromCache(t,n,r,i){let a=r[t];return typeof a!=`number`&&(a=e._measureText(t,n,i)+n,r[t]=a),a}static collapseSpaces(e){return e===`normal`||e===`pre-line`}static collapseNewlines(e){return e===`normal`}static trimRight(t){if(typeof t!=`string`)return``;for(let n=t.length-1;n>=0;n--){let r=t[n];if(!e.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t==`string`?e._newlines.includes(t.charCodeAt(0)):!1}static isBreakingSpace(t,n){return typeof t==`string`?e._breakingSpaces.includes(t.charCodeAt(0)):!1}static tokenize(t){let n=[],r=``;if(typeof t!=`string`)return n;for(let i=0;i<t.length;i++){let a=t[i],o=t[i+1];if(e.isBreakingSpace(a,o)||e.isNewline(a)){r!==``&&(n.push(r),r=``),n.push(a);continue}r+=a}return r!==``&&n.push(r),n}static canBreakWords(e,t){return t}static canBreakChars(e,t,n,r,i){return!0}static wordWrapSplit(t){return e.graphemeSegmenter(t)}static measureFont(t){if(e._fonts[t])return e._fonts[t];let n={ascent:0,descent:0,fontSize:0},r=e._canvas,i=e._context;i.font=t;let a=e.METRICS_STRING+e.BASELINE_SYMBOL,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(e.BASELINE_SYMBOL).width),c=Math.ceil(e.HEIGHT_MULTIPLIER*s);if(s=s*e.BASELINE_MULTIPLIER|0,o===0||c===0)return e._fonts[t]=n,n;r.width=o,r.height=c,i.fillStyle=`#f00`,i.fillRect(0,0,o,c),i.font=t,i.textBaseline=`alphabetic`,i.fillStyle=`#000`,i.fillText(a,0,s);let l=i.getImageData(0,0,o,c).data,u=l.length,d=o*4,f=0,p=0,m=!1;for(f=0;f<s;++f){for(let e=0;e<d;e+=4)if(l[p+e]!==255){m=!0;break}if(!m)p+=d;else break}for(n.ascent=s-f,p=u-d,m=!1,f=c;f>s;--f){for(let e=0;e<d;e+=4)if(l[p+e]!==255){m=!0;break}if(!m)p-=d;else break}return n.descent=f-s,n.fontSize=n.ascent+n.descent,e._fonts[t]=n,n}static clearMetrics(t=``){t?delete e._fonts[t]:e._fonts={}}static get _canvas(){if(!e.__canvas){let t;try{let n=new OffscreenCanvas(0,0);if(n.getContext(`2d`,ko)?.measureText)return e.__canvas=n,n;t=k.ADAPTER.createCanvas()}catch{t=k.ADAPTER.createCanvas()}t.width=t.height=10,e.__canvas=t}return e.__canvas}static get _context(){return e.__context||=e._canvas.getContext(`2d`,ko),e.__context}};Ao.METRICS_STRING=`|q`,Ao.BASELINE_SYMBOL=`M`,Ao.BASELINE_MULTIPLIER=1.4,Ao.HEIGHT_MULTIPLIER=2,Ao.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter==`function`){let e=new Intl.Segmenter;return t=>[...e.segment(t)].map(e=>e.segment)}return e=>[...e]})(),Ao.experimentalLetterSpacing=!1,Ao._fonts={},Ao._newlines=[10,13],Ao._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var jo=Ao,Mo=[`serif`,`sans-serif`,`monospace`,`cursive`,`fantasy`,`system-ui`],No=class e{constructor(e){this.styleID=0,this.reset(),Lo(this,e,e)}clone(){let t={};return Lo(t,this,e.defaultStyle),new e(t)}reset(){Lo(this,e.defaultStyle,e.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){let t=Fo(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){let t=Fo(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){Io(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){let t=Fo(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){let e=typeof this.fontSize==`number`?`${this.fontSize}px`:this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(`,`));for(let e=t.length-1;e>=0;e--){let n=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!Mo.includes(n)&&(n=`"${n}"`),t[e]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(`,`)}`}};No.defaultStyle={align:`left`,breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:`black`,dropShadowDistance:5,fill:`black`,fillGradientType:To.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:`Arial`,fontSize:26,fontStyle:`normal`,fontVariant:`normal`,fontWeight:`normal`,leading:0,letterSpacing:0,lineHeight:0,lineJoin:`miter`,miterLimit:10,padding:0,stroke:`black`,strokeThickness:0,textBaseline:`alphabetic`,trim:!1,whiteSpace:`pre`,wordWrap:!1,wordWrapWidth:100};var Po=No;function Fo(e){let t=W.shared,n=e=>{let n=t.setValue(e);return n.alpha===1?n.toHex():n.toRgbaString()};return Array.isArray(e)?e.map(n):n(e)}function Io(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function Lo(e,t,n){for(let r in n)Array.isArray(t[r])?e[r]=t[r].slice():e[r]=t[r]}var Ro={texture:!0,children:!1,baseTexture:!0},zo=class e extends Oo{constructor(t,n,r){let i=!1;r||(r=k.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;let a=ai.from(r);a.orig=new X,a.trim=new X,super(a),this._ownCanvas=i,this.canvas=r,this.context=r.getContext(`2d`,{willReadFrequently:!0}),this._resolution=e.defaultResolution??k.RESOLUTION,this._autoResolution=e.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font=``,this.text=t,this.style=n,this.localStyleID=-1}static get experimentalLetterSpacing(){return jo.experimentalLetterSpacing}static set experimentalLetterSpacing(e){H(`7.1.0`,`Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing`),jo.experimentalLetterSpacing=e}updateText(e){let t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();let n=this.context,r=jo.measureText(this._text||` `,this._style,this._style.wordWrap,this.canvas),i=r.width,a=r.height,o=r.lines,s=r.lineHeight,c=r.lineWidths,l=r.maxLineWidth,u=r.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+t.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=t.strokeThickness,n.textBaseline=t.textBaseline,n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit;let d,f,p=t.dropShadow?2:1;for(let e=0;e<p;++e){let i=t.dropShadow&&e===0,p=i?Math.ceil(Math.max(1,a)+t.padding*2):0,m=p*this._resolution;if(i){n.fillStyle=`black`,n.strokeStyle=`black`;let e=t.dropShadowColor,r=t.dropShadowBlur*this._resolution,i=t.dropShadowDistance*this._resolution;n.shadowColor=W.shared.setValue(e).setAlpha(t.dropShadowAlpha).toRgbaString(),n.shadowBlur=r,n.shadowOffsetX=Math.cos(t.dropShadowAngle)*i,n.shadowOffsetY=Math.sin(t.dropShadowAngle)*i+m}else n.fillStyle=this._generateFillStyle(t,o,r),n.strokeStyle=t.stroke,n.shadowColor=`black`,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let h=(s-u.fontSize)/2;s-u.fontSize<0&&(h=0);for(let e=0;e<o.length;e++)d=t.strokeThickness/2,f=t.strokeThickness/2+e*s+u.ascent+h,t.align===`right`?d+=l-c[e]:t.align===`center`&&(d+=(l-c[e])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(o[e],d+t.padding,f+t.padding-p,!0),t.fill&&this.drawLetterSpacing(o[e],d+t.padding,f+t.padding-p)}this.updateTexture()}drawLetterSpacing(e,t,n,r=!1){let i=this._style.letterSpacing,a=!1;if(jo.experimentalLetterSpacingSupported&&(jo.experimentalLetterSpacing?(this.context.letterSpacing=`${i}px`,this.context.textLetterSpacing=`${i}px`,a=!0):(this.context.letterSpacing=`0px`,this.context.textLetterSpacing=`0px`)),i===0||a){r?this.context.strokeText(e,t,n):this.context.fillText(e,t,n);return}let o=t,s=jo.graphemeSegmenter(e),c=this.context.measureText(e).width,l=0;for(let e=0;e<s.length;++e){let t=s[e];r?this.context.strokeText(t,o,n):this.context.fillText(t,o,n);let a=``;for(let t=e+1;t<s.length;++t)a+=s[t];l=this.context.measureText(a).width,o+=c-l+i,c=l}}updateTexture(){let e=this.canvas;if(this._style.trim){let t=an(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}let t=this._texture,n=this._style,r=n.trim?0:n.padding,i=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-r,t.trim.y=-r,t.orig.width=t._frame.width-r*2,t.orig.height=t._frame.height-r*2,this._onTextureUpdate(),i.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,n){let r=e.fill;if(Array.isArray(r)){if(r.length===1)return r[0]}else return r;let i,a=e.dropShadow?e.dropShadowDistance:0,o=e.padding||0,s=this.canvas.width/this._resolution-a-o*2,c=this.canvas.height/this._resolution-a-o*2,l=r.slice(),u=e.fillGradientStops.slice();if(!u.length){let e=l.length+1;for(let t=1;t<e;++t)u.push(t/e)}if(l.unshift(r[0]),u.unshift(0),l.push(r[r.length-1]),u.push(1),e.fillGradientType===To.LINEAR_VERTICAL){i=this.context.createLinearGradient(s/2,o,s/2,c+o);let r=n.fontProperties.fontSize+e.strokeThickness;for(let e=0;e<t.length;e++){let a=n.lineHeight*(e-1)+r,o=n.lineHeight*e,s=o;e>0&&a>o&&(s=(o+a)/2);let d=o+r,f=n.lineHeight*(e+1),p=d;e+1<t.length&&f<d&&(p=(d+f)/2);let m=(p-s)/c;for(let e=0;e<l.length;e++){let t=0;t=typeof u[e]==`number`?u[e]:e/l.length;let n=Math.min(1,Math.max(0,s/c+t*m));n=Number(n.toFixed(5)),i.addColorStop(n,l[e])}}}else{i=this.context.createLinearGradient(o,c/2,s+o,c/2);let e=l.length+1,t=1;for(let n=0;n<l.length;n++){let r;r=typeof u[n]==`number`?u[n]:t/e,i.addColorStop(r,l[n]),t++}}return i}destroy(e){typeof e==`boolean`&&(e={children:e}),e=Object.assign({},Ro,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0),this.scale.x=(qt(this.scale.x)||1)*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0),this.scale.y=(qt(this.scale.y)||1)*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e||={},e instanceof Po?this._style=e:this._style=new Po(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??``),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};zo.defaultAutoResolution=!0;var Bo=zo,Vo=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ho=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,Uo=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`,Wo=class extends qr{constructor(e=4,t=3,n=!1){super(Vo,n?Uo:Ho),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new Y,this.pixelSize=1,this._clamp=n,Array.isArray(e)?this.kernels=e:(this._blur=e,this.quality=t)}apply(e,t,n,r){let i=this._pixelSize.x/t._frame.width,a=this._pixelSize.y/t._frame.height,o;if(this._quality===1||this._blur===0)o=this._kernels[0]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*a,e.applyFilter(this,t,n,r);else{let s=e.getFilterTexture(),c=t,l=s,u,d=this._quality-1;for(let t=0;t<d;t++)o=this._kernels[t]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*a,e.applyFilter(this,c,l,1),u=c,c=l,l=u;o=this._kernels[d]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*a,e.applyFilter(this,c,n,r),e.returnFilterTexture(s)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((e,t)=>e+t+.5,0))}_generateKernels(){let e=this._blur,t=this._quality,n=[e];if(e>0){let r=e,i=e/t;for(let e=1;e<t;e++)r-=i,n.push(r)}this._kernels=n,this._updatePadding()}get kernels(){return this._kernels}set kernels(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max(...e)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(e){typeof e==`number`?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof Y?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}get blur(){return this._blur}set blur(e){this._blur=e,this._generateKernels()}},Go=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ko=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,qo=Object.defineProperty,Jo=Object.getOwnPropertySymbols,Yo=Object.prototype.hasOwnProperty,Xo=Object.prototype.propertyIsEnumerable,Zo=(e,t,n)=>t in e?qo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Qo=(e,t)=>{for(var n in t||={})Yo.call(t,n)&&Zo(e,n,t[n]);if(Jo)for(var n of Jo(t))Xo.call(t,n)&&Zo(e,n,t[n]);return e},$o=class extends qr{constructor(e){super(),this.angle=45,this._distance=5,this._resolution=k.FILTER_RESOLUTION;let t=e?Qo(Qo({},$o.defaults),e):$o.defaults,{kernels:n,blur:r,quality:i,pixelSize:a,resolution:o}=t;this._offset=new tr(this._updatePadding,this),this._tintFilter=new qr(Go,Ko),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=o,this._blurFilter=n?new Wo(n):new Wo(r,i),this.pixelSize=a,this.resolution=o;let{shadowOnly:s,rotation:c,distance:l,offset:u,alpha:d,color:f}=t;this.shadowOnly=s,c!==void 0&&l!==void 0?(this.rotation=c,this.distance=l):this.offset=u,this.alpha=d,this.color=f}apply(e,t,n,r){let i=e.getFilterTexture();this._tintFilter.apply(e,t,i,1),this._blurFilter.apply(e,i,n,r),this.shadowOnly!==!0&&e.applyFilter(this,t,n,0),e.returnFilterTexture(i)}_updatePadding(){this.padding=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y))+this.blur*2}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(e){this._offset.copyFrom(e),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(e){this._resolution=e,this._tintFilter&&(this._tintFilter.resolution=e),this._blurFilter&&(this._blurFilter.resolution=e)}get distance(){return this._distance}set distance(e){H(`5.3.0`,`DropShadowFilter distance is deprecated, use offset`),this._distance=e,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/Vn}set rotation(e){H(`5.3.0`,`DropShadowFilter rotation is deprecated, use offset`),this.angle=e*Vn,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(e){this._tintFilter.uniforms.alpha=e}get color(){return zt(this._tintFilter.uniforms.color)}set color(e){Rt(e,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.blur}set blur(e){this._blurFilter.blur=e,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){this._blurFilter.pixelSize=e}},es=$o;es.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:k.FILTER_RESOLUTION};function ts(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ns(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function rs(e){let t,n,r;e.length===2?(t=e===ts||e===ns?e:os,n=e,r=e):(t=ts,n=(t,n)=>ts(e(t),n),r=(t,n)=>e(t)-n);function i(e,r,i=0,a=e.length){if(i<a){if(t(r,r)!==0)return a;do{let t=i+a>>>1;n(e[t],r)<0?i=t+1:a=t}while(i<a)}return i}function a(e,r,i=0,a=e.length){if(i<a){if(t(r,r)!==0)return a;do{let t=i+a>>>1;n(e[t],r)<=0?i=t+1:a=t}while(i<a)}return i}function o(e,t,n=0,a=e.length){let o=i(e,t,n,a-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o}return{left:i,center:o,right:a}}function os(){return 0}function ss(e){return e===null?NaN:+e}const cs=rs(ts).right;rs(ss).center;var ls=cs,us=class extends Map{constructor(e,t=ms){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(let[t,n]of e)this.set(t,n)}get(e){return super.get(ds(this,e))}has(e){return super.has(ds(this,e))}set(e,t){return super.set(fs(this,e),t)}delete(e){return super.delete(ps(this,e))}};function ds({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):n}function fs({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function ps({_intern:e,_key:t},n){let r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function ms(e){return typeof e==`object`&&e?e.valueOf():e}var hs=Math.sqrt(50),gs=Math.sqrt(10),_s=Math.sqrt(2);function vs(e,t,n){let r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/10**i,o=a>=hs?10:a>=gs?5:a>=_s?2:1,s,c,l;return i<0?(l=10**-i/o,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=10**i*o,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?vs(e,t,n*2):[s,c,l]}function ys(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];let r=t<e,[i,a,o]=r?vs(t,e,n):vs(e,t,n);if(!(a>=i))return[];let s=a-i+1,c=Array(s);if(r)if(o<0)for(let e=0;e<s;++e)c[e]=(a-e)/-o;else for(let e=0;e<s;++e)c[e]=(a-e)*o;else if(o<0)for(let e=0;e<s;++e)c[e]=(i+e)/-o;else for(let e=0;e<s;++e)c[e]=(i+e)*o;return c}function bs(e,t,n){return t=+t,e=+e,n=+n,vs(e,t,n)[2]}function xs(e,t,n){t=+t,e=+e,n=+n;let r=t<e,i=r?bs(t,e,n):bs(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Ss(e,t){let n;if(t===void 0)for(let t of e)t!=null&&(n<t||n===void 0&&t>=t)&&(n=t);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Cs(e,t){let n;if(t===void 0)for(let t of e)t!=null&&(n>t||n===void 0&&t>=t)&&(n=t);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function ws(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=Array(i);++r<i;)a[r]=e+r*n;return a}function Ts(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}const Es=Symbol(`implicit`);function Ds(){var e=new us,t=[],n=[],r=Es;function i(i){let a=e.get(i);if(a===void 0){if(r!==Es)return r;e.set(i,a=t.push(i)-1)}return n[a%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new us;for(let r of n){if(e.has(r))continue;e.set(r,t.push(r)-1)}return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return Ds(t,n).unknown(r)},Ts.apply(i,arguments),i}function Os(){var e=Ds().unknown(void 0),t=e.domain,n=e.range,r=0,i=1,a,o,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var e=t().length,d=i<r,f=d?i:r,p=d?r:i;a=(p-f)/Math.max(1,e-c+l*2),s&&(a=Math.floor(a)),f+=(p-f-a*(e-c))*u,o=a*(1-c),s&&(f=Math.round(f),o=Math.round(o));var m=ws(e).map(function(e){return f+a*e});return n(d?m.reverse():m)}return e.domain=function(e){return arguments.length?(t(e),d()):t()},e.range=function(e){return arguments.length?([r,i]=e,r=+r,i=+i,d()):[r,i]},e.rangeRound=function(e){return[r,i]=e,r=+r,i=+i,s=!0,d()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(e){return arguments.length?(s=!!e,d()):s},e.padding=function(e){return arguments.length?(c=Math.min(1,l=+e),d()):c},e.paddingInner=function(e){return arguments.length?(c=Math.min(1,e),d()):c},e.paddingOuter=function(e){return arguments.length?(l=+e,d()):l},e.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),d()):u},e.copy=function(){return Os(t(),[r,i]).round(s).paddingInner(c).paddingOuter(l).align(u)},Ts.apply(d(),arguments)}function ks(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function As(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function js(){}var Ms=.7,Ns=1/Ms,Ps=`\\s*([+-]?\\d+)\\s*`,Fs=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*`,Is=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*`,Ls=/^#([0-9a-f]{3,8})$/,Rs=RegExp(`^rgb\\(${Ps},${Ps},${Ps}\\)$`),zs=RegExp(`^rgb\\(${Is},${Is},${Is}\\)$`),Bs=RegExp(`^rgba\\(${Ps},${Ps},${Ps},${Fs}\\)$`),Vs=RegExp(`^rgba\\(${Is},${Is},${Is},${Fs}\\)$`),Hs=RegExp(`^hsl\\(${Fs},${Is},${Is}\\)$`),Us=RegExp(`^hsla\\(${Fs},${Is},${Is},${Fs}\\)$`),Ws={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ks(js,Ys,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Gs,formatHex:Gs,formatHex8:Ks,formatHsl:qs,formatRgb:Js,toString:Js});function Gs(){return this.rgb().formatHex()}function Ks(){return this.rgb().formatHex8()}function qs(){return cc(this).formatHsl()}function Js(){return this.rgb().formatRgb()}function Ys(e){var t,n;return e=(e+``).trim().toLowerCase(),(t=Ls.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Xs(t):n===3?new ec(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Zs(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Zs(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Rs.exec(e))?new ec(t[1],t[2],t[3],1):(t=zs.exec(e))?new ec(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Bs.exec(e))?Zs(t[1],t[2],t[3],t[4]):(t=Vs.exec(e))?Zs(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Hs.exec(e))?sc(t[1],t[2]/100,t[3]/100,1):(t=Us.exec(e))?sc(t[1],t[2]/100,t[3]/100,t[4]):Ws.hasOwnProperty(e)?Xs(Ws[e]):e===`transparent`?new ec(NaN,NaN,NaN,0):null}function Xs(e){return new ec(e>>16&255,e>>8&255,e&255,1)}function Zs(e,t,n,r){return r<=0&&(e=t=n=NaN),new ec(e,t,n,r)}function Qs(e){return e instanceof js||(e=Ys(e)),e?(e=e.rgb(),new ec(e.r,e.g,e.b,e.opacity)):new ec}function $s(e,t,n,r){return arguments.length===1?Qs(e):new ec(e,t,n,r??1)}function ec(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ks(ec,$s,As(js,{brighter(e){return e=e==null?Ns:Ns**+e,new ec(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ms:Ms**+e,new ec(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ec(ac(this.r),ac(this.g),ac(this.b),ic(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tc,formatHex:tc,formatHex8:nc,formatRgb:rc,toString:rc}));function tc(){return`#${oc(this.r)}${oc(this.g)}${oc(this.b)}`}function nc(){return`#${oc(this.r)}${oc(this.g)}${oc(this.b)}${oc((isNaN(this.opacity)?1:this.opacity)*255)}`}function rc(){let e=ic(this.opacity);return`${e===1?`rgb(`:`rgba(`}${ac(this.r)}, ${ac(this.g)}, ${ac(this.b)}${e===1?`)`:`, ${e})`}`}function ic(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ac(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function oc(e){return e=ac(e),(e<16?`0`:``)+e.toString(16)}function sc(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new uc(e,t,n,r)}function cc(e){if(e instanceof uc)return new uc(e.h,e.s,e.l,e.opacity);if(e instanceof js||(e=Ys(e)),!e)return new uc;if(e instanceof uc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new uc(o,s,c,e.opacity)}function lc(e,t,n,r){return arguments.length===1?cc(e):new uc(e,t,n,r??1)}function uc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ks(uc,lc,As(js,{brighter(e){return e=e==null?Ns:Ns**+e,new uc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ms:Ms**+e,new uc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ec(pc(e>=240?e-240:e+120,i,r),pc(e,i,r),pc(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new uc(dc(this.h),fc(this.s),fc(this.l),ic(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=ic(this.opacity);return`${e===1?`hsl(`:`hsla(`}${dc(this.h)}, ${fc(this.s)*100}%, ${fc(this.l)*100}%${e===1?`)`:`, ${e})`}`}}));function dc(e){return e=(e||0)%360,e<0?e+360:e}function fc(e){return Math.max(0,Math.min(1,e||0))}function pc(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var mc=e=>()=>e;function hc(e,t){return function(n){return e+n*t}}function gc(e,t,n){return e**=+n,t=t**+n-e,n=1/n,function(r){return(e+r*t)**+n}}function _c(e){return(e=+e)==1?vc:function(t,n){return n-t?gc(t,n,e):mc(isNaN(t)?n:t)}}function vc(e,t){var n=t-e;return n?hc(e,n):mc(isNaN(e)?t:e)}var yc=(function e(t){var n=_c(t);function r(e,t){var r=n((e=$s(e)).r,(t=$s(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=vc(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+``}}return r.gamma=e,r})(1);function bc(e,t){t||=[];var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function xc(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Sc(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=Array(r),a=Array(n),o;for(o=0;o<r;++o)i[o]=jc(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(e){for(o=0;o<r;++o)a[o]=i[o](e);return a}}function Cc(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function wc(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Tc(e,t){var n={},r={},i;for(i in(typeof e!=`object`||!e)&&(e={}),(typeof t!=`object`||!t)&&(t={}),t)i in e?n[i]=jc(e[i],t[i]):r[i]=t[i];return function(e){for(i in n)r[i]=n[i](e);return r}}var Ec=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Dc=new RegExp(Ec.source,`g`);function Oc(e){return function(){return e}}function kc(e){return function(t){return e(t)+``}}function Ac(e,t){var n=Ec.lastIndex=Dc.lastIndex=0,r,i,a,o=-1,s=[],c=[];for(e+=``,t+=``;(r=Ec.exec(e))&&(i=Dc.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,c.push({i:o,x:wc(r,i)})),n=Dc.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?kc(c[0].x):Oc(t):(t=c.length,function(e){for(var n=0,r;n<t;++n)s[(r=c[n]).i]=r.x(e);return s.join(``)})}function jc(e,t){var n=typeof t,r;return t==null||n===`boolean`?mc(t):(n===`number`?wc:n===`string`?(r=Ys(t))?(t=r,yc):Ac:t instanceof Ys?yc:t instanceof Date?Cc:xc(t)?bc:Array.isArray(t)?Sc:typeof t.valueOf!=`function`&&typeof t.toString!=`function`||isNaN(t)?Tc:wc)(e,t)}function Mc(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Nc(e){return function(){return e}}function Pc(e){return+e}var Fc=[0,1];function Ic(e){return e}function Lc(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Nc(isNaN(t)?NaN:.5)}function Rc(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}function zc(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=Lc(i,r),a=n(o,a)):(r=Lc(r,i),a=n(a,o)),function(e){return a(r(e))}}function Bc(e,t,n){var r=Math.min(e.length,t.length)-1,i=Array(r),a=Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=Lc(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(t){var n=ls(e,t,1,r)-1;return a[n](i[n](t))}}function Vc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Hc(){var e=Fc,t=Fc,n=jc,r,i,a,o=Ic,s,c,l;function u(){var n=Math.min(e.length,t.length);return o!==Ic&&(o=Rc(e[0],e[n-1])),s=n>2?Bc:zc,c=l=null,d}function d(i){return i==null||isNaN(i=+i)?a:(c||=s(e.map(r),t,n))(r(o(i)))}return d.invert=function(n){return o(i((l||=s(t,e.map(r),wc))(n)))},d.domain=function(t){return arguments.length?(e=Array.from(t,Pc),u()):e.slice()},d.range=function(e){return arguments.length?(t=Array.from(e),u()):t.slice()},d.rangeRound=function(e){return t=Array.from(e),n=Mc,u()},d.clamp=function(e){return arguments.length?(o=e?!0:Ic,u()):o!==Ic},d.interpolate=function(e){return arguments.length?(n=e,u()):n},d.unknown=function(e){return arguments.length?(a=e,d):a},function(e,t){return r=e,i=t,u()}}function Uc(){return Hc()(Ic,Ic)}function Wc(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString(`en`).replace(/,/g,``):e.toString(10)}function Gc(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf(`e`))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Kc(e){return e=Gc(Math.abs(e)),e?e[1]:NaN}function qc(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(n.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function Jc(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}var Yc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Xc(e){if(!(t=Yc.exec(e)))throw Error(`invalid format: `+e);var t;return new Zc({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Xc.prototype=Zc.prototype;function Zc(e){this.fill=e.fill===void 0?` `:e.fill+``,this.align=e.align===void 0?`>`:e.align+``,this.sign=e.sign===void 0?`-`:e.sign+``,this.symbol=e.symbol===void 0?``:e.symbol+``,this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?``:e.type+``}Zc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?`0`:``)+(this.width===void 0?``:Math.max(1,this.width|0))+(this.comma?`,`:``)+(this.precision===void 0?``:`.`+Math.max(0,this.precision|0))+(this.trim?`~`:``)+this.type};function Qc(e){out:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case`.`:r=i=n;break;case`0`:r===0&&(r=n),i=n;break;default:if(!+e[n])break out;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var $c;function el(e,t){var n=Gc(e,t);if(!n)return e+``;var r=n[0],i=n[1],a=i-($c=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+Array(a-o+1).join(`0`):a>0?r.slice(0,a)+`.`+r.slice(a):`0.`+Array(1-a).join(`0`)+Gc(e,Math.max(0,t+a-1))[0]}function tl(e,t){var n=Gc(e,t);if(!n)return e+``;var r=n[0],i=n[1];return i<0?`0.`+Array(-i).join(`0`)+r:r.length>i+1?r.slice(0,i+1)+`.`+r.slice(i+1):r+Array(i-r.length+2).join(`0`)}var nl={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+``,d:Wc,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>tl(e*100,t),r:tl,s:el,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function rl(e){return e}var il=Array.prototype.map,al=[`y`,`z`,`a`,`f`,`p`,`n`,``,`m`,``,`k`,`M`,`G`,`T`,`P`,`E`,`Z`,`Y`];function ol(e){var t=e.grouping===void 0||e.thousands===void 0?rl:qc(il.call(e.grouping,Number),e.thousands+``),n=e.currency===void 0?``:e.currency[0]+``,r=e.currency===void 0?``:e.currency[1]+``,i=e.decimal===void 0?`.`:e.decimal+``,a=e.numerals===void 0?rl:Jc(il.call(e.numerals,String)),o=e.percent===void 0?`%`:e.percent+``,s=e.minus===void 0?``:e.minus+``,c=e.nan===void 0?`NaN`:e.nan+``;function l(e){e=Xc(e);var l=e.fill,u=e.align,d=e.sign,f=e.symbol,p=e.zero,m=e.width,h=e.comma,g=e.precision,_=e.trim,v=e.type;v===`n`?(h=!0,v=`g`):nl[v]||(g===void 0&&(g=12),_=!0,v=`g`),(p||l===`0`&&u===`=`)&&(p=!0,l=`0`,u=`=`);var y=f===`$`?n:f===`#`&&/[boxX]/.test(v)?`0`+v.toLowerCase():``,b=f===`$`?r:/[%p]/.test(v)?o:``,x=nl[v],S=/[defgprs%]/.test(v);g=g===void 0?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function C(e){var n=y,r=b,o,f,C;if(v===`c`)r=x(e)+r,e=``;else{e=+e;var w=e<0||1/e<0;if(e=isNaN(e)?c:x(Math.abs(e),g),_&&(e=Qc(e)),w&&+e==0&&d!==`+`&&(w=!1),n=(w?d===`(`?d:s:d===`-`||d===`(`?``:d)+n,r=(v===`s`?al[8+$c/3]:``)+r+(w&&d===`(`?`)`:``),S){for(o=-1,f=e.length;++o<f;)if(C=e.charCodeAt(o),48>C||C>57){r=(C===46?i+e.slice(o+1):e.slice(o))+r,e=e.slice(0,o);break}}}h&&!p&&(e=t(e,1/0));var T=n.length+e.length+r.length,E=T<m?Array(m-T+1).join(l):``;switch(h&&p&&(e=t(E+e,E.length?m-r.length:1/0),E=``),u){case`<`:e=n+e+r+E;break;case`=`:e=n+E+e+r;break;case`^`:e=E.slice(0,T=E.length>>1)+n+e+r+E.slice(T);break;default:e=E+n+e+r;break}return a(e)}return C.toString=function(){return e+``},C}function u(e,t){var n=l((e=Xc(e),e.type=`f`,e)),r=Math.max(-8,Math.min(8,Math.floor(Kc(t)/3)))*3,i=10**-r,a=al[8+r/3];return function(e){return n(i*e)+a}}return{format:l,formatPrefix:u}}var sl,cl,ll;ul({thousands:`,`,grouping:[3],currency:[`$`,``]});function ul(e){return sl=ol(e),cl=sl.format,ll=sl.formatPrefix,sl}function dl(e){return Math.max(0,-Kc(Math.abs(e)))}function fl(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Kc(t)/3)))*3-Kc(Math.abs(e)))}function pl(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Kc(t)-Kc(e))+1}function ml(e,t,n,r){var i=xs(e,t,n),a;switch(r=Xc(r??`,f`),r.type){case`s`:var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=fl(i,o))&&(r.precision=a),ll(r,o);case``:case`e`:case`g`:case`p`:case`r`:r.precision==null&&!isNaN(a=pl(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type===`e`));break;case`f`:case`%`:r.precision==null&&!isNaN(a=dl(i))&&(r.precision=a-(r.type===`%`)*2);break}return cl(r)}function hl(e){var t=e.domain;return e.ticks=function(e){var n=t();return ys(n[0],n[n.length-1],e??10)},e.tickFormat=function(e,n){var r=t();return ml(r[0],r[r.length-1],e??10,n)},e.nice=function(n){n??=10;var r=t(),i=0,a=r.length-1,o=r[i],s=r[a],c,l,u=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);u-- >0;){if(l=bs(o,s,n),l===c)return r[i]=o,r[a]=s,t(r);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function gl(){var e=Uc();return e.copy=function(){return Vc(e,gl())},Ts.apply(e,arguments),hl(e)}var _l=[],vl={underlying:`NIFTY`,timeframe:`1d`,loading:!1,error:null,data:[]};function yl(){return vl}function bl(e){vl={...vl,...e},_l.forEach(e=>{e(vl)})}function xl(e){return _l.push(e),()=>{let t=_l.indexOf(e);t>-1&&_l.splice(t,1)}}var Sl={x:null,y:null,candleIdx:null},Cl=[],wl=window.innerWidth,Tl=window.innerHeight,$={left:20,right:70,top:20,bottom:50},El=Tl-$.bottom,Dl=20,Ol=null,kl=[];function Al(e){if(!Number.isFinite(e))return``;let t=Math.abs(e);for(let{value:n,suffix:r}of[{value:1e9,suffix:`B`},{value:1e6,suffix:`M`},{value:1e3,suffix:`K`}])if(t>=n)return`${(e/n).toFixed(t>=n*10?0:1)}${r}`;return e.toString()}function jl(e,t,n=.75){if(t.length!==0){if(t.length===1){e.moveTo(t[0].x,t[0].y),e.lineTo(t[0].x,t[0].y);return}e.moveTo(t[0].x,t[0].y);for(let r=0;r<t.length-1;r+=1){let i=t[r-1]??t[r],a=t[r],o=t[r+1],s=t[r+2]??t[r+1],c=a.x+(o.x-i.x)*n/6,l=a.y+(o.y-i.y)*n/6,u=o.x-(s.x-a.x)*n/6,d=o.y-(s.y-a.y)*n/6;e.bezierCurveTo(c,l,u,d,o.x,o.y)}}}function Ml(e,t){if(!e.length)return[];let n=Array(e.length).fill(null);if(t<=1)return e.forEach((e,t)=>{n[t]=e.close}),n;let r=0;for(let i=0;i<e.length;i+=1)r+=e[i].close,i>=t&&(r-=e[i-t].close),i>=t-1&&(n[i]=r/t);return n}function Nl(e){return Ol===e?kl:(kl=Ml(e,Dl),Ol=e,kl)}function Pl(e){let t=null;document.body.style.margin=`0`,document.body.style.overflow=`hidden`,e.style.width=`100vw`,e.style.height=`100vh`,e.style.overflow=`hidden`,e.style.position=`relative`,e.style.background=`#181a20`,e.style.left=``,e.style.top=``;function n(){if(!t)return;let e=window.innerWidth,n=window.innerHeight;t.renderer.resize(e,n),t.view.style.width=e+`px`,t.view.style.height=n+`px`,l()}t=new qa({width:window.innerWidth,height:window.innerHeight,backgroundColor:1579552}),t.view.style.display=`block`,t.view.style.width=`100vw`,t.view.style.height=`100vh`,t.view.style.position=`absolute`,t.view.style.top=`0`,t.view.style.left=`0`,t.view.style.zIndex=`0`,e.appendChild(t.view),window.addEventListener(`resize`,n);let r=0,i=50,a=null,o=!1,s=0,c=0;function l(){let e=yl(),n=e.data||[];e.data!==a&&(a=e.data,r=Math.max(0,n.length-i)),Fl(e,r,i,t)}return xl(()=>l()),l(),t.view.addEventListener(`wheel`,e=>{e.preventDefault();let n=yl().data;if(!n.length)return;let a=t.view.getBoundingClientRect(),o=Math.max(1,a.width-$.left-$.right),s=e.clientX-a.left,c=Math.min(1,Math.max(0,(s-$.left)/o)),u=i,d=Math.min(10,n.length),f=n.length;i=Math.max(d,Math.min(f,i*(e.deltaY>0?1.1:.9)));let p=r+c*u;r+=(u-i)*c;let m=Math.max(0,n.length-i);if(Number.isFinite(r)||(r=0),r=Math.max(0,Math.min(r,m)),Number.isFinite(p)){let e=Math.max(0,Math.min(n.length-1,p))-c*i;r=Math.max(0,Math.min(e,m))}l()}),t.view.addEventListener(`mousedown`,e=>{(e.button===1||e.button===0)&&(o=!0,s=e.clientX,c=r,t.view.style.cursor=`grabbing`)}),window.addEventListener(`mousemove`,e=>{if(o){let n=yl().data;if(!n.length)return;let a=e.clientX-s,o=Math.max(1,t.view.width-$.left-$.right)/Math.max(1,i),u=c-a/o,d=Math.max(0,n.length-i);r=Math.max(0,Math.min(u,d)),l()}}),window.addEventListener(`mouseup`,()=>{o=!1,t.view.style.cursor=``}),t.view.addEventListener(`mousemove`,e=>{let n=t.view.getBoundingClientRect(),r=e.clientX-n.left,i=e.clientY-n.top,a=yl().data||[],o=$.left,s=wl-$.right;if(a.length>0&&Cl.length>0&&r>=o-10&&r<=s+10){let e=null,t=1/0;for(let n of Cl){let i=Math.abs(n.centerX-r);i<t&&(e=n,t=i)}e&&(Sl={x:e.centerX,y:Math.max($.top,Math.min(i,El)),candleIdx:Math.max(0,Math.min(a.length-1,e.idx))},l())}}),t}function Fl(e,t=0,n=50,r){if(!r)return;r.stage.removeChildren(),Cl=[];let i=typeof Sl.x==`number`&&typeof Sl.y==`number`&&typeof Sl.candleIdx==`number`;if(e.loading){let e=new Bo(`Loading...`,new Po({fill:16777215,fontSize:16}));e.x=wl/2-40,e.y=Tl/2-10,r.stage.addChild(e);return}if(e.error){let t=new Bo(`Error: `+e.error,new Po({fill:16733525,fontSize:16}));t.x=wl/2-60,t.y=Tl/2-10,r.stage.addChild(t);return}if(!e.data||e.data.length===0){let e=new Bo(`No data`,new Po({fill:16777215,fontSize:16}));e.x=wl/2-30,e.y=Tl/2-10,r.stage.addChild(e);return}let a=e.data,o=Nl(a),s=a.map(e=>e.ts);n=Math.max(5,n);let c=Math.floor(t),l=Math.ceil(t+n),u=[],d=[];for(let e=c;e<l;++e)e<0||e>=s.length?(u.push(null),d.push(void 0)):(u.push(s[e]),d.push(a[e]));function f(){let e=u.find(e=>e!==null),t=[...u].reverse().find(e=>e!==null);if(!e||!t)return!1;let n=new Date(e),r=new Date(t);return n.getFullYear()!==r.getFullYear()||n.getMonth()!==r.getMonth()||n.getDate()!==r.getDate()}let p=Tl-$.top-$.bottom,m=Math.max(40,Math.min(120,p*.25)),h=Tl-$.bottom-6,g=Math.max($.top+20,h-m),_=Math.max($.top+40,Math.min(g-12,Tl-$.bottom-14));El=_;let v=Os().domain(u.map((e,t)=>t.toString())).range([$.left,wl-$.right]).padding(.3),y=d.filter(e=>e!==void 0),b=y.length>0?Cs(y,e=>e.low)??0:0,x=y.length>0?Ss(y,e=>e.high)??1:1,S=gl().domain([b,x]).nice().range([_,$.top]),C=y.flatMap(e=>[e.low,e.high]),w=C.length?Math.min(...C):0,T=C.length?Math.max(...C):1,E=Math.abs(S(w)-S(T)),D=new wo;D.beginFill(2303791,.98),D.drawRoundedRect(wl-$.right,$.top,$.right,Tl-$.top-$.bottom,12),D.endFill(),D.filters=[new es({color:0,alpha:.25,blur:6,distance:2,rotation:90})],r.stage.addChild(D);let O=Math.max(4,Math.floor((Tl-$.top-$.bottom)/50));S.ticks(O).forEach(e=>{let t=S(e),n=new wo;n.lineStyle({width:1,color:2237996,alpha:.7}).moveTo($.left,t).lineTo(wl-$.right,t),r.stage.addChild(n);let i=new Bo(e.toFixed(2),new Po({fill:16777215,fontSize:11,fontWeight:`bold`,fontFamily:`Inter, Segoe UI, Arial, sans-serif`,dropShadow:!0,dropShadowColor:`#000`,dropShadowBlur:4,dropShadowAlpha:.4,letterSpacing:1.2,padding:4}));i.x=wl-$.right+16,i.y=t-14,r.stage.addChild(i)});let k=Math.max(10,h-g),A=d.map((e,t)=>{if(e&&Number.isFinite(e.volume))return e.volume;if(!e)return null;let n=c+t+1,r=Math.abs(Math.sin(n*12.9898+n*78.233));return Math.round(500+r*2500)}),j=A.filter(e=>e!==null&&Number.isFinite(e));if(j.length>0){let e=Math.max(...j,1),t=new wo;t.beginFill(1711396,.55),t.drawRect($.left,g,wl-$.left-$.right,h-g),t.endFill(),r.stage.addChild(t);let n=new wo,i=[],a=[0,e*.5,e];a.forEach((t,r)=>{let o=r===a.length-1?e:t,s=Math.max(0,Math.min(1,o/e)),c=h-s*(k-6);n.lineStyle({width:1,color:2435377,alpha:.5}).moveTo($.left-6,c).lineTo(wl-$.right,c);let l=new Bo(Al(Math.max(0,o)),new Po({fill:11909830,fontSize:10,fontWeight:`bold`,fontFamily:`Inter, Segoe UI, Arial, sans-serif`,dropShadow:!0,dropShadowColor:`#000`,dropShadowBlur:4,dropShadowAlpha:.35,padding:2}));l.x=Math.max(4,$.left-48),l.y=c-7,l.anchor.set(0,0),i.push(l)}),r.stage.addChild(n);for(let e of i)r.stage.addChild(e);let o=new wo;A.forEach((t,n)=>{let r=d[n];if(t===null||!r)return;let i=v(n.toString());if(i===void 0)return;let a=Math.max(1,v.bandwidth()*.55),s=i+(v.bandwidth()-a)/2,c=Math.max(0,Math.min(1,t/e)),l=Math.max(1,c*(k-6)),u=h-l;o.beginFill(r.close>=r.open?3843671:13974588,.7),o.drawRect(s,u,a,l),o.endFill()}),r.stage.addChild(o)}let M=new wo;M.beginFill(2303791,.98),M.drawRoundedRect($.left,Tl-$.bottom,wl-$.left-$.right,$.bottom,12),M.endFill(),M.filters=[new es({color:0,alpha:.25,blur:6,distance:2,rotation:270})],r.stage.addChild(M);let N=e.timeframe,P=N===`1d`?160:N===`1h`?120:N===`5m`?100:80,F=u.map((e,t)=>e?{ts:e,i:t}:null).filter(e=>e!==null),I=typeof v.step==`function`?v.step():v.bandwidth(),L=Math.max(P,I*1.5),R=[];if(F.forEach((e,t)=>{let n=v(e.i.toString());if(n===void 0)return;let r=n+v.bandwidth()/2,i=R.length===0,a=R[R.length-1];if(i||r-a.centerX>=L){R.push({...e,centerX:r});return}t===F.length-1&&(R[R.length-1]={...e,centerX:r})}),R.forEach(({ts:e,centerX:t})=>{let n=new wo;n.lineStyle({width:1,color:2237996,alpha:.7}).moveTo(t,$.top).lineTo(t,g-2),r.stage.addChild(n);let i=new Date(e),o=``;if(a.length>0){let e=(N||``).toLowerCase(),t=e.endsWith(`m`)||e.endsWith(`h`);o=f()?`${i.toLocaleDateString([],{day:`2-digit`,month:`2-digit`,year:`2-digit`})} ${i.toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`})}`:t?i.toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`}):i.toLocaleDateString([],{day:`2-digit`,month:`2-digit`,year:`2-digit`})}let s=new Bo(o,new Po({fill:16777215,fontSize:11,fontWeight:`bold`,fontFamily:`Inter, Segoe UI, Arial, sans-serif`,dropShadow:!0,dropShadowColor:`#000`,dropShadowBlur:4,dropShadowAlpha:.4,letterSpacing:1.2,padding:4}));s.anchor.set(.5,0),s.x=t,s.y=Tl-$.bottom+12,r.stage.addChild(s)}),u.forEach((e,t)=>{let n=d[t];if(!e||!n)return;let i=v(t.toString());if(i===void 0)return;let a=v.bandwidth(),o=n.close>=n.open?5025616:16007990,s=c+t,l=Math.max(2,E*.04),u=new wo,f=S(n.high),p=S(n.low);if(Math.abs(f-p)<l){let e=(f+p)/2;f=e-l/2,p=e+l/2}u.lineStyle({width:1,color:o}).moveTo(i+a/2,f).lineTo(i+a/2,p),r.stage.addChild(u);let m=new wo,h=S(Math.max(n.open,n.close)),g=Math.abs(S(n.open)-S(n.close));g<l&&(h=S((n.open+n.close)/2)-l/2,g=l),m.beginFill(o).drawRect(i,h,a,g).endFill(),r.stage.addChild(m),Cl.push({idx:s,centerX:i+a/2,left:i,right:i+a})}),o.length){let e=u.map((e,t)=>{let n=c+t;if(!e||n<0||n>=o.length)return{defined:!1,x:0,y:0};let r=o[n],i=d[t];if(r==null||!i)return{defined:!1,x:0,y:0};let a=v(t.toString());if(a===void 0)return{defined:!1,x:0,y:0};let s=a+v.bandwidth()/2,l=S(r);return Number.isFinite(l)?{defined:!0,x:s,y:l}:{defined:!1,x:0,y:0}});if(e.some(e=>e.defined)){let t=[],n=[];e.forEach(e=>{if(!e.defined){n.length&&(t.push(n),n=[]);return}n.push({x:e.x,y:e.y})}),n.length&&t.push(n),t.forEach(e=>{if(e.length<2)return;let t=new wo;t.lineStyle({width:2,color:16761095,alpha:.92}),jl(t,e,.85),r.stage.addChild(t)})}let t=null;for(let e=o.length-1;e>=0;--e){let n=o[e];if(n!=null&&Number.isFinite(n)){t=n;break}}if(t!==null){let e=new Bo(`MA${Dl} ${t.toFixed(2)}`,new Po({fill:16761095,fontSize:13,fontWeight:`bold`,fontFamily:`Inter, Segoe UI, Arial, sans-serif`,dropShadow:!0,dropShadowColor:`#000`,dropShadowBlur:4,dropShadowAlpha:.4,letterSpacing:1,padding:4}));e.x=$.left+12,e.y=$.top+12,r.stage.addChild(e)}}if(i){let t=new wo;t.lineStyle({width:1,color:8947848,alpha:.7});for(let e=$.top;e<El;e+=6)t.moveTo(Sl.x,e),t.lineTo(Sl.x,e+3);r.stage.addChild(t);let n=new wo;n.lineStyle({width:1,color:8947848,alpha:.7});let i=Math.min(El,Sl.y);for(let e=$.left;e<wl-$.right;e+=6)n.moveTo(e,i),n.lineTo(e+3,i);r.stage.addChild(n);let a=e.data?.[Sl.candleIdx];if(a){let e=Sl.candleIdx,t=e>=0&&e<o.length?o[e]:null,n=t==null?``:`  MA${Dl} ${t.toFixed(2)}`,i=a.volume!==void 0&&Number.isFinite(a.volume)?a.volume:null,s=i===null?``:`  V ${Al(i)}`,c=`O ${a.open}  H ${a.high}  L ${a.low}  C ${a.close}${n}${s}`,l=new Bo(c,new Po({fill:16777215,fontSize:14,fontWeight:`bold`,fontFamily:`Inter, Segoe UI, Arial, sans-serif`,dropShadow:!0,dropShadowColor:`#000`,dropShadowBlur:4,dropShadowAlpha:.4,letterSpacing:1.2,padding:4}));l.x=$.left+10,l.y=$.top-10,r.stage.addChild(l)}}}var Il={"1M":60*1e3,"5M":300*1e3,"15M":900*1e3,"30M":1800*1e3,"1H":3600*1e3,"1D":1440*60*1e3},Ll=10*365*24*60*60*1e3,Rl=5e3;function zl(e){let t=e.getDay();return t!==0&&t!==6}function Bl(e,t){let n=[],r=new Date(t-Ll);r.setHours(0,0,0,0);let i=new Date(t);i.setHours(23,59,59,999);for(let a=new Date(r);a<=i;a.setDate(a.getDate()+1)){if(!zl(a))continue;if(e>=Il[`1D`]){let e=new Date(a);e.setHours(15,30,0,0);let r=e.getTime();r<=t&&n.push(r);continue}let r=new Date(a);r.setHours(9,15,0,0);let i=r.getTime(),o=new Date(a);o.setHours(15,30,0,0);let s=o.getTime();for(;i<=s&&i<=t;)n.push(i),i+=e}return n}function Vl(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=Math.imul(t,16777619);return()=>{t+=1831565813;let e=Math.imul(t^t>>>15,1|t);return e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}function Hl(e){return Math.round(e*100)/100}async function Ul(e,t){let n=Il[t.interval];if(!n)return console.warn(`Unsupported interval. Returning empty response.`,t.interval),{candles:[]};let r=Bl(n,Date.now());if(r.length===0)return{candles:[]};let i=Math.max(1,Math.floor(r.length/Rl)),a=Vl(`${e}-${t.interval}-10y`),o=[],s=100+a()*200,c=[];for(let e=0;e<r.length;e+=i)c.push(e);let l=r.length-1;c[c.length-1]!==l&&c.push(l);let u=null;for(let e of c){let t=r[e],i=u===null?n:t-u,c=Math.max(1,i/n),l=Math.sqrt(c),d=(a()-.5)*.2,f=Math.max(.5,s*(.005+a()*.02)*l),p=Hl(Math.max(1,s+f*(a()-.5))),m=Hl(Math.max(1,p+f*(a()-.5+d))),h=Hl(Math.max(p,m)+f*a()*.6),g=Hl(Math.max(.5,Math.min(p,m)-f*a()*.6)),_=Math.round(500+a()*2500*l),v=Math.round(100+a()*400);o.push({ts:new Date(t).toISOString(),open:p,high:Math.max(h,p,m),low:Math.min(g,p,m),close:m,oi:v,volume:_}),s=m,u=t}return t.skip_last_ts&&o.length>0&&o.pop(),{candles:o}}var Wl={"1m":`1M`,"5m":`5M`,"15m":`15M`,"30m":`30M`,"1h":`1H`,"1d":`1D`};async function Gl(){let{underlying:e,timeframe:t}=yl();bl({loading:!0,error:null});try{let n=Wl[t]||`1D`,r=(await Ul(e,{interval:n}))?.candles||[];bl({data:r,loading:!1})}catch(e){bl({error:e.message||`Failed to fetch data`,loading:!1,data:[]})}}function Kl(e){e.innerHTML=`
    <div style="display:flex;gap:8px;align-items:center;">
      <select id="underlying">
        <option value="NIFTY">NIFTY</option>
        <option value="BANKNIFTY">BANKNIFTY</option>
      </select>
      <select id="timeframe">
        <option value="1m">1 min</option>
        <option value="5m">5 min</option>
        <option value="1h">1 hour</option>
        <option value="1d">Daily</option>
      </select>
      <span id="status"></span>
    </div>
  `;let t=e.querySelector(`#underlying`),n=e.querySelector(`#timeframe`),r=e.querySelector(`#status`),i=localStorage.getItem(`chartFormState`);if(i)try{let{underlying:e,timeframe:r}=JSON.parse(i);e&&(t.value=e),r&&(n.value=r),bl({underlying:t.value,timeframe:n.value})}catch{}else t.value=yl().underlying,n.value=yl().timeframe;function a(){localStorage.setItem(`chartFormState`,JSON.stringify({underlying:t.value,timeframe:n.value}))}t.onchange=()=>{bl({underlying:t.value}),a(),Gl()},n.onchange=()=>{bl({timeframe:n.value}),a(),Gl()},xl(e=>{e.loading?r.textContent=`Loading...`:e.error?r.textContent=`Error: `+e.error:!e.data||e.data.length===0?r.textContent=`No data`:r.textContent=``})}window.onload=()=>{let e=document.getElementById(`app`);if(!e)return;let t=document.createElement(`div`);e.appendChild(t),Kl(t);let n=document.createElement(`div`);n.style.width=`100%`,n.style.height=`400px`,e.appendChild(n),Pl(n),Gl()};